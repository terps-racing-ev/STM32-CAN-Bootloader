ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"bootloader.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.file 1 "Core/Src/bootloader.c"
  20              		.section	.text.Bootloader_ReadFlash,"ax",%progbits
  21              		.align	1
  22              		.syntax unified
  23              		.thumb
  24              		.thumb_func
  26              	Bootloader_ReadFlash:
  27              	.LVL0:
  28              	.LFB138:
   1:Core/Src/bootloader.c **** /* USER CODE BEGIN Header */
   2:Core/Src/bootloader.c **** /**
   3:Core/Src/bootloader.c ****   ******************************************************************************
   4:Core/Src/bootloader.c ****   * @file           : bootloader.c
   5:Core/Src/bootloader.c ****   * @brief          : CAN Bootloader implementation for STM32L432
   6:Core/Src/bootloader.c ****   ******************************************************************************
   7:Core/Src/bootloader.c ****   * @attention
   8:Core/Src/bootloader.c ****   *
   9:Core/Src/bootloader.c ****   * This bootloader implements a CAN-based firmware update mechanism.
  10:Core/Src/bootloader.c ****   * It allows flashing new application firmware via CAN bus messages.
  11:Core/Src/bootloader.c ****   *
  12:Core/Src/bootloader.c ****   ******************************************************************************
  13:Core/Src/bootloader.c ****   */
  14:Core/Src/bootloader.c **** /* USER CODE END Header */
  15:Core/Src/bootloader.c **** 
  16:Core/Src/bootloader.c **** /* Includes ------------------------------------------------------------------*/
  17:Core/Src/bootloader.c **** #include "bootloader.h"
  18:Core/Src/bootloader.c **** #include <string.h>
  19:Core/Src/bootloader.c **** 
  20:Core/Src/bootloader.c **** /* Private variables ---------------------------------------------------------*/
  21:Core/Src/bootloader.c **** static CAN_HandleTypeDef *hcan_bootloader;
  22:Core/Src/bootloader.c **** static BootloaderStatus_t bootloader_status;
  23:Core/Src/bootloader.c **** static CAN_RxHeaderTypeDef rx_header;
  24:Core/Src/bootloader.c **** static uint8_t rx_data[8];
  25:Core/Src/bootloader.c **** static uint8_t tx_data[8];
  26:Core/Src/bootloader.c **** static CAN_TxHeaderTypeDef tx_header;
  27:Core/Src/bootloader.c **** static uint32_t tx_mailbox;
  28:Core/Src/bootloader.c **** static uint8_t flash_buffer[8];     /* Buffer for 8-byte flash writes (two 4-byte chunks) */
  29:Core/Src/bootloader.c **** static uint16_t buffer_index = 0;   /* Current position in flash_buffer */
  30:Core/Src/bootloader.c **** static volatile uint8_t jump_to_app_flag = 0;  /* Flag to trigger jump from main loop */
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 2


  31:Core/Src/bootloader.c **** static volatile uint8_t can_command_received = 0;  /* Flag to disable auto-jump timeout */
  32:Core/Src/bootloader.c **** 
  33:Core/Src/bootloader.c **** /* Private function prototypes -----------------------------------------------*/
  34:Core/Src/bootloader.c **** static void Bootloader_ConfigureCANFilter(void);
  35:Core/Src/bootloader.c **** static uint8_t Bootloader_EraseApplicationFlash(void);
  36:Core/Src/bootloader.c **** static uint8_t Bootloader_WriteFlash(uint32_t address, uint8_t *data, uint16_t length);
  37:Core/Src/bootloader.c **** static uint8_t Bootloader_ReadFlash(uint32_t address, uint8_t *data, uint16_t length);
  38:Core/Src/bootloader.c **** static void Bootloader_DeInit(void);
  39:Core/Src/bootloader.c **** static void Bootloader_SendACK(void);
  40:Core/Src/bootloader.c **** static void Bootloader_SendNACK(uint8_t error_code);
  41:Core/Src/bootloader.c **** static void Bootloader_WaitForCANTransmission(void);
  42:Core/Src/bootloader.c **** 
  43:Core/Src/bootloader.c **** /**
  44:Core/Src/bootloader.c ****   * @brief  Initialize the bootloader
  45:Core/Src/bootloader.c ****   * @param  hcan: pointer to CAN handle
  46:Core/Src/bootloader.c ****   * @retval None
  47:Core/Src/bootloader.c ****   */
  48:Core/Src/bootloader.c **** void Bootloader_Init(CAN_HandleTypeDef *hcan)
  49:Core/Src/bootloader.c **** {
  50:Core/Src/bootloader.c ****     hcan_bootloader = hcan;
  51:Core/Src/bootloader.c ****     
  52:Core/Src/bootloader.c ****     /* Initialize bootloader status */
  53:Core/Src/bootloader.c ****     memset(&bootloader_status, 0, sizeof(BootloaderStatus_t));
  54:Core/Src/bootloader.c ****     bootloader_status.state = BL_STATE_IDLE;
  55:Core/Src/bootloader.c ****     bootloader_status.current_address = APPLICATION_ADDRESS;
  56:Core/Src/bootloader.c ****     
  57:Core/Src/bootloader.c ****     /* Configure CAN filter */
  58:Core/Src/bootloader.c ****     Bootloader_ConfigureCANFilter();
  59:Core/Src/bootloader.c ****     
  60:Core/Src/bootloader.c ****     /* Start CAN peripheral */
  61:Core/Src/bootloader.c ****     if (HAL_CAN_Start(hcan_bootloader) != HAL_OK)
  62:Core/Src/bootloader.c ****     {
  63:Core/Src/bootloader.c ****         Error_Handler();
  64:Core/Src/bootloader.c ****     }
  65:Core/Src/bootloader.c ****     
  66:Core/Src/bootloader.c ****     /* Activate CAN RX notification */
  67:Core/Src/bootloader.c ****     if (HAL_CAN_ActivateNotification(hcan_bootloader, CAN_IT_RX_FIFO0_MSG_PENDING) != HAL_OK)
  68:Core/Src/bootloader.c ****     {
  69:Core/Src/bootloader.c ****         Error_Handler();
  70:Core/Src/bootloader.c ****     }
  71:Core/Src/bootloader.c ****     
  72:Core/Src/bootloader.c ****     /* Configure TX header */
  73:Core/Src/bootloader.c ****     tx_header.StdId = 0;
  74:Core/Src/bootloader.c ****     tx_header.ExtId = CAN_BOOTLOADER_ID;
  75:Core/Src/bootloader.c ****     tx_header.IDE = CAN_ID_EXT;
  76:Core/Src/bootloader.c ****     tx_header.RTR = CAN_RTR_DATA;
  77:Core/Src/bootloader.c ****     tx_header.DLC = 8;
  78:Core/Src/bootloader.c ****     tx_header.TransmitGlobalTime = DISABLE;
  79:Core/Src/bootloader.c **** }
  80:Core/Src/bootloader.c **** 
  81:Core/Src/bootloader.c **** /**
  82:Core/Src/bootloader.c ****   * @brief  Configure CAN filter to accept bootloader messages
  83:Core/Src/bootloader.c ****   * @retval None
  84:Core/Src/bootloader.c ****   */
  85:Core/Src/bootloader.c **** static void Bootloader_ConfigureCANFilter(void)
  86:Core/Src/bootloader.c **** {
  87:Core/Src/bootloader.c ****     CAN_FilterTypeDef can_filter;
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 3


  88:Core/Src/bootloader.c ****     
  89:Core/Src/bootloader.c ****     can_filter.FilterBank = 0;
  90:Core/Src/bootloader.c ****     can_filter.FilterMode = CAN_FILTERMODE_IDMASK;
  91:Core/Src/bootloader.c ****     can_filter.FilterScale = CAN_FILTERSCALE_32BIT;
  92:Core/Src/bootloader.c ****     /* For extended IDs: bits [28:13] in FilterIdHigh, bits [12:0] + IDE in FilterIdLow */
  93:Core/Src/bootloader.c ****     can_filter.FilterIdHigh = (CAN_HOST_ID >> 13) & 0xFFFF;
  94:Core/Src/bootloader.c ****     can_filter.FilterIdLow = ((CAN_HOST_ID << 3) & 0xFFF8) | 0x0004;  /* IDE bit set */
  95:Core/Src/bootloader.c ****     can_filter.FilterMaskIdHigh = 0xFFFF;  /* Match all upper bits */
  96:Core/Src/bootloader.c ****     can_filter.FilterMaskIdLow = 0xFFFC;   /* Match lower bits + IDE */
  97:Core/Src/bootloader.c ****     can_filter.FilterFIFOAssignment = CAN_RX_FIFO0;
  98:Core/Src/bootloader.c ****     can_filter.FilterActivation = ENABLE;
  99:Core/Src/bootloader.c ****     can_filter.SlaveStartFilterBank = 14;
 100:Core/Src/bootloader.c ****     
 101:Core/Src/bootloader.c ****     if (HAL_CAN_ConfigFilter(hcan_bootloader, &can_filter) != HAL_OK)
 102:Core/Src/bootloader.c ****     {
 103:Core/Src/bootloader.c ****         Error_Handler();
 104:Core/Src/bootloader.c ****     }
 105:Core/Src/bootloader.c **** }
 106:Core/Src/bootloader.c **** 
 107:Core/Src/bootloader.c **** /**
 108:Core/Src/bootloader.c ****   * @brief  Main bootloader loop
 109:Core/Src/bootloader.c ****   * @retval None
 110:Core/Src/bootloader.c ****   */
 111:Core/Src/bootloader.c **** void Bootloader_Main(void)
 112:Core/Src/bootloader.c **** {
 113:Core/Src/bootloader.c ****     uint32_t timeout_start = HAL_GetTick();
 114:Core/Src/bootloader.c ****     uint8_t timeout_expired = 0;
 115:Core/Src/bootloader.c ****     
 116:Core/Src/bootloader.c ****     /* Send ready message */
 117:Core/Src/bootloader.c ****     tx_data[0] = RESP_READY;
 118:Core/Src/bootloader.c ****     tx_data[1] = 0x01;  /* Bootloader version */
 119:Core/Src/bootloader.c ****     tx_data[2] = 0x00;  /* Bootloader subversion */
 120:Core/Src/bootloader.c ****     Bootloader_SendCANMessage(RESP_READY, tx_data, 3);
 121:Core/Src/bootloader.c ****     
 122:Core/Src/bootloader.c ****     /* Main bootloader loop with timeout */
 123:Core/Src/bootloader.c ****     while (1)
 124:Core/Src/bootloader.c ****     {
 125:Core/Src/bootloader.c ****         /* Check for timeout to auto-jump to application */
 126:Core/Src/bootloader.c ****         /* Only auto-jump if: timeout expired AND no CAN commands received AND valid app exists */
 127:Core/Src/bootloader.c ****         if (!timeout_expired && !can_command_received &&
 128:Core/Src/bootloader.c ****             (HAL_GetTick() - timeout_start >= BOOTLOADER_TIMEOUT_MS))
 129:Core/Src/bootloader.c ****         {
 130:Core/Src/bootloader.c ****             timeout_expired = 1;
 131:Core/Src/bootloader.c **** 
 132:Core/Src/bootloader.c ****             /* Only jump if we have a valid application flag set */
 133:Core/Src/bootloader.c ****             if (Bootloader_CheckApplicationValidFlag())
 134:Core/Src/bootloader.c ****             {
 135:Core/Src/bootloader.c ****                 /* Send timeout jump message */
 136:Core/Src/bootloader.c ****                 tx_data[0] = RESP_READY;
 137:Core/Src/bootloader.c ****                 tx_data[1] = 0xAA;  /* Special: Timeout auto-jump */
 138:Core/Src/bootloader.c ****                 tx_data[2] = 0x55;
 139:Core/Src/bootloader.c ****                 Bootloader_SendCANMessage(RESP_READY, tx_data, 3);
 140:Core/Src/bootloader.c **** 
 141:Core/Src/bootloader.c ****                 /* Wait for message to send */
 142:Core/Src/bootloader.c ****                 Bootloader_WaitForCANTransmission();
 143:Core/Src/bootloader.c ****                 HAL_Delay(10);
 144:Core/Src/bootloader.c **** 
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 4


 145:Core/Src/bootloader.c ****                 /* Jump to application */
 146:Core/Src/bootloader.c ****                 Bootloader_JumpToApplication();
 147:Core/Src/bootloader.c ****             }
 148:Core/Src/bootloader.c ****             /* If no valid app, stay in bootloader mode indefinitely */
 149:Core/Src/bootloader.c ****         }
 150:Core/Src/bootloader.c ****         
 151:Core/Src/bootloader.c ****         /* Check if we should jump to application (from CAN command) */
 152:Core/Src/bootloader.c ****         if (jump_to_app_flag)
 153:Core/Src/bootloader.c ****         {
 154:Core/Src/bootloader.c ****             /* Send a pre-jump indicator message (using READY with special code) */
 155:Core/Src/bootloader.c ****             tx_data[0] = RESP_READY;
 156:Core/Src/bootloader.c ****             tx_data[1] = 0xFF;  /* Special: About to jump */
 157:Core/Src/bootloader.c ****             tx_data[2] = 0xFF;
 158:Core/Src/bootloader.c ****             Bootloader_SendCANMessage(RESP_READY, tx_data, 3);
 159:Core/Src/bootloader.c ****             
 160:Core/Src/bootloader.c ****             /* Wait for this message to be sent */
 161:Core/Src/bootloader.c ****             Bootloader_WaitForCANTransmission();
 162:Core/Src/bootloader.c ****             
 163:Core/Src/bootloader.c ****             /* Jump to application (this function should not return) */
 164:Core/Src/bootloader.c ****             Bootloader_JumpToApplication();
 165:Core/Src/bootloader.c ****             
 166:Core/Src/bootloader.c ****             /* If we get here, jump failed - reset the flag */
 167:Core/Src/bootloader.c ****             jump_to_app_flag = 0;
 168:Core/Src/bootloader.c ****         }
 169:Core/Src/bootloader.c ****         
 170:Core/Src/bootloader.c ****         /* Process received CAN messages (handled in interrupt) */
 171:Core/Src/bootloader.c ****         HAL_Delay(1);
 172:Core/Src/bootloader.c ****     }
 173:Core/Src/bootloader.c **** }
 174:Core/Src/bootloader.c **** 
 175:Core/Src/bootloader.c **** /**
 176:Core/Src/bootloader.c ****   * @brief  Process received CAN message
 177:Core/Src/bootloader.c ****   * @retval None
 178:Core/Src/bootloader.c ****   */
 179:Core/Src/bootloader.c **** void Bootloader_ProcessCANMessage(void)
 180:Core/Src/bootloader.c **** {
 181:Core/Src/bootloader.c ****     uint8_t command;
 182:Core/Src/bootloader.c ****     uint32_t address;
 183:Core/Src/bootloader.c ****     uint16_t length;
 184:Core/Src/bootloader.c ****     uint8_t result;
 185:Core/Src/bootloader.c **** 
 186:Core/Src/bootloader.c ****     /* Mark that a CAN command has been received - disable auto-jump timeout */
 187:Core/Src/bootloader.c ****     can_command_received = 1;
 188:Core/Src/bootloader.c **** 
 189:Core/Src/bootloader.c ****     /* Get the command byte */
 190:Core/Src/bootloader.c ****     command = rx_data[0];
 191:Core/Src/bootloader.c **** 
 192:Core/Src/bootloader.c ****     switch (command)
 193:Core/Src/bootloader.c ****     {
 194:Core/Src/bootloader.c ****         case CMD_GET_STATUS:
 195:Core/Src/bootloader.c ****             /* Send status information */
 196:Core/Src/bootloader.c ****             tx_data[0] = RESP_DATA;
 197:Core/Src/bootloader.c ****             tx_data[1] = bootloader_status.state;
 198:Core/Src/bootloader.c ****             tx_data[2] = bootloader_status.last_error;
 199:Core/Src/bootloader.c ****             tx_data[3] = (bootloader_status.bytes_written >> 24) & 0xFF;
 200:Core/Src/bootloader.c ****             tx_data[4] = (bootloader_status.bytes_written >> 16) & 0xFF;
 201:Core/Src/bootloader.c ****             tx_data[5] = (bootloader_status.bytes_written >> 8) & 0xFF;
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 5


 202:Core/Src/bootloader.c ****             tx_data[6] = bootloader_status.bytes_written & 0xFF;
 203:Core/Src/bootloader.c ****             Bootloader_SendCANMessage(RESP_DATA, tx_data, 8);
 204:Core/Src/bootloader.c ****             break;
 205:Core/Src/bootloader.c ****             
 206:Core/Src/bootloader.c ****         case CMD_ERASE_FLASH:
 207:Core/Src/bootloader.c ****             /* Erase application flash area */
 208:Core/Src/bootloader.c ****             bootloader_status.state = BL_STATE_ERASING;
 209:Core/Src/bootloader.c ****             
 210:Core/Src/bootloader.c ****             /* Clear the application valid flag first */
 211:Core/Src/bootloader.c ****             Bootloader_ClearApplicationValidFlag();
 212:Core/Src/bootloader.c ****             
 213:Core/Src/bootloader.c ****             result = Bootloader_EraseApplicationFlash();
 214:Core/Src/bootloader.c ****             if (result == ERR_NONE)
 215:Core/Src/bootloader.c ****             {
 216:Core/Src/bootloader.c ****                 bootloader_status.bytes_written = 0;
 217:Core/Src/bootloader.c ****                 bootloader_status.current_address = APPLICATION_ADDRESS;
 218:Core/Src/bootloader.c ****                 Bootloader_SendACK();
 219:Core/Src/bootloader.c ****             }
 220:Core/Src/bootloader.c ****             else
 221:Core/Src/bootloader.c ****             {
 222:Core/Src/bootloader.c ****                 Bootloader_SendNACK(result);
 223:Core/Src/bootloader.c ****             }
 224:Core/Src/bootloader.c ****             bootloader_status.state = BL_STATE_IDLE;
 225:Core/Src/bootloader.c ****             break;
 226:Core/Src/bootloader.c ****             
 227:Core/Src/bootloader.c ****         case CMD_SET_ADDRESS:
 228:Core/Src/bootloader.c ****             /* Set the current write address */
 229:Core/Src/bootloader.c ****             address = (rx_data[1] << 24) | (rx_data[2] << 16) | 
 230:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 231:Core/Src/bootloader.c ****             
 232:Core/Src/bootloader.c ****             /* Validate address is in application area */
 233:Core/Src/bootloader.c ****             if (address >= APPLICATION_ADDRESS && address <= FLASH_END_ADDRESS)
 234:Core/Src/bootloader.c ****             {
 235:Core/Src/bootloader.c ****                 bootloader_status.current_address = address;
 236:Core/Src/bootloader.c ****                 buffer_index = 0;  /* Reset buffer */
 237:Core/Src/bootloader.c ****                 Bootloader_SendACK();
 238:Core/Src/bootloader.c ****             }
 239:Core/Src/bootloader.c ****             else
 240:Core/Src/bootloader.c ****             {
 241:Core/Src/bootloader.c ****                 Bootloader_SendNACK(ERR_INVALID_ADDRESS);
 242:Core/Src/bootloader.c ****             }
 243:Core/Src/bootloader.c ****             break;
 244:Core/Src/bootloader.c ****             
 245:Core/Src/bootloader.c ****         case CMD_WRITE_DATA:
 246:Core/Src/bootloader.c ****             /* Write data to flash at current address */
 247:Core/Src/bootloader.c ****             /* Expected format: [CMD] [0x04] [byte0] [byte1] [byte2] [byte3] ... */
 248:Core/Src/bootloader.c ****             /* Receives 4 bytes per message, buffers two messages (8 bytes) before writing */
 249:Core/Src/bootloader.c ****             bootloader_status.state = BL_STATE_WRITING;
 250:Core/Src/bootloader.c ****             length = rx_data[1];  /* Data length - should always be 4 */
 251:Core/Src/bootloader.c ****             
 252:Core/Src/bootloader.c ****             if (length != 4)
 253:Core/Src/bootloader.c ****             {
 254:Core/Src/bootloader.c ****                 Bootloader_SendNACK(ERR_INVALID_DATA_LENGTH);
 255:Core/Src/bootloader.c ****                 bootloader_status.state = BL_STATE_IDLE;
 256:Core/Src/bootloader.c ****                 buffer_index = 0;  /* Reset buffer on error */
 257:Core/Src/bootloader.c ****                 break;
 258:Core/Src/bootloader.c ****             }
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 6


 259:Core/Src/bootloader.c ****             
 260:Core/Src/bootloader.c ****             /* Copy 4 bytes to buffer */
 261:Core/Src/bootloader.c ****             for (uint8_t i = 0; i < 4; i++)
 262:Core/Src/bootloader.c ****             {
 263:Core/Src/bootloader.c ****                 flash_buffer[buffer_index++] = rx_data[2 + i];
 264:Core/Src/bootloader.c ****             }
 265:Core/Src/bootloader.c ****             
 266:Core/Src/bootloader.c ****             /* Write to flash when we have 8 bytes (two 4-byte chunks) */
 267:Core/Src/bootloader.c ****             if (buffer_index >= 8)
 268:Core/Src/bootloader.c ****             {
 269:Core/Src/bootloader.c ****                 result = Bootloader_WriteFlash(bootloader_status.current_address, 
 270:Core/Src/bootloader.c ****                                                flash_buffer, 8);
 271:Core/Src/bootloader.c ****                 if (result == ERR_NONE)
 272:Core/Src/bootloader.c ****                 {
 273:Core/Src/bootloader.c ****                     bootloader_status.current_address += 8;
 274:Core/Src/bootloader.c ****                     bootloader_status.bytes_written += 8;
 275:Core/Src/bootloader.c ****                     buffer_index = 0;
 276:Core/Src/bootloader.c ****                     Bootloader_SendACK();
 277:Core/Src/bootloader.c ****                 }
 278:Core/Src/bootloader.c ****                 else
 279:Core/Src/bootloader.c ****                 {
 280:Core/Src/bootloader.c ****                     buffer_index = 0;  /* Reset buffer on write failure */
 281:Core/Src/bootloader.c ****                     Bootloader_SendNACK(result);
 282:Core/Src/bootloader.c ****                 }
 283:Core/Src/bootloader.c ****             }
 284:Core/Src/bootloader.c ****             else
 285:Core/Src/bootloader.c ****             {
 286:Core/Src/bootloader.c ****                 Bootloader_SendACK();  /* Data buffered, waiting for more */
 287:Core/Src/bootloader.c ****             }
 288:Core/Src/bootloader.c ****             
 289:Core/Src/bootloader.c ****             bootloader_status.state = BL_STATE_IDLE;
 290:Core/Src/bootloader.c ****             break;
 291:Core/Src/bootloader.c ****             
 292:Core/Src/bootloader.c ****         case CMD_WRITE_FLASH:
 293:Core/Src/bootloader.c ****             /* Legacy write command - write address and data in one message */
 294:Core/Src/bootloader.c ****             address = (rx_data[1] << 24) | (rx_data[2] << 16) | 
 295:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 296:Core/Src/bootloader.c ****             length = rx_data[5];
 297:Core/Src/bootloader.c ****             
 298:Core/Src/bootloader.c ****             if (address >= APPLICATION_ADDRESS && address <= FLASH_END_ADDRESS)
 299:Core/Src/bootloader.c ****             {
 300:Core/Src/bootloader.c ****                 bootloader_status.state = BL_STATE_WRITING;
 301:Core/Src/bootloader.c ****                 result = Bootloader_WriteFlash(address, &rx_data[6], length);
 302:Core/Src/bootloader.c ****                 if (result == ERR_NONE)
 303:Core/Src/bootloader.c ****                 {
 304:Core/Src/bootloader.c ****                     Bootloader_SendACK();
 305:Core/Src/bootloader.c ****                 }
 306:Core/Src/bootloader.c ****                 else
 307:Core/Src/bootloader.c ****                 {
 308:Core/Src/bootloader.c ****                     Bootloader_SendNACK(result);
 309:Core/Src/bootloader.c ****                 }
 310:Core/Src/bootloader.c ****                 bootloader_status.state = BL_STATE_IDLE;
 311:Core/Src/bootloader.c ****             }
 312:Core/Src/bootloader.c ****             else
 313:Core/Src/bootloader.c ****             {
 314:Core/Src/bootloader.c ****                 Bootloader_SendNACK(ERR_INVALID_ADDRESS);
 315:Core/Src/bootloader.c ****             }
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 7


 316:Core/Src/bootloader.c ****             break;
 317:Core/Src/bootloader.c ****             
 318:Core/Src/bootloader.c ****         case CMD_READ_FLASH:
 319:Core/Src/bootloader.c ****             /* Read flash memory */
 320:Core/Src/bootloader.c ****             address = (rx_data[1] << 24) | (rx_data[2] << 16) | 
 321:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 322:Core/Src/bootloader.c ****             length = rx_data[5];
 323:Core/Src/bootloader.c ****             
 324:Core/Src/bootloader.c ****             if (address >= APPLICATION_ADDRESS && address <= FLASH_END_ADDRESS && length <= 7)
 325:Core/Src/bootloader.c ****             {
 326:Core/Src/bootloader.c ****                 bootloader_status.state = BL_STATE_READING;
 327:Core/Src/bootloader.c ****                 tx_data[0] = RESP_DATA;
 328:Core/Src/bootloader.c ****                 result = Bootloader_ReadFlash(address, &tx_data[1], length);
 329:Core/Src/bootloader.c ****                 if (result == ERR_NONE)
 330:Core/Src/bootloader.c ****                 {
 331:Core/Src/bootloader.c ****                     Bootloader_SendCANMessage(RESP_DATA, tx_data, length + 1);
 332:Core/Src/bootloader.c ****                 }
 333:Core/Src/bootloader.c ****                 else
 334:Core/Src/bootloader.c ****                 {
 335:Core/Src/bootloader.c ****                     Bootloader_SendNACK(result);
 336:Core/Src/bootloader.c ****                 }
 337:Core/Src/bootloader.c ****                 bootloader_status.state = BL_STATE_IDLE;
 338:Core/Src/bootloader.c ****             }
 339:Core/Src/bootloader.c ****             else
 340:Core/Src/bootloader.c ****             {
 341:Core/Src/bootloader.c ****                 Bootloader_SendNACK(ERR_INVALID_ADDRESS);
 342:Core/Src/bootloader.c ****             }
 343:Core/Src/bootloader.c ****             break;
 344:Core/Src/bootloader.c ****             
 345:Core/Src/bootloader.c ****         case CMD_JUMP_TO_APP:
 346:Core/Src/bootloader.c ****             /* Jump to application - set flag to jump from main loop, not from interrupt */
 347:Core/Src/bootloader.c ****             if (Bootloader_CheckValidApplication())
 348:Core/Src/bootloader.c ****             {
 349:Core/Src/bootloader.c ****                 /* Set the valid application flag in flash for future auto-boots */
 350:Core/Src/bootloader.c ****                 result = Bootloader_SetApplicationValidFlag();
 351:Core/Src/bootloader.c ****                 if (result != ERR_NONE)
 352:Core/Src/bootloader.c ****                 {
 353:Core/Src/bootloader.c ****                     /* Log error but still try to jump - flag write failure shouldn't prevent immed
 354:Core/Src/bootloader.c ****                     bootloader_status.last_error = result;
 355:Core/Src/bootloader.c ****                 }
 356:Core/Src/bootloader.c ****                 
 357:Core/Src/bootloader.c ****                 Bootloader_SendACK();
 358:Core/Src/bootloader.c ****                 jump_to_app_flag = 1;  /* Set flag to trigger jump from main loop */
 359:Core/Src/bootloader.c ****             }
 360:Core/Src/bootloader.c ****             else
 361:Core/Src/bootloader.c ****             {
 362:Core/Src/bootloader.c ****                 Bootloader_SendNACK(ERR_NO_VALID_APP);
 363:Core/Src/bootloader.c ****             }
 364:Core/Src/bootloader.c ****             break;
 365:Core/Src/bootloader.c ****             
 366:Core/Src/bootloader.c ****         default:
 367:Core/Src/bootloader.c ****             /* Unknown command */
 368:Core/Src/bootloader.c ****             Bootloader_SendNACK(ERR_INVALID_COMMAND);
 369:Core/Src/bootloader.c ****             break;
 370:Core/Src/bootloader.c ****     }
 371:Core/Src/bootloader.c **** }
 372:Core/Src/bootloader.c **** 
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 8


 373:Core/Src/bootloader.c **** /**
 374:Core/Src/bootloader.c ****   * @brief  Erase application flash area
 375:Core/Src/bootloader.c ****   * @retval Error code
 376:Core/Src/bootloader.c ****   */
 377:Core/Src/bootloader.c **** static uint8_t Bootloader_EraseApplicationFlash(void)
 378:Core/Src/bootloader.c **** {
 379:Core/Src/bootloader.c ****     FLASH_EraseInitTypeDef erase_init;
 380:Core/Src/bootloader.c ****     uint32_t page_error;
 381:Core/Src/bootloader.c ****     HAL_StatusTypeDef status;
 382:Core/Src/bootloader.c ****     
 383:Core/Src/bootloader.c ****     /* Calculate first and last pages for application */
 384:Core/Src/bootloader.c ****     uint32_t first_page = (APPLICATION_ADDRESS - 0x08000000) / FLASH_PAGE_SIZE;
 385:Core/Src/bootloader.c ****     uint32_t num_pages = APPLICATION_SIZE / FLASH_PAGE_SIZE;
 386:Core/Src/bootloader.c ****     
 387:Core/Src/bootloader.c ****     /* Unlock flash */
 388:Core/Src/bootloader.c ****     HAL_FLASH_Unlock();
 389:Core/Src/bootloader.c ****     
 390:Core/Src/bootloader.c ****     /* Clear all flash flags */
 391:Core/Src/bootloader.c ****     __HAL_FLASH_CLEAR_FLAG(FLASH_FLAG_ALL_ERRORS);
 392:Core/Src/bootloader.c ****     
 393:Core/Src/bootloader.c ****     /* Configure erase */
 394:Core/Src/bootloader.c ****     erase_init.TypeErase = FLASH_TYPEERASE_PAGES;
 395:Core/Src/bootloader.c ****     erase_init.Banks = FLASH_BANK_1;
 396:Core/Src/bootloader.c ****     erase_init.Page = first_page;
 397:Core/Src/bootloader.c ****     erase_init.NbPages = num_pages;
 398:Core/Src/bootloader.c ****     
 399:Core/Src/bootloader.c ****     /* Perform erase */
 400:Core/Src/bootloader.c ****     status = HAL_FLASHEx_Erase(&erase_init, &page_error);
 401:Core/Src/bootloader.c ****     
 402:Core/Src/bootloader.c ****     /* Lock flash */
 403:Core/Src/bootloader.c ****     HAL_FLASH_Lock();
 404:Core/Src/bootloader.c ****     
 405:Core/Src/bootloader.c ****     if (status != HAL_OK)
 406:Core/Src/bootloader.c ****     {
 407:Core/Src/bootloader.c ****         bootloader_status.last_error = ERR_FLASH_ERASE_FAILED;
 408:Core/Src/bootloader.c ****         return ERR_FLASH_ERASE_FAILED;
 409:Core/Src/bootloader.c ****     }
 410:Core/Src/bootloader.c ****     
 411:Core/Src/bootloader.c ****     bootloader_status.last_error = ERR_NONE;
 412:Core/Src/bootloader.c ****     return ERR_NONE;
 413:Core/Src/bootloader.c **** }
 414:Core/Src/bootloader.c **** 
 415:Core/Src/bootloader.c **** /**
 416:Core/Src/bootloader.c ****   * @brief  Write data to flash
 417:Core/Src/bootloader.c ****   * @param  address: Flash address to write
 418:Core/Src/bootloader.c ****   * @param  data: Pointer to data buffer
 419:Core/Src/bootloader.c ****   * @param  length: Number of bytes to write (must be multiple of 8)
 420:Core/Src/bootloader.c ****   * @retval Error code
 421:Core/Src/bootloader.c ****   */
 422:Core/Src/bootloader.c **** static uint8_t Bootloader_WriteFlash(uint32_t address, uint8_t *data, uint16_t length)
 423:Core/Src/bootloader.c **** {
 424:Core/Src/bootloader.c ****     HAL_StatusTypeDef status = HAL_OK;
 425:Core/Src/bootloader.c ****     uint32_t i;
 426:Core/Src/bootloader.c ****     uint64_t data64;
 427:Core/Src/bootloader.c ****     
 428:Core/Src/bootloader.c ****     /* Validate parameters */
 429:Core/Src/bootloader.c ****     if (address < APPLICATION_ADDRESS || address > FLASH_END_ADDRESS)
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 9


 430:Core/Src/bootloader.c ****     {
 431:Core/Src/bootloader.c ****         bootloader_status.last_error = ERR_INVALID_ADDRESS;
 432:Core/Src/bootloader.c ****         return ERR_INVALID_ADDRESS;
 433:Core/Src/bootloader.c ****     }
 434:Core/Src/bootloader.c ****     
 435:Core/Src/bootloader.c ****     /* Length must be multiple of 8 for double word programming */
 436:Core/Src/bootloader.c ****     if (length % 8 != 0)
 437:Core/Src/bootloader.c ****     {
 438:Core/Src/bootloader.c ****         bootloader_status.last_error = ERR_INVALID_DATA_LENGTH;
 439:Core/Src/bootloader.c ****         return ERR_INVALID_DATA_LENGTH;
 440:Core/Src/bootloader.c ****     }
 441:Core/Src/bootloader.c ****     
 442:Core/Src/bootloader.c ****     /* Unlock flash */
 443:Core/Src/bootloader.c ****     HAL_FLASH_Unlock();
 444:Core/Src/bootloader.c ****     
 445:Core/Src/bootloader.c ****     /* Clear all flash flags */
 446:Core/Src/bootloader.c ****     __HAL_FLASH_CLEAR_FLAG(FLASH_FLAG_ALL_ERRORS);
 447:Core/Src/bootloader.c ****     
 448:Core/Src/bootloader.c ****     /* Write data in 64-bit chunks */
 449:Core/Src/bootloader.c ****     for (i = 0; i < length; i += 8)
 450:Core/Src/bootloader.c ****     {
 451:Core/Src/bootloader.c ****         /* Combine 8 bytes into 64-bit value */
 452:Core/Src/bootloader.c ****         data64 = ((uint64_t)data[i + 0] << 0)  |
 453:Core/Src/bootloader.c ****                  ((uint64_t)data[i + 1] << 8)  |
 454:Core/Src/bootloader.c ****                  ((uint64_t)data[i + 2] << 16) |
 455:Core/Src/bootloader.c ****                  ((uint64_t)data[i + 3] << 24) |
 456:Core/Src/bootloader.c ****                  ((uint64_t)data[i + 4] << 32) |
 457:Core/Src/bootloader.c ****                  ((uint64_t)data[i + 5] << 40) |
 458:Core/Src/bootloader.c ****                  ((uint64_t)data[i + 6] << 48) |
 459:Core/Src/bootloader.c ****                  ((uint64_t)data[i + 7] << 56);
 460:Core/Src/bootloader.c ****         
 461:Core/Src/bootloader.c ****         status = HAL_FLASH_Program(FLASH_TYPEPROGRAM_DOUBLEWORD, address + i, data64);
 462:Core/Src/bootloader.c ****         
 463:Core/Src/bootloader.c ****         if (status != HAL_OK)
 464:Core/Src/bootloader.c ****         {
 465:Core/Src/bootloader.c ****             break;
 466:Core/Src/bootloader.c ****         }
 467:Core/Src/bootloader.c ****     }
 468:Core/Src/bootloader.c ****     
 469:Core/Src/bootloader.c ****     /* Lock flash */
 470:Core/Src/bootloader.c ****     HAL_FLASH_Lock();
 471:Core/Src/bootloader.c ****     
 472:Core/Src/bootloader.c ****     if (status != HAL_OK)
 473:Core/Src/bootloader.c ****     {
 474:Core/Src/bootloader.c ****         bootloader_status.last_error = ERR_FLASH_WRITE_FAILED;
 475:Core/Src/bootloader.c ****         return ERR_FLASH_WRITE_FAILED;
 476:Core/Src/bootloader.c ****     }
 477:Core/Src/bootloader.c ****     
 478:Core/Src/bootloader.c ****     bootloader_status.last_error = ERR_NONE;
 479:Core/Src/bootloader.c ****     return ERR_NONE;
 480:Core/Src/bootloader.c **** }
 481:Core/Src/bootloader.c **** 
 482:Core/Src/bootloader.c **** /**
 483:Core/Src/bootloader.c ****   * @brief  Read data from flash
 484:Core/Src/bootloader.c ****   * @param  address: Flash address to read
 485:Core/Src/bootloader.c ****   * @param  data: Pointer to data buffer
 486:Core/Src/bootloader.c ****   * @param  length: Number of bytes to read
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 10


 487:Core/Src/bootloader.c ****   * @retval Error code
 488:Core/Src/bootloader.c ****   */
 489:Core/Src/bootloader.c **** static uint8_t Bootloader_ReadFlash(uint32_t address, uint8_t *data, uint16_t length)
 490:Core/Src/bootloader.c **** {
  29              		.loc 1 490 1 view -0
  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33              		@ link register save eliminated.
 491:Core/Src/bootloader.c ****     uint16_t i;
  34              		.loc 1 491 5 view .LVU1
 492:Core/Src/bootloader.c ****     uint8_t *flash_ptr = (uint8_t *)address;
  35              		.loc 1 492 5 view .LVU2
 493:Core/Src/bootloader.c ****     
 494:Core/Src/bootloader.c ****     /* Validate address */
 495:Core/Src/bootloader.c ****     if (address < APPLICATION_ADDRESS || address > FLASH_END_ADDRESS)
  36              		.loc 1 495 5 view .LVU3
  37              		.loc 1 495 39 is_stmt 0 view .LVU4
  38 0000 00F17843 		add	r3, r0, #-134217728
  39 0004 A3F50043 		sub	r3, r3, #32768
  40              		.loc 1 495 8 view .LVU5
  41 0008 B3F5603F 		cmp	r3, #229376
  42 000c 0BD2     		bcs	.L5
 496:Core/Src/bootloader.c ****     {
 497:Core/Src/bootloader.c ****         return ERR_INVALID_ADDRESS;
 498:Core/Src/bootloader.c ****     }
 499:Core/Src/bootloader.c ****     
 500:Core/Src/bootloader.c ****     /* Read data */
 501:Core/Src/bootloader.c ****     for (i = 0; i < length; i++)
  43              		.loc 1 501 12 view .LVU6
  44 000e 0023     		movs	r3, #0
  45 0010 05E0     		b	.L3
  46              	.LVL1:
  47              	.L4:
 502:Core/Src/bootloader.c ****     {
 503:Core/Src/bootloader.c ****         data[i] = flash_ptr[i];
  48              		.loc 1 503 9 is_stmt 1 view .LVU7
  49              		.loc 1 503 28 is_stmt 0 view .LVU8
  50 0012 10F803C0 		ldrb	ip, [r0, r3]	@ zero_extendqisi2
  51              		.loc 1 503 17 view .LVU9
  52 0016 01F803C0 		strb	ip, [r1, r3]
 501:Core/Src/bootloader.c ****     {
  53              		.loc 1 501 30 is_stmt 1 discriminator 3 view .LVU10
  54 001a 0133     		adds	r3, r3, #1
  55              	.LVL2:
 501:Core/Src/bootloader.c ****     {
  56              		.loc 1 501 30 is_stmt 0 discriminator 3 view .LVU11
  57 001c 9BB2     		uxth	r3, r3
  58              	.LVL3:
  59              	.L3:
 501:Core/Src/bootloader.c ****     {
  60              		.loc 1 501 19 is_stmt 1 discriminator 1 view .LVU12
  61 001e 9342     		cmp	r3, r2
  62 0020 F7D3     		bcc	.L4
 504:Core/Src/bootloader.c ****     }
 505:Core/Src/bootloader.c ****     
 506:Core/Src/bootloader.c ****     return ERR_NONE;
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 11


  63              		.loc 1 506 12 is_stmt 0 view .LVU13
  64 0022 0020     		movs	r0, #0
  65              	.LVL4:
  66              		.loc 1 506 12 view .LVU14
  67 0024 7047     		bx	lr
  68              	.LVL5:
  69              	.L5:
 497:Core/Src/bootloader.c ****     }
  70              		.loc 1 497 16 view .LVU15
  71 0026 0220     		movs	r0, #2
  72              	.LVL6:
 507:Core/Src/bootloader.c **** }
  73              		.loc 1 507 1 view .LVU16
  74 0028 7047     		bx	lr
  75              		.cfi_endproc
  76              	.LFE138:
  78              		.section	.text.Bootloader_ConfigureCANFilter,"ax",%progbits
  79              		.align	1
  80              		.syntax unified
  81              		.thumb
  82              		.thumb_func
  84              	Bootloader_ConfigureCANFilter:
  85              	.LFB133:
  86:Core/Src/bootloader.c ****     CAN_FilterTypeDef can_filter;
  86              		.loc 1 86 1 is_stmt 1 view -0
  87              		.cfi_startproc
  88              		@ args = 0, pretend = 0, frame = 40
  89              		@ frame_needed = 0, uses_anonymous_args = 0
  90 0000 00B5     		push	{lr}
  91              		.cfi_def_cfa_offset 4
  92              		.cfi_offset 14, -4
  93 0002 8BB0     		sub	sp, sp, #44
  94              		.cfi_def_cfa_offset 48
  87:Core/Src/bootloader.c ****     
  95              		.loc 1 87 5 view .LVU18
  89:Core/Src/bootloader.c ****     can_filter.FilterMode = CAN_FILTERMODE_IDMASK;
  96              		.loc 1 89 5 view .LVU19
  89:Core/Src/bootloader.c ****     can_filter.FilterMode = CAN_FILTERMODE_IDMASK;
  97              		.loc 1 89 27 is_stmt 0 view .LVU20
  98 0004 0023     		movs	r3, #0
  99 0006 0593     		str	r3, [sp, #20]
  90:Core/Src/bootloader.c ****     can_filter.FilterScale = CAN_FILTERSCALE_32BIT;
 100              		.loc 1 90 5 is_stmt 1 view .LVU21
  90:Core/Src/bootloader.c ****     can_filter.FilterScale = CAN_FILTERSCALE_32BIT;
 101              		.loc 1 90 27 is_stmt 0 view .LVU22
 102 0008 0693     		str	r3, [sp, #24]
  91:Core/Src/bootloader.c ****     /* For extended IDs: bits [28:13] in FilterIdHigh, bits [12:0] + IDE in FilterIdLow */
 103              		.loc 1 91 5 is_stmt 1 view .LVU23
  91:Core/Src/bootloader.c ****     /* For extended IDs: bits [28:13] in FilterIdHigh, bits [12:0] + IDE in FilterIdLow */
 104              		.loc 1 91 28 is_stmt 0 view .LVU24
 105 000a 0122     		movs	r2, #1
 106 000c 0792     		str	r2, [sp, #28]
  93:Core/Src/bootloader.c ****     can_filter.FilterIdLow = ((CAN_HOST_ID << 3) & 0xFFF8) | 0x0004;  /* IDE bit set */
 107              		.loc 1 93 5 is_stmt 1 view .LVU25
  93:Core/Src/bootloader.c ****     can_filter.FilterIdLow = ((CAN_HOST_ID << 3) & 0xFFF8) | 0x0004;  /* IDE bit set */
 108              		.loc 1 93 29 is_stmt 0 view .LVU26
 109 000e 4FF44041 		mov	r1, #49152
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 12


 110 0012 0091     		str	r1, [sp]
  94:Core/Src/bootloader.c ****     can_filter.FilterMaskIdHigh = 0xFFFF;  /* Match all upper bits */
 111              		.loc 1 94 5 is_stmt 1 view .LVU27
  94:Core/Src/bootloader.c ****     can_filter.FilterMaskIdHigh = 0xFFFF;  /* Match all upper bits */
 112              		.loc 1 94 28 is_stmt 0 view .LVU28
 113 0014 43F60C01 		movw	r1, #14348
 114 0018 0191     		str	r1, [sp, #4]
  95:Core/Src/bootloader.c ****     can_filter.FilterMaskIdLow = 0xFFFC;   /* Match lower bits + IDE */
 115              		.loc 1 95 5 is_stmt 1 view .LVU29
  95:Core/Src/bootloader.c ****     can_filter.FilterMaskIdLow = 0xFFFC;   /* Match lower bits + IDE */
 116              		.loc 1 95 33 is_stmt 0 view .LVU30
 117 001a 4FF6FF71 		movw	r1, #65535
 118 001e 0291     		str	r1, [sp, #8]
  96:Core/Src/bootloader.c ****     can_filter.FilterFIFOAssignment = CAN_RX_FIFO0;
 119              		.loc 1 96 5 is_stmt 1 view .LVU31
  96:Core/Src/bootloader.c ****     can_filter.FilterFIFOAssignment = CAN_RX_FIFO0;
 120              		.loc 1 96 32 is_stmt 0 view .LVU32
 121 0020 4FF6FC71 		movw	r1, #65532
 122 0024 0391     		str	r1, [sp, #12]
  97:Core/Src/bootloader.c ****     can_filter.FilterActivation = ENABLE;
 123              		.loc 1 97 5 is_stmt 1 view .LVU33
  97:Core/Src/bootloader.c ****     can_filter.FilterActivation = ENABLE;
 124              		.loc 1 97 37 is_stmt 0 view .LVU34
 125 0026 0493     		str	r3, [sp, #16]
  98:Core/Src/bootloader.c ****     can_filter.SlaveStartFilterBank = 14;
 126              		.loc 1 98 5 is_stmt 1 view .LVU35
  98:Core/Src/bootloader.c ****     can_filter.SlaveStartFilterBank = 14;
 127              		.loc 1 98 33 is_stmt 0 view .LVU36
 128 0028 0892     		str	r2, [sp, #32]
  99:Core/Src/bootloader.c ****     
 129              		.loc 1 99 5 is_stmt 1 view .LVU37
  99:Core/Src/bootloader.c ****     
 130              		.loc 1 99 37 is_stmt 0 view .LVU38
 131 002a 0E23     		movs	r3, #14
 132 002c 0993     		str	r3, [sp, #36]
 101:Core/Src/bootloader.c ****     {
 133              		.loc 1 101 5 is_stmt 1 view .LVU39
 101:Core/Src/bootloader.c ****     {
 134              		.loc 1 101 9 is_stmt 0 view .LVU40
 135 002e 6946     		mov	r1, sp
 136 0030 054B     		ldr	r3, .L10
 137 0032 1868     		ldr	r0, [r3]
 138 0034 FFF7FEFF 		bl	HAL_CAN_ConfigFilter
 139              	.LVL7:
 101:Core/Src/bootloader.c ****     {
 140              		.loc 1 101 8 discriminator 1 view .LVU41
 141 0038 10B9     		cbnz	r0, .L9
 142              	.L6:
 105:Core/Src/bootloader.c **** 
 143              		.loc 1 105 1 view .LVU42
 144 003a 0BB0     		add	sp, sp, #44
 145              		.cfi_remember_state
 146              		.cfi_def_cfa_offset 4
 147              		@ sp needed
 148 003c 5DF804FB 		ldr	pc, [sp], #4
 149              	.L9:
 150              		.cfi_restore_state
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 13


 103:Core/Src/bootloader.c ****     }
 151              		.loc 1 103 9 is_stmt 1 view .LVU43
 152 0040 FFF7FEFF 		bl	Error_Handler
 153              	.LVL8:
 105:Core/Src/bootloader.c **** 
 154              		.loc 1 105 1 is_stmt 0 view .LVU44
 155 0044 F9E7     		b	.L6
 156              	.L11:
 157 0046 00BF     		.align	2
 158              	.L10:
 159 0048 00000000 		.word	hcan_bootloader
 160              		.cfi_endproc
 161              	.LFE133:
 163              		.section	.text.Bootloader_WaitForCANTransmission,"ax",%progbits
 164              		.align	1
 165              		.syntax unified
 166              		.thumb
 167              		.thumb_func
 169              	Bootloader_WaitForCANTransmission:
 170              	.LFB141:
 508:Core/Src/bootloader.c **** 
 509:Core/Src/bootloader.c **** /**
 510:Core/Src/bootloader.c ****   * @brief  Check if valid application exists
 511:Core/Src/bootloader.c ****   * @retval 1 if valid application, 0 otherwise
 512:Core/Src/bootloader.c ****   */
 513:Core/Src/bootloader.c **** uint8_t Bootloader_CheckValidApplication(void)
 514:Core/Src/bootloader.c **** {
 515:Core/Src/bootloader.c ****     uint32_t stack_pointer = *(__IO uint32_t *)APPLICATION_ADDRESS;
 516:Core/Src/bootloader.c ****     uint32_t reset_handler = *(__IO uint32_t *)(APPLICATION_ADDRESS + 4);
 517:Core/Src/bootloader.c ****     
 518:Core/Src/bootloader.c ****     /* Check if stack pointer is in valid RAM range */
 519:Core/Src/bootloader.c ****     if ((stack_pointer & 0xFFF00000) != 0x20000000)
 520:Core/Src/bootloader.c ****     {
 521:Core/Src/bootloader.c ****         return 0;
 522:Core/Src/bootloader.c ****     }
 523:Core/Src/bootloader.c ****     
 524:Core/Src/bootloader.c ****     /* Check if reset handler is in valid flash range (odd address for Thumb) */
 525:Core/Src/bootloader.c ****     if ((reset_handler & 0xFF000000) != 0x08000000 || (reset_handler & 0x01) == 0)
 526:Core/Src/bootloader.c ****     {
 527:Core/Src/bootloader.c ****         return 0;
 528:Core/Src/bootloader.c ****     }
 529:Core/Src/bootloader.c ****     
 530:Core/Src/bootloader.c ****     return 1;
 531:Core/Src/bootloader.c **** }
 532:Core/Src/bootloader.c **** 
 533:Core/Src/bootloader.c **** /**
 534:Core/Src/bootloader.c ****   * @brief  De-initialize peripherals before jumping to application
 535:Core/Src/bootloader.c ****   * @retval None
 536:Core/Src/bootloader.c ****   */
 537:Core/Src/bootloader.c **** static void Bootloader_DeInit(void)
 538:Core/Src/bootloader.c **** {
 539:Core/Src/bootloader.c ****     /* Disable CAN */
 540:Core/Src/bootloader.c ****     HAL_CAN_DeactivateNotification(hcan_bootloader, CAN_IT_RX_FIFO0_MSG_PENDING);
 541:Core/Src/bootloader.c ****     HAL_CAN_Stop(hcan_bootloader);
 542:Core/Src/bootloader.c ****     HAL_CAN_MspDeInit(hcan_bootloader);
 543:Core/Src/bootloader.c ****     
 544:Core/Src/bootloader.c ****     /* Disable SysTick */
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 14


 545:Core/Src/bootloader.c ****     SysTick->CTRL = 0;
 546:Core/Src/bootloader.c ****     SysTick->LOAD = 0;
 547:Core/Src/bootloader.c ****     SysTick->VAL = 0;
 548:Core/Src/bootloader.c ****     
 549:Core/Src/bootloader.c ****     /* Disable all interrupts */
 550:Core/Src/bootloader.c ****     __disable_irq();
 551:Core/Src/bootloader.c ****     
 552:Core/Src/bootloader.c ****     /* Disable all peripheral clocks */
 553:Core/Src/bootloader.c ****     __HAL_RCC_GPIOA_CLK_DISABLE();
 554:Core/Src/bootloader.c ****     __HAL_RCC_CAN1_CLK_DISABLE();
 555:Core/Src/bootloader.c **** }
 556:Core/Src/bootloader.c **** 
 557:Core/Src/bootloader.c **** /**
 558:Core/Src/bootloader.c ****   * @brief  Wait for all CAN transmissions to complete
 559:Core/Src/bootloader.c ****   * @retval None
 560:Core/Src/bootloader.c ****   */
 561:Core/Src/bootloader.c **** static void Bootloader_WaitForCANTransmission(void)
 562:Core/Src/bootloader.c **** {
 171              		.loc 1 562 1 is_stmt 1 view -0
 172              		.cfi_startproc
 173              		@ args = 0, pretend = 0, frame = 0
 174              		@ frame_needed = 0, uses_anonymous_args = 0
 175 0000 10B5     		push	{r4, lr}
 176              		.cfi_def_cfa_offset 8
 177              		.cfi_offset 4, -8
 178              		.cfi_offset 14, -4
 563:Core/Src/bootloader.c ****     uint32_t timeout = 0;
 179              		.loc 1 563 5 view .LVU46
 180              	.LVL9:
 564:Core/Src/bootloader.c ****     
 565:Core/Src/bootloader.c ****     /* Wait until all 3 TX mailboxes are free (all transmissions complete) */
 566:Core/Src/bootloader.c ****     while (HAL_CAN_GetTxMailboxesFreeLevel(hcan_bootloader) != 3 && timeout < 1000000)
 181              		.loc 1 566 5 view .LVU47
 563:Core/Src/bootloader.c ****     uint32_t timeout = 0;
 182              		.loc 1 563 14 is_stmt 0 view .LVU48
 183 0002 0024     		movs	r4, #0
 184              	.LVL10:
 185              	.L13:
 186              		.loc 1 566 66 is_stmt 1 view .LVU49
 187              		.loc 1 566 12 is_stmt 0 view .LVU50
 188 0004 074B     		ldr	r3, .L17
 189 0006 1868     		ldr	r0, [r3]
 190 0008 FFF7FEFF 		bl	HAL_CAN_GetTxMailboxesFreeLevel
 191              	.LVL11:
 192              		.loc 1 566 66 discriminator 1 view .LVU51
 193 000c 0328     		cmp	r0, #3
 194 000e 04D0     		beq	.L14
 195 0010 054B     		ldr	r3, .L17+4
 196 0012 9C42     		cmp	r4, r3
 197 0014 01D8     		bhi	.L14
 567:Core/Src/bootloader.c ****     {
 568:Core/Src/bootloader.c ****         timeout++;
 198              		.loc 1 568 9 is_stmt 1 view .LVU52
 199              		.loc 1 568 16 is_stmt 0 view .LVU53
 200 0016 0134     		adds	r4, r4, #1
 201              	.LVL12:
 202              		.loc 1 568 16 view .LVU54
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 15


 203 0018 F4E7     		b	.L13
 204              	.LVL13:
 205              	.L14:
 569:Core/Src/bootloader.c ****     }
 570:Core/Src/bootloader.c ****     
 571:Core/Src/bootloader.c ****     /* Additional delay to ensure message physically leaves the CAN controller */
 572:Core/Src/bootloader.c ****     HAL_Delay(10);
 206              		.loc 1 572 5 is_stmt 1 view .LVU55
 207 001a 0A20     		movs	r0, #10
 208 001c FFF7FEFF 		bl	HAL_Delay
 209              	.LVL14:
 573:Core/Src/bootloader.c **** }
 210              		.loc 1 573 1 is_stmt 0 view .LVU56
 211 0020 10BD     		pop	{r4, pc}
 212              	.LVL15:
 213              	.L18:
 214              		.loc 1 573 1 view .LVU57
 215 0022 00BF     		.align	2
 216              	.L17:
 217 0024 00000000 		.word	hcan_bootloader
 218 0028 3F420F00 		.word	999999
 219              		.cfi_endproc
 220              	.LFE141:
 222              		.section	.text.Bootloader_EraseApplicationFlash,"ax",%progbits
 223              		.align	1
 224              		.syntax unified
 225              		.thumb
 226              		.thumb_func
 228              	Bootloader_EraseApplicationFlash:
 229              	.LFB136:
 378:Core/Src/bootloader.c ****     FLASH_EraseInitTypeDef erase_init;
 230              		.loc 1 378 1 is_stmt 1 view -0
 231              		.cfi_startproc
 232              		@ args = 0, pretend = 0, frame = 24
 233              		@ frame_needed = 0, uses_anonymous_args = 0
 234 0000 10B5     		push	{r4, lr}
 235              		.cfi_def_cfa_offset 8
 236              		.cfi_offset 4, -8
 237              		.cfi_offset 14, -4
 238 0002 86B0     		sub	sp, sp, #24
 239              		.cfi_def_cfa_offset 32
 379:Core/Src/bootloader.c ****     uint32_t page_error;
 240              		.loc 1 379 5 view .LVU59
 380:Core/Src/bootloader.c ****     HAL_StatusTypeDef status;
 241              		.loc 1 380 5 view .LVU60
 381:Core/Src/bootloader.c ****     
 242              		.loc 1 381 5 view .LVU61
 384:Core/Src/bootloader.c ****     uint32_t num_pages = APPLICATION_SIZE / FLASH_PAGE_SIZE;
 243              		.loc 1 384 5 view .LVU62
 244              	.LVL16:
 385:Core/Src/bootloader.c ****     
 245              		.loc 1 385 5 view .LVU63
 388:Core/Src/bootloader.c ****     
 246              		.loc 1 388 5 view .LVU64
 247 0004 FFF7FEFF 		bl	HAL_FLASH_Unlock
 248              	.LVL17:
 391:Core/Src/bootloader.c ****     
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 16


 249              		.loc 1 391 5 view .LVU65
 391:Core/Src/bootloader.c ****     
 250              		.loc 1 391 5 view .LVU66
 391:Core/Src/bootloader.c ****     
 251              		.loc 1 391 5 discriminator 1 view .LVU67
 252 0008 104B     		ldr	r3, .L24
 253 000a 9A69     		ldr	r2, [r3, #24]
 254 000c 42F04042 		orr	r2, r2, #-1073741824
 255 0010 9A61     		str	r2, [r3, #24]
 391:Core/Src/bootloader.c ****     
 256              		.loc 1 391 5 discriminator 3 view .LVU68
 391:Core/Src/bootloader.c ****     
 257              		.loc 1 391 5 discriminator 4 view .LVU69
 258 0012 4CF2FA32 		movw	r2, #50170
 259 0016 1A61     		str	r2, [r3, #16]
 391:Core/Src/bootloader.c ****     
 260              		.loc 1 391 5 discriminator 6 view .LVU70
 394:Core/Src/bootloader.c ****     erase_init.Banks = FLASH_BANK_1;
 261              		.loc 1 394 5 view .LVU71
 394:Core/Src/bootloader.c ****     erase_init.Banks = FLASH_BANK_1;
 262              		.loc 1 394 26 is_stmt 0 view .LVU72
 263 0018 0023     		movs	r3, #0
 264 001a 0293     		str	r3, [sp, #8]
 395:Core/Src/bootloader.c ****     erase_init.Page = first_page;
 265              		.loc 1 395 5 is_stmt 1 view .LVU73
 395:Core/Src/bootloader.c ****     erase_init.Page = first_page;
 266              		.loc 1 395 22 is_stmt 0 view .LVU74
 267 001c 0123     		movs	r3, #1
 268 001e 0393     		str	r3, [sp, #12]
 396:Core/Src/bootloader.c ****     erase_init.NbPages = num_pages;
 269              		.loc 1 396 5 is_stmt 1 view .LVU75
 396:Core/Src/bootloader.c ****     erase_init.NbPages = num_pages;
 270              		.loc 1 396 21 is_stmt 0 view .LVU76
 271 0020 1023     		movs	r3, #16
 272 0022 0493     		str	r3, [sp, #16]
 397:Core/Src/bootloader.c ****     
 273              		.loc 1 397 5 is_stmt 1 view .LVU77
 397:Core/Src/bootloader.c ****     
 274              		.loc 1 397 24 is_stmt 0 view .LVU78
 275 0024 7023     		movs	r3, #112
 276 0026 0593     		str	r3, [sp, #20]
 400:Core/Src/bootloader.c ****     
 277              		.loc 1 400 5 is_stmt 1 view .LVU79
 400:Core/Src/bootloader.c ****     
 278              		.loc 1 400 14 is_stmt 0 view .LVU80
 279 0028 01A9     		add	r1, sp, #4
 280 002a 02A8     		add	r0, sp, #8
 281 002c FFF7FEFF 		bl	HAL_FLASHEx_Erase
 282              	.LVL18:
 283 0030 0446     		mov	r4, r0
 284              	.LVL19:
 403:Core/Src/bootloader.c ****     
 285              		.loc 1 403 5 is_stmt 1 view .LVU81
 286 0032 FFF7FEFF 		bl	HAL_FLASH_Lock
 287              	.LVL20:
 405:Core/Src/bootloader.c ****     {
 288              		.loc 1 405 5 view .LVU82
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 17


 405:Core/Src/bootloader.c ****     {
 289              		.loc 1 405 8 is_stmt 0 view .LVU83
 290 0036 2CB9     		cbnz	r4, .L23
 411:Core/Src/bootloader.c ****     return ERR_NONE;
 291              		.loc 1 411 5 is_stmt 1 view .LVU84
 411:Core/Src/bootloader.c ****     return ERR_NONE;
 292              		.loc 1 411 34 is_stmt 0 view .LVU85
 293 0038 054B     		ldr	r3, .L24+4
 294 003a 0022     		movs	r2, #0
 295 003c 1A74     		strb	r2, [r3, #16]
 412:Core/Src/bootloader.c **** }
 296              		.loc 1 412 5 is_stmt 1 view .LVU86
 297              	.LVL21:
 298              	.L21:
 413:Core/Src/bootloader.c **** 
 299              		.loc 1 413 1 is_stmt 0 view .LVU87
 300 003e 2046     		mov	r0, r4
 301 0040 06B0     		add	sp, sp, #24
 302              		.cfi_remember_state
 303              		.cfi_def_cfa_offset 8
 304              		@ sp needed
 305 0042 10BD     		pop	{r4, pc}
 306              	.LVL22:
 307              	.L23:
 308              		.cfi_restore_state
 407:Core/Src/bootloader.c ****         return ERR_FLASH_ERASE_FAILED;
 309              		.loc 1 407 9 is_stmt 1 view .LVU88
 407:Core/Src/bootloader.c ****         return ERR_FLASH_ERASE_FAILED;
 310              		.loc 1 407 38 is_stmt 0 view .LVU89
 311 0044 0324     		movs	r4, #3
 312              	.LVL23:
 407:Core/Src/bootloader.c ****         return ERR_FLASH_ERASE_FAILED;
 313              		.loc 1 407 38 view .LVU90
 314 0046 024B     		ldr	r3, .L24+4
 315 0048 1C74     		strb	r4, [r3, #16]
 408:Core/Src/bootloader.c ****     }
 316              		.loc 1 408 9 is_stmt 1 view .LVU91
 408:Core/Src/bootloader.c ****     }
 317              		.loc 1 408 16 is_stmt 0 view .LVU92
 318 004a F8E7     		b	.L21
 319              	.L25:
 320              		.align	2
 321              	.L24:
 322 004c 00200240 		.word	1073881088
 323 0050 00000000 		.word	bootloader_status
 324              		.cfi_endproc
 325              	.LFE136:
 327              		.section	.text.Bootloader_WriteFlash,"ax",%progbits
 328              		.align	1
 329              		.syntax unified
 330              		.thumb
 331              		.thumb_func
 333              	Bootloader_WriteFlash:
 334              	.LVL24:
 335              	.LFB137:
 423:Core/Src/bootloader.c ****     HAL_StatusTypeDef status = HAL_OK;
 336              		.loc 1 423 1 is_stmt 1 view -0
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 18


 337              		.cfi_startproc
 338              		@ args = 0, pretend = 0, frame = 0
 339              		@ frame_needed = 0, uses_anonymous_args = 0
 423:Core/Src/bootloader.c ****     HAL_StatusTypeDef status = HAL_OK;
 340              		.loc 1 423 1 is_stmt 0 view .LVU94
 341 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 342              		.cfi_def_cfa_offset 24
 343              		.cfi_offset 4, -24
 344              		.cfi_offset 5, -20
 345              		.cfi_offset 6, -16
 346              		.cfi_offset 7, -12
 347              		.cfi_offset 8, -8
 348              		.cfi_offset 14, -4
 424:Core/Src/bootloader.c ****     uint32_t i;
 349              		.loc 1 424 5 is_stmt 1 view .LVU95
 350              	.LVL25:
 425:Core/Src/bootloader.c ****     uint64_t data64;
 351              		.loc 1 425 5 view .LVU96
 426:Core/Src/bootloader.c ****     
 352              		.loc 1 426 5 view .LVU97
 429:Core/Src/bootloader.c ****     {
 353              		.loc 1 429 5 view .LVU98
 429:Core/Src/bootloader.c ****     {
 354              		.loc 1 429 39 is_stmt 0 view .LVU99
 355 0004 00F17843 		add	r3, r0, #-134217728
 356 0008 A3F50043 		sub	r3, r3, #32768
 429:Core/Src/bootloader.c ****     {
 357              		.loc 1 429 8 view .LVU100
 358 000c B3F5603F 		cmp	r3, #229376
 359 0010 38D2     		bcs	.L35
 360 0012 0746     		mov	r7, r0
 361 0014 0D46     		mov	r5, r1
 362 0016 1646     		mov	r6, r2
 436:Core/Src/bootloader.c ****     {
 363              		.loc 1 436 5 is_stmt 1 view .LVU101
 436:Core/Src/bootloader.c ****     {
 364              		.loc 1 436 8 is_stmt 0 view .LVU102
 365 0018 12F0070F 		tst	r2, #7
 366 001c 38D1     		bne	.L36
 443:Core/Src/bootloader.c ****     
 367              		.loc 1 443 5 is_stmt 1 view .LVU103
 368 001e FFF7FEFF 		bl	HAL_FLASH_Unlock
 369              	.LVL26:
 446:Core/Src/bootloader.c ****     
 370              		.loc 1 446 5 view .LVU104
 446:Core/Src/bootloader.c ****     
 371              		.loc 1 446 5 view .LVU105
 446:Core/Src/bootloader.c ****     
 372              		.loc 1 446 5 discriminator 1 view .LVU106
 373 0022 274B     		ldr	r3, .L38
 374 0024 9A69     		ldr	r2, [r3, #24]
 375 0026 42F04042 		orr	r2, r2, #-1073741824
 376 002a 9A61     		str	r2, [r3, #24]
 446:Core/Src/bootloader.c ****     
 377              		.loc 1 446 5 discriminator 3 view .LVU107
 446:Core/Src/bootloader.c ****     
 378              		.loc 1 446 5 discriminator 4 view .LVU108
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 19


 379 002c 4CF2FA32 		movw	r2, #50170
 380 0030 1A61     		str	r2, [r3, #16]
 446:Core/Src/bootloader.c ****     
 381              		.loc 1 446 5 discriminator 6 view .LVU109
 449:Core/Src/bootloader.c ****     {
 382              		.loc 1 449 5 view .LVU110
 383              	.LVL27:
 449:Core/Src/bootloader.c ****     {
 384              		.loc 1 449 12 is_stmt 0 view .LVU111
 385 0032 0024     		movs	r4, #0
 424:Core/Src/bootloader.c ****     uint32_t i;
 386              		.loc 1 424 23 view .LVU112
 387 0034 A046     		mov	r8, r4
 388              	.LVL28:
 389              	.L30:
 449:Core/Src/bootloader.c ****     {
 390              		.loc 1 449 19 is_stmt 1 discriminator 1 view .LVU113
 391 0036 A642     		cmp	r6, r4
 392 0038 30D9     		bls	.L31
 452:Core/Src/bootloader.c ****                  ((uint64_t)data[i + 1] << 8)  |
 393              		.loc 1 452 9 view .LVU114
 452:Core/Src/bootloader.c ****                  ((uint64_t)data[i + 1] << 8)  |
 394              		.loc 1 452 33 is_stmt 0 view .LVU115
 395 003a 2A5D     		ldrb	r2, [r5, r4]	@ zero_extendqisi2
 453:Core/Src/bootloader.c ****                  ((uint64_t)data[i + 2] << 16) |
 396              		.loc 1 453 33 view .LVU116
 397 003c 05EB040C 		add	ip, r5, r4
 398 0040 9CF80130 		ldrb	r3, [ip, #1]	@ zero_extendqisi2
 452:Core/Src/bootloader.c ****                  ((uint64_t)data[i + 1] << 8)  |
 399              		.loc 1 452 48 view .LVU117
 400 0044 42EA0322 		orr	r2, r2, r3, lsl #8
 454:Core/Src/bootloader.c ****                  ((uint64_t)data[i + 3] << 24) |
 401              		.loc 1 454 33 view .LVU118
 402 0048 9CF80230 		ldrb	r3, [ip, #2]	@ zero_extendqisi2
 453:Core/Src/bootloader.c ****                  ((uint64_t)data[i + 2] << 16) |
 403              		.loc 1 453 48 view .LVU119
 404 004c 42EA0342 		orr	r2, r2, r3, lsl #16
 455:Core/Src/bootloader.c ****                  ((uint64_t)data[i + 4] << 32) |
 405              		.loc 1 455 33 view .LVU120
 406 0050 9CF80300 		ldrb	r0, [ip, #3]	@ zero_extendqisi2
 455:Core/Src/bootloader.c ****                  ((uint64_t)data[i + 4] << 32) |
 407              		.loc 1 455 48 view .LVU121
 408 0054 9CF80430 		ldrb	r3, [ip, #4]	@ zero_extendqisi2
 457:Core/Src/bootloader.c ****                  ((uint64_t)data[i + 6] << 48) |
 409              		.loc 1 457 33 view .LVU122
 410 0058 9CF80510 		ldrb	r1, [ip, #5]	@ zero_extendqisi2
 456:Core/Src/bootloader.c ****                  ((uint64_t)data[i + 5] << 40) |
 411              		.loc 1 456 48 view .LVU123
 412 005c 43EA0123 		orr	r3, r3, r1, lsl #8
 458:Core/Src/bootloader.c ****                  ((uint64_t)data[i + 7] << 56);
 413              		.loc 1 458 33 view .LVU124
 414 0060 9CF80610 		ldrb	r1, [ip, #6]	@ zero_extendqisi2
 457:Core/Src/bootloader.c ****                  ((uint64_t)data[i + 6] << 48) |
 415              		.loc 1 457 48 view .LVU125
 416 0064 43EA0143 		orr	r3, r3, r1, lsl #16
 459:Core/Src/bootloader.c ****         
 417              		.loc 1 459 33 view .LVU126
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 20


 418 0068 9CF80710 		ldrb	r1, [ip, #7]	@ zero_extendqisi2
 419              	.LVL29:
 461:Core/Src/bootloader.c ****         
 420              		.loc 1 461 9 is_stmt 1 view .LVU127
 461:Core/Src/bootloader.c ****         
 421              		.loc 1 461 18 is_stmt 0 view .LVU128
 422 006c 42EA0062 		orr	r2, r2, r0, lsl #24
 423              	.LVL30:
 461:Core/Src/bootloader.c ****         
 424              		.loc 1 461 18 view .LVU129
 425 0070 43EA0163 		orr	r3, r3, r1, lsl #24
 426              	.LVL31:
 461:Core/Src/bootloader.c ****         
 427              		.loc 1 461 18 view .LVU130
 428 0074 E119     		adds	r1, r4, r7
 429 0076 0020     		movs	r0, #0
 430 0078 FFF7FEFF 		bl	HAL_FLASH_Program
 431              	.LVL32:
 463:Core/Src/bootloader.c ****         {
 432              		.loc 1 463 9 is_stmt 1 view .LVU131
 463:Core/Src/bootloader.c ****         {
 433              		.loc 1 463 12 is_stmt 0 view .LVU132
 434 007c 8046     		mov	r8, r0
 435 007e 68B9     		cbnz	r0, .L31
 449:Core/Src/bootloader.c ****     {
 436              		.loc 1 449 31 is_stmt 1 discriminator 2 view .LVU133
 437 0080 0834     		adds	r4, r4, #8
 438              	.LVL33:
 449:Core/Src/bootloader.c ****     {
 439              		.loc 1 449 31 is_stmt 0 discriminator 2 view .LVU134
 440 0082 D8E7     		b	.L30
 441              	.LVL34:
 442              	.L35:
 431:Core/Src/bootloader.c ****         return ERR_INVALID_ADDRESS;
 443              		.loc 1 431 9 is_stmt 1 view .LVU135
 431:Core/Src/bootloader.c ****         return ERR_INVALID_ADDRESS;
 444              		.loc 1 431 38 is_stmt 0 view .LVU136
 445 0084 4FF00208 		mov	r8, #2
 446 0088 0E4B     		ldr	r3, .L38+4
 447 008a 83F81080 		strb	r8, [r3, #16]
 432:Core/Src/bootloader.c ****     }
 448              		.loc 1 432 9 is_stmt 1 view .LVU137
 432:Core/Src/bootloader.c ****     }
 449              		.loc 1 432 16 is_stmt 0 view .LVU138
 450 008e 0DE0     		b	.L28
 451              	.L36:
 438:Core/Src/bootloader.c ****         return ERR_INVALID_DATA_LENGTH;
 452              		.loc 1 438 9 is_stmt 1 view .LVU139
 438:Core/Src/bootloader.c ****         return ERR_INVALID_DATA_LENGTH;
 453              		.loc 1 438 38 is_stmt 0 view .LVU140
 454 0090 4FF00508 		mov	r8, #5
 455 0094 0B4B     		ldr	r3, .L38+4
 456 0096 83F81080 		strb	r8, [r3, #16]
 439:Core/Src/bootloader.c ****     }
 457              		.loc 1 439 9 is_stmt 1 view .LVU141
 439:Core/Src/bootloader.c ****     }
 458              		.loc 1 439 16 is_stmt 0 view .LVU142
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 21


 459 009a 07E0     		b	.L28
 460              	.LVL35:
 461              	.L31:
 470:Core/Src/bootloader.c ****     
 462              		.loc 1 470 5 is_stmt 1 view .LVU143
 463 009c FFF7FEFF 		bl	HAL_FLASH_Lock
 464              	.LVL36:
 472:Core/Src/bootloader.c ****     {
 465              		.loc 1 472 5 view .LVU144
 472:Core/Src/bootloader.c ****     {
 466              		.loc 1 472 8 is_stmt 0 view .LVU145
 467 00a0 B8F1000F 		cmp	r8, #0
 468 00a4 05D1     		bne	.L37
 478:Core/Src/bootloader.c ****     return ERR_NONE;
 469              		.loc 1 478 5 is_stmt 1 view .LVU146
 478:Core/Src/bootloader.c ****     return ERR_NONE;
 470              		.loc 1 478 34 is_stmt 0 view .LVU147
 471 00a6 074B     		ldr	r3, .L38+4
 472 00a8 0022     		movs	r2, #0
 473 00aa 1A74     		strb	r2, [r3, #16]
 479:Core/Src/bootloader.c **** }
 474              		.loc 1 479 5 is_stmt 1 view .LVU148
 475              	.LVL37:
 476              	.L28:
 480:Core/Src/bootloader.c **** 
 477              		.loc 1 480 1 is_stmt 0 view .LVU149
 478 00ac 4046     		mov	r0, r8
 479 00ae BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 480              	.LVL38:
 481              	.L37:
 474:Core/Src/bootloader.c ****         return ERR_FLASH_WRITE_FAILED;
 482              		.loc 1 474 9 is_stmt 1 view .LVU150
 474:Core/Src/bootloader.c ****         return ERR_FLASH_WRITE_FAILED;
 483              		.loc 1 474 38 is_stmt 0 view .LVU151
 484 00b2 4FF00408 		mov	r8, #4
 485              	.LVL39:
 474:Core/Src/bootloader.c ****         return ERR_FLASH_WRITE_FAILED;
 486              		.loc 1 474 38 view .LVU152
 487 00b6 034B     		ldr	r3, .L38+4
 488 00b8 83F81080 		strb	r8, [r3, #16]
 475:Core/Src/bootloader.c ****     }
 489              		.loc 1 475 9 is_stmt 1 view .LVU153
 475:Core/Src/bootloader.c ****     }
 490              		.loc 1 475 16 is_stmt 0 view .LVU154
 491 00bc F6E7     		b	.L28
 492              	.L39:
 493 00be 00BF     		.align	2
 494              	.L38:
 495 00c0 00200240 		.word	1073881088
 496 00c4 00000000 		.word	bootloader_status
 497              		.cfi_endproc
 498              	.LFE137:
 500              		.section	.text.Bootloader_DeInit,"ax",%progbits
 501              		.align	1
 502              		.syntax unified
 503              		.thumb
 504              		.thumb_func
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 22


 506              	Bootloader_DeInit:
 507              	.LFB140:
 538:Core/Src/bootloader.c ****     /* Disable CAN */
 508              		.loc 1 538 1 is_stmt 1 view -0
 509              		.cfi_startproc
 510              		@ args = 0, pretend = 0, frame = 0
 511              		@ frame_needed = 0, uses_anonymous_args = 0
 512 0000 10B5     		push	{r4, lr}
 513              		.cfi_def_cfa_offset 8
 514              		.cfi_offset 4, -8
 515              		.cfi_offset 14, -4
 540:Core/Src/bootloader.c ****     HAL_CAN_Stop(hcan_bootloader);
 516              		.loc 1 540 5 view .LVU156
 517 0002 0F4C     		ldr	r4, .L42
 518 0004 0221     		movs	r1, #2
 519 0006 2068     		ldr	r0, [r4]
 520 0008 FFF7FEFF 		bl	HAL_CAN_DeactivateNotification
 521              	.LVL40:
 541:Core/Src/bootloader.c ****     HAL_CAN_MspDeInit(hcan_bootloader);
 522              		.loc 1 541 5 view .LVU157
 523 000c 2068     		ldr	r0, [r4]
 524 000e FFF7FEFF 		bl	HAL_CAN_Stop
 525              	.LVL41:
 542:Core/Src/bootloader.c ****     
 526              		.loc 1 542 5 view .LVU158
 527 0012 2068     		ldr	r0, [r4]
 528 0014 FFF7FEFF 		bl	HAL_CAN_MspDeInit
 529              	.LVL42:
 545:Core/Src/bootloader.c ****     SysTick->LOAD = 0;
 530              		.loc 1 545 5 view .LVU159
 545:Core/Src/bootloader.c ****     SysTick->LOAD = 0;
 531              		.loc 1 545 19 is_stmt 0 view .LVU160
 532 0018 4FF0E023 		mov	r3, #-536813568
 533 001c 0022     		movs	r2, #0
 534 001e 1A61     		str	r2, [r3, #16]
 546:Core/Src/bootloader.c ****     SysTick->VAL = 0;
 535              		.loc 1 546 5 is_stmt 1 view .LVU161
 546:Core/Src/bootloader.c ****     SysTick->VAL = 0;
 536              		.loc 1 546 19 is_stmt 0 view .LVU162
 537 0020 5A61     		str	r2, [r3, #20]
 547:Core/Src/bootloader.c ****     
 538              		.loc 1 547 5 is_stmt 1 view .LVU163
 547:Core/Src/bootloader.c ****     
 539              		.loc 1 547 18 is_stmt 0 view .LVU164
 540 0022 9A61     		str	r2, [r3, #24]
 550:Core/Src/bootloader.c ****     
 541              		.loc 1 550 5 is_stmt 1 view .LVU165
 542              	.LBB6:
 543              	.LBI6:
 544              		.file 2 "Drivers/CMSIS/Include/cmsis_gcc.h"
   1:Drivers/CMSIS/Include/cmsis_gcc.h **** /**************************************************************************//**
   2:Drivers/CMSIS/Include/cmsis_gcc.h ****  * @file     cmsis_gcc.h
   3:Drivers/CMSIS/Include/cmsis_gcc.h ****  * @brief    CMSIS compiler GCC header file
   4:Drivers/CMSIS/Include/cmsis_gcc.h ****  * @version  V5.2.0
   5:Drivers/CMSIS/Include/cmsis_gcc.h ****  * @date     08. May 2019
   6:Drivers/CMSIS/Include/cmsis_gcc.h ****  ******************************************************************************/
   7:Drivers/CMSIS/Include/cmsis_gcc.h **** /*
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 23


   8:Drivers/CMSIS/Include/cmsis_gcc.h ****  * Copyright (c) 2009-2019 Arm Limited. All rights reserved.
   9:Drivers/CMSIS/Include/cmsis_gcc.h ****  *
  10:Drivers/CMSIS/Include/cmsis_gcc.h ****  * SPDX-License-Identifier: Apache-2.0
  11:Drivers/CMSIS/Include/cmsis_gcc.h ****  *
  12:Drivers/CMSIS/Include/cmsis_gcc.h ****  * Licensed under the Apache License, Version 2.0 (the License); you may
  13:Drivers/CMSIS/Include/cmsis_gcc.h ****  * not use this file except in compliance with the License.
  14:Drivers/CMSIS/Include/cmsis_gcc.h ****  * You may obtain a copy of the License at
  15:Drivers/CMSIS/Include/cmsis_gcc.h ****  *
  16:Drivers/CMSIS/Include/cmsis_gcc.h ****  * www.apache.org/licenses/LICENSE-2.0
  17:Drivers/CMSIS/Include/cmsis_gcc.h ****  *
  18:Drivers/CMSIS/Include/cmsis_gcc.h ****  * Unless required by applicable law or agreed to in writing, software
  19:Drivers/CMSIS/Include/cmsis_gcc.h ****  * distributed under the License is distributed on an AS IS BASIS, WITHOUT
  20:Drivers/CMSIS/Include/cmsis_gcc.h ****  * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  21:Drivers/CMSIS/Include/cmsis_gcc.h ****  * See the License for the specific language governing permissions and
  22:Drivers/CMSIS/Include/cmsis_gcc.h ****  * limitations under the License.
  23:Drivers/CMSIS/Include/cmsis_gcc.h ****  */
  24:Drivers/CMSIS/Include/cmsis_gcc.h **** 
  25:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef __CMSIS_GCC_H
  26:Drivers/CMSIS/Include/cmsis_gcc.h **** #define __CMSIS_GCC_H
  27:Drivers/CMSIS/Include/cmsis_gcc.h **** 
  28:Drivers/CMSIS/Include/cmsis_gcc.h **** /* ignore some GCC warnings */
  29:Drivers/CMSIS/Include/cmsis_gcc.h **** #pragma GCC diagnostic push
  30:Drivers/CMSIS/Include/cmsis_gcc.h **** #pragma GCC diagnostic ignored "-Wsign-conversion"
  31:Drivers/CMSIS/Include/cmsis_gcc.h **** #pragma GCC diagnostic ignored "-Wconversion"
  32:Drivers/CMSIS/Include/cmsis_gcc.h **** #pragma GCC diagnostic ignored "-Wunused-parameter"
  33:Drivers/CMSIS/Include/cmsis_gcc.h **** 
  34:Drivers/CMSIS/Include/cmsis_gcc.h **** /* Fallback for __has_builtin */
  35:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef __has_builtin
  36:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __has_builtin(x) (0)
  37:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  38:Drivers/CMSIS/Include/cmsis_gcc.h **** 
  39:Drivers/CMSIS/Include/cmsis_gcc.h **** /* CMSIS compiler specific defines */
  40:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __ASM
  41:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __ASM                                  __asm
  42:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  43:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __INLINE
  44:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __INLINE                               inline
  45:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  46:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __STATIC_INLINE
  47:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __STATIC_INLINE                        static inline
  48:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  49:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __STATIC_FORCEINLINE                 
  50:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __STATIC_FORCEINLINE                   __attribute__((always_inline)) static inline
  51:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif                                           
  52:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __NO_RETURN
  53:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __NO_RETURN                            __attribute__((__noreturn__))
  54:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  55:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __USED
  56:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __USED                                 __attribute__((used))
  57:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  58:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __WEAK
  59:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __WEAK                                 __attribute__((weak))
  60:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  61:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __PACKED
  62:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __PACKED                               __attribute__((packed, aligned(1)))
  63:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  64:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __PACKED_STRUCT
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 24


  65:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __PACKED_STRUCT                        struct __attribute__((packed, aligned(1)))
  66:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  67:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __PACKED_UNION
  68:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __PACKED_UNION                         union __attribute__((packed, aligned(1)))
  69:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  70:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __UNALIGNED_UINT32        /* deprecated */
  71:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic push
  72:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic ignored "-Wpacked"
  73:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic ignored "-Wattributes"
  74:Drivers/CMSIS/Include/cmsis_gcc.h ****   struct __attribute__((packed)) T_UINT32 { uint32_t v; };
  75:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic pop
  76:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __UNALIGNED_UINT32(x)                  (((struct T_UINT32 *)(x))->v)
  77:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  78:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __UNALIGNED_UINT16_WRITE
  79:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic push
  80:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic ignored "-Wpacked"
  81:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic ignored "-Wattributes"
  82:Drivers/CMSIS/Include/cmsis_gcc.h ****   __PACKED_STRUCT T_UINT16_WRITE { uint16_t v; };
  83:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic pop
  84:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __UNALIGNED_UINT16_WRITE(addr, val)    (void)((((struct T_UINT16_WRITE *)(void *)(addr))-
  85:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  86:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __UNALIGNED_UINT16_READ
  87:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic push
  88:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic ignored "-Wpacked"
  89:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic ignored "-Wattributes"
  90:Drivers/CMSIS/Include/cmsis_gcc.h ****   __PACKED_STRUCT T_UINT16_READ { uint16_t v; };
  91:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic pop
  92:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __UNALIGNED_UINT16_READ(addr)          (((const struct T_UINT16_READ *)(const void *)(add
  93:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
  94:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __UNALIGNED_UINT32_WRITE
  95:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic push
  96:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic ignored "-Wpacked"
  97:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic ignored "-Wattributes"
  98:Drivers/CMSIS/Include/cmsis_gcc.h ****   __PACKED_STRUCT T_UINT32_WRITE { uint32_t v; };
  99:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic pop
 100:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __UNALIGNED_UINT32_WRITE(addr, val)    (void)((((struct T_UINT32_WRITE *)(void *)(addr))-
 101:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
 102:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __UNALIGNED_UINT32_READ
 103:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic push
 104:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic ignored "-Wpacked"
 105:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic ignored "-Wattributes"
 106:Drivers/CMSIS/Include/cmsis_gcc.h ****   __PACKED_STRUCT T_UINT32_READ { uint32_t v; };
 107:Drivers/CMSIS/Include/cmsis_gcc.h ****   #pragma GCC diagnostic pop
 108:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __UNALIGNED_UINT32_READ(addr)          (((const struct T_UINT32_READ *)(const void *)(add
 109:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
 110:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __ALIGNED
 111:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __ALIGNED(x)                           __attribute__((aligned(x)))
 112:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
 113:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __RESTRICT
 114:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __RESTRICT                             __restrict
 115:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
 116:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef   __COMPILER_BARRIER
 117:Drivers/CMSIS/Include/cmsis_gcc.h ****   #define __COMPILER_BARRIER()                   __ASM volatile("":::"memory")
 118:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
 119:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 120:Drivers/CMSIS/Include/cmsis_gcc.h **** /* #########################  Startup and Lowlevel Init  ######################## */
 121:Drivers/CMSIS/Include/cmsis_gcc.h **** 
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 25


 122:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef __PROGRAM_START
 123:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 124:Drivers/CMSIS/Include/cmsis_gcc.h **** /**
 125:Drivers/CMSIS/Include/cmsis_gcc.h ****   \brief   Initializes data and bss sections
 126:Drivers/CMSIS/Include/cmsis_gcc.h ****   \details This default implementations initialized all data and additional bss
 127:Drivers/CMSIS/Include/cmsis_gcc.h ****            sections relying on .copy.table and .zero.table specified properly
 128:Drivers/CMSIS/Include/cmsis_gcc.h ****            in the used linker script.
 129:Drivers/CMSIS/Include/cmsis_gcc.h ****   
 130:Drivers/CMSIS/Include/cmsis_gcc.h ****  */
 131:Drivers/CMSIS/Include/cmsis_gcc.h **** __STATIC_FORCEINLINE __NO_RETURN void __cmsis_start(void)
 132:Drivers/CMSIS/Include/cmsis_gcc.h **** {
 133:Drivers/CMSIS/Include/cmsis_gcc.h ****   extern void _start(void) __NO_RETURN;
 134:Drivers/CMSIS/Include/cmsis_gcc.h ****   
 135:Drivers/CMSIS/Include/cmsis_gcc.h ****   typedef struct {
 136:Drivers/CMSIS/Include/cmsis_gcc.h ****     uint32_t const* src;
 137:Drivers/CMSIS/Include/cmsis_gcc.h ****     uint32_t* dest;
 138:Drivers/CMSIS/Include/cmsis_gcc.h ****     uint32_t  wlen;
 139:Drivers/CMSIS/Include/cmsis_gcc.h ****   } __copy_table_t;
 140:Drivers/CMSIS/Include/cmsis_gcc.h ****   
 141:Drivers/CMSIS/Include/cmsis_gcc.h ****   typedef struct {
 142:Drivers/CMSIS/Include/cmsis_gcc.h ****     uint32_t* dest;
 143:Drivers/CMSIS/Include/cmsis_gcc.h ****     uint32_t  wlen;
 144:Drivers/CMSIS/Include/cmsis_gcc.h ****   } __zero_table_t;
 145:Drivers/CMSIS/Include/cmsis_gcc.h ****   
 146:Drivers/CMSIS/Include/cmsis_gcc.h ****   extern const __copy_table_t __copy_table_start__;
 147:Drivers/CMSIS/Include/cmsis_gcc.h ****   extern const __copy_table_t __copy_table_end__;
 148:Drivers/CMSIS/Include/cmsis_gcc.h ****   extern const __zero_table_t __zero_table_start__;
 149:Drivers/CMSIS/Include/cmsis_gcc.h ****   extern const __zero_table_t __zero_table_end__;
 150:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 151:Drivers/CMSIS/Include/cmsis_gcc.h ****   for (__copy_table_t const* pTable = &__copy_table_start__; pTable < &__copy_table_end__; ++pTable
 152:Drivers/CMSIS/Include/cmsis_gcc.h ****     for(uint32_t i=0u; i<pTable->wlen; ++i) {
 153:Drivers/CMSIS/Include/cmsis_gcc.h ****       pTable->dest[i] = pTable->src[i];
 154:Drivers/CMSIS/Include/cmsis_gcc.h ****     }
 155:Drivers/CMSIS/Include/cmsis_gcc.h ****   }
 156:Drivers/CMSIS/Include/cmsis_gcc.h ****  
 157:Drivers/CMSIS/Include/cmsis_gcc.h ****   for (__zero_table_t const* pTable = &__zero_table_start__; pTable < &__zero_table_end__; ++pTable
 158:Drivers/CMSIS/Include/cmsis_gcc.h ****     for(uint32_t i=0u; i<pTable->wlen; ++i) {
 159:Drivers/CMSIS/Include/cmsis_gcc.h ****       pTable->dest[i] = 0u;
 160:Drivers/CMSIS/Include/cmsis_gcc.h ****     }
 161:Drivers/CMSIS/Include/cmsis_gcc.h ****   }
 162:Drivers/CMSIS/Include/cmsis_gcc.h ****  
 163:Drivers/CMSIS/Include/cmsis_gcc.h ****   _start();
 164:Drivers/CMSIS/Include/cmsis_gcc.h **** }
 165:Drivers/CMSIS/Include/cmsis_gcc.h ****   
 166:Drivers/CMSIS/Include/cmsis_gcc.h **** #define __PROGRAM_START           __cmsis_start
 167:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
 168:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 169:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef __INITIAL_SP
 170:Drivers/CMSIS/Include/cmsis_gcc.h **** #define __INITIAL_SP              __StackTop
 171:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
 172:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 173:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef __STACK_LIMIT
 174:Drivers/CMSIS/Include/cmsis_gcc.h **** #define __STACK_LIMIT             __StackLimit
 175:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
 176:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 177:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef __VECTOR_TABLE
 178:Drivers/CMSIS/Include/cmsis_gcc.h **** #define __VECTOR_TABLE            __Vectors
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 26


 179:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
 180:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 181:Drivers/CMSIS/Include/cmsis_gcc.h **** #ifndef __VECTOR_TABLE_ATTRIBUTE
 182:Drivers/CMSIS/Include/cmsis_gcc.h **** #define __VECTOR_TABLE_ATTRIBUTE  __attribute((used, section(".vectors")))
 183:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
 184:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 185:Drivers/CMSIS/Include/cmsis_gcc.h **** /* ###########################  Core Function Access  ########################### */
 186:Drivers/CMSIS/Include/cmsis_gcc.h **** /** \ingroup  CMSIS_Core_FunctionInterface
 187:Drivers/CMSIS/Include/cmsis_gcc.h ****     \defgroup CMSIS_Core_RegAccFunctions CMSIS Core Register Access Functions
 188:Drivers/CMSIS/Include/cmsis_gcc.h ****   @{
 189:Drivers/CMSIS/Include/cmsis_gcc.h ****  */
 190:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 191:Drivers/CMSIS/Include/cmsis_gcc.h **** /**
 192:Drivers/CMSIS/Include/cmsis_gcc.h ****   \brief   Enable IRQ Interrupts
 193:Drivers/CMSIS/Include/cmsis_gcc.h ****   \details Enables IRQ interrupts by clearing the I-bit in the CPSR.
 194:Drivers/CMSIS/Include/cmsis_gcc.h ****            Can only be executed in Privileged modes.
 195:Drivers/CMSIS/Include/cmsis_gcc.h ****  */
 196:Drivers/CMSIS/Include/cmsis_gcc.h **** __STATIC_FORCEINLINE void __enable_irq(void)
 197:Drivers/CMSIS/Include/cmsis_gcc.h **** {
 198:Drivers/CMSIS/Include/cmsis_gcc.h ****   __ASM volatile ("cpsie i" : : : "memory");
 199:Drivers/CMSIS/Include/cmsis_gcc.h **** }
 200:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 201:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 202:Drivers/CMSIS/Include/cmsis_gcc.h **** /**
 203:Drivers/CMSIS/Include/cmsis_gcc.h ****   \brief   Disable IRQ Interrupts
 204:Drivers/CMSIS/Include/cmsis_gcc.h ****   \details Disables IRQ interrupts by setting the I-bit in the CPSR.
 205:Drivers/CMSIS/Include/cmsis_gcc.h ****            Can only be executed in Privileged modes.
 206:Drivers/CMSIS/Include/cmsis_gcc.h ****  */
 207:Drivers/CMSIS/Include/cmsis_gcc.h **** __STATIC_FORCEINLINE void __disable_irq(void)
 545              		.loc 2 207 27 view .LVU166
 546              	.LBB7:
 208:Drivers/CMSIS/Include/cmsis_gcc.h **** {
 209:Drivers/CMSIS/Include/cmsis_gcc.h ****   __ASM volatile ("cpsid i" : : : "memory");
 547              		.loc 2 209 3 view .LVU167
 548              		.syntax unified
 549              	@ 209 "Drivers/CMSIS/Include/cmsis_gcc.h" 1
 550 0024 72B6     		cpsid i
 551              	@ 0 "" 2
 552              		.thumb
 553              		.syntax unified
 554              	.LBE7:
 555              	.LBE6:
 553:Core/Src/bootloader.c ****     __HAL_RCC_CAN1_CLK_DISABLE();
 556              		.loc 1 553 5 view .LVU168
 557 0026 03F1C043 		add	r3, r3, #1610612736
 558 002a 03F59833 		add	r3, r3, #77824
 559 002e DA6C     		ldr	r2, [r3, #76]
 560 0030 22F00102 		bic	r2, r2, #1
 561 0034 DA64     		str	r2, [r3, #76]
 554:Core/Src/bootloader.c **** }
 562              		.loc 1 554 5 view .LVU169
 563 0036 9A6D     		ldr	r2, [r3, #88]
 564 0038 22F00072 		bic	r2, r2, #33554432
 565 003c 9A65     		str	r2, [r3, #88]
 555:Core/Src/bootloader.c **** 
 566              		.loc 1 555 1 is_stmt 0 view .LVU170
 567 003e 10BD     		pop	{r4, pc}
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 27


 568              	.L43:
 569              		.align	2
 570              	.L42:
 571 0040 00000000 		.word	hcan_bootloader
 572              		.cfi_endproc
 573              	.LFE140:
 575              		.section	.text.Bootloader_Init,"ax",%progbits
 576              		.align	1
 577              		.global	Bootloader_Init
 578              		.syntax unified
 579              		.thumb
 580              		.thumb_func
 582              	Bootloader_Init:
 583              	.LVL43:
 584              	.LFB132:
  49:Core/Src/bootloader.c ****     hcan_bootloader = hcan;
 585              		.loc 1 49 1 is_stmt 1 view -0
 586              		.cfi_startproc
 587              		@ args = 0, pretend = 0, frame = 0
 588              		@ frame_needed = 0, uses_anonymous_args = 0
  49:Core/Src/bootloader.c ****     hcan_bootloader = hcan;
 589              		.loc 1 49 1 is_stmt 0 view .LVU172
 590 0000 10B5     		push	{r4, lr}
 591              		.cfi_def_cfa_offset 8
 592              		.cfi_offset 4, -8
 593              		.cfi_offset 14, -4
  50:Core/Src/bootloader.c ****     
 594              		.loc 1 50 5 is_stmt 1 view .LVU173
  50:Core/Src/bootloader.c ****     
 595              		.loc 1 50 21 is_stmt 0 view .LVU174
 596 0002 144C     		ldr	r4, .L50
 597 0004 2060     		str	r0, [r4]
  53:Core/Src/bootloader.c ****     bootloader_status.state = BL_STATE_IDLE;
 598              		.loc 1 53 5 is_stmt 1 view .LVU175
 599 0006 144B     		ldr	r3, .L50+4
 600 0008 0022     		movs	r2, #0
 601 000a 1A60     		str	r2, [r3]
 602 000c 5A60     		str	r2, [r3, #4]
 603 000e 9A60     		str	r2, [r3, #8]
 604 0010 DA60     		str	r2, [r3, #12]
 605 0012 1A61     		str	r2, [r3, #16]
  54:Core/Src/bootloader.c ****     bootloader_status.current_address = APPLICATION_ADDRESS;
 606              		.loc 1 54 5 view .LVU176
  55:Core/Src/bootloader.c ****     
 607              		.loc 1 55 5 view .LVU177
  55:Core/Src/bootloader.c ****     
 608              		.loc 1 55 39 is_stmt 0 view .LVU178
 609 0014 114A     		ldr	r2, .L50+8
 610 0016 5A60     		str	r2, [r3, #4]
  58:Core/Src/bootloader.c ****     
 611              		.loc 1 58 5 is_stmt 1 view .LVU179
 612 0018 FFF7FEFF 		bl	Bootloader_ConfigureCANFilter
 613              	.LVL44:
  61:Core/Src/bootloader.c ****     {
 614              		.loc 1 61 5 view .LVU180
  61:Core/Src/bootloader.c ****     {
 615              		.loc 1 61 9 is_stmt 0 view .LVU181
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 28


 616 001c 2068     		ldr	r0, [r4]
 617 001e FFF7FEFF 		bl	HAL_CAN_Start
 618              	.LVL45:
  61:Core/Src/bootloader.c ****     {
 619              		.loc 1 61 8 discriminator 1 view .LVU182
 620 0022 88B9     		cbnz	r0, .L48
 621              	.L45:
  67:Core/Src/bootloader.c ****     {
 622              		.loc 1 67 5 is_stmt 1 view .LVU183
  67:Core/Src/bootloader.c ****     {
 623              		.loc 1 67 9 is_stmt 0 view .LVU184
 624 0024 0221     		movs	r1, #2
 625 0026 0B4B     		ldr	r3, .L50
 626 0028 1868     		ldr	r0, [r3]
 627 002a FFF7FEFF 		bl	HAL_CAN_ActivateNotification
 628              	.LVL46:
  67:Core/Src/bootloader.c ****     {
 629              		.loc 1 67 8 discriminator 1 view .LVU185
 630 002e 70B9     		cbnz	r0, .L49
 631              	.L46:
  73:Core/Src/bootloader.c ****     tx_header.ExtId = CAN_BOOTLOADER_ID;
 632              		.loc 1 73 5 is_stmt 1 view .LVU186
  73:Core/Src/bootloader.c ****     tx_header.ExtId = CAN_BOOTLOADER_ID;
 633              		.loc 1 73 21 is_stmt 0 view .LVU187
 634 0030 0B4B     		ldr	r3, .L50+12
 635 0032 0022     		movs	r2, #0
 636 0034 1A60     		str	r2, [r3]
  74:Core/Src/bootloader.c ****     tx_header.IDE = CAN_ID_EXT;
 637              		.loc 1 74 5 is_stmt 1 view .LVU188
  74:Core/Src/bootloader.c ****     tx_header.IDE = CAN_ID_EXT;
 638              		.loc 1 74 21 is_stmt 0 view .LVU189
 639 0036 0B49     		ldr	r1, .L50+16
 640 0038 5960     		str	r1, [r3, #4]
  75:Core/Src/bootloader.c ****     tx_header.RTR = CAN_RTR_DATA;
 641              		.loc 1 75 5 is_stmt 1 view .LVU190
  75:Core/Src/bootloader.c ****     tx_header.RTR = CAN_RTR_DATA;
 642              		.loc 1 75 19 is_stmt 0 view .LVU191
 643 003a 0421     		movs	r1, #4
 644 003c 9960     		str	r1, [r3, #8]
  76:Core/Src/bootloader.c ****     tx_header.DLC = 8;
 645              		.loc 1 76 5 is_stmt 1 view .LVU192
  76:Core/Src/bootloader.c ****     tx_header.DLC = 8;
 646              		.loc 1 76 19 is_stmt 0 view .LVU193
 647 003e DA60     		str	r2, [r3, #12]
  77:Core/Src/bootloader.c ****     tx_header.TransmitGlobalTime = DISABLE;
 648              		.loc 1 77 5 is_stmt 1 view .LVU194
  77:Core/Src/bootloader.c ****     tx_header.TransmitGlobalTime = DISABLE;
 649              		.loc 1 77 19 is_stmt 0 view .LVU195
 650 0040 0821     		movs	r1, #8
 651 0042 1961     		str	r1, [r3, #16]
  78:Core/Src/bootloader.c **** }
 652              		.loc 1 78 5 is_stmt 1 view .LVU196
  78:Core/Src/bootloader.c **** }
 653              		.loc 1 78 34 is_stmt 0 view .LVU197
 654 0044 1A75     		strb	r2, [r3, #20]
  79:Core/Src/bootloader.c **** 
 655              		.loc 1 79 1 view .LVU198
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 29


 656 0046 10BD     		pop	{r4, pc}
 657              	.L48:
  63:Core/Src/bootloader.c ****     }
 658              		.loc 1 63 9 is_stmt 1 view .LVU199
 659 0048 FFF7FEFF 		bl	Error_Handler
 660              	.LVL47:
 661 004c EAE7     		b	.L45
 662              	.L49:
  69:Core/Src/bootloader.c ****     }
 663              		.loc 1 69 9 view .LVU200
 664 004e FFF7FEFF 		bl	Error_Handler
 665              	.LVL48:
 666 0052 EDE7     		b	.L46
 667              	.L51:
 668              		.align	2
 669              	.L50:
 670 0054 00000000 		.word	hcan_bootloader
 671 0058 00000000 		.word	bootloader_status
 672 005c 00800008 		.word	134250496
 673 0060 00000000 		.word	tx_header
 674 0064 00070018 		.word	402654976
 675              		.cfi_endproc
 676              	.LFE132:
 678              		.section	.text.Bootloader_CheckValidApplication,"ax",%progbits
 679              		.align	1
 680              		.global	Bootloader_CheckValidApplication
 681              		.syntax unified
 682              		.thumb
 683              		.thumb_func
 685              	Bootloader_CheckValidApplication:
 686              	.LFB139:
 514:Core/Src/bootloader.c ****     uint32_t stack_pointer = *(__IO uint32_t *)APPLICATION_ADDRESS;
 687              		.loc 1 514 1 view -0
 688              		.cfi_startproc
 689              		@ args = 0, pretend = 0, frame = 0
 690              		@ frame_needed = 0, uses_anonymous_args = 0
 691              		@ link register save eliminated.
 515:Core/Src/bootloader.c ****     uint32_t reset_handler = *(__IO uint32_t *)(APPLICATION_ADDRESS + 4);
 692              		.loc 1 515 5 view .LVU202
 515:Core/Src/bootloader.c ****     uint32_t reset_handler = *(__IO uint32_t *)(APPLICATION_ADDRESS + 4);
 693              		.loc 1 515 14 is_stmt 0 view .LVU203
 694 0000 094A     		ldr	r2, .L56
 695 0002 1368     		ldr	r3, [r2]
 696              	.LVL49:
 516:Core/Src/bootloader.c ****     
 697              		.loc 1 516 5 is_stmt 1 view .LVU204
 516:Core/Src/bootloader.c ****     
 698              		.loc 1 516 14 is_stmt 0 view .LVU205
 699 0004 5268     		ldr	r2, [r2, #4]
 700              	.LVL50:
 519:Core/Src/bootloader.c ****     {
 701              		.loc 1 519 5 is_stmt 1 view .LVU206
 519:Core/Src/bootloader.c ****     {
 702              		.loc 1 519 24 is_stmt 0 view .LVU207
 703 0006 6FF31303 		bfc	r3, #0, #20
 704              	.LVL51:
 519:Core/Src/bootloader.c ****     {
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 30


 705              		.loc 1 519 8 view .LVU208
 706 000a B3F1005F 		cmp	r3, #536870912
 707 000e 06D1     		bne	.L54
 525:Core/Src/bootloader.c ****     {
 708              		.loc 1 525 5 is_stmt 1 view .LVU209
 525:Core/Src/bootloader.c ****     {
 709              		.loc 1 525 52 is_stmt 0 view .LVU210
 710 0010 6FF35702 		bfc	r2, #1, #23
 711              	.LVL52:
 525:Core/Src/bootloader.c ****     {
 712              		.loc 1 525 8 view .LVU211
 713 0014 054B     		ldr	r3, .L56+4
 714 0016 9A42     		cmp	r2, r3
 715 0018 03D1     		bne	.L55
 530:Core/Src/bootloader.c **** }
 716              		.loc 1 530 12 view .LVU212
 717 001a 0120     		movs	r0, #1
 718 001c 7047     		bx	lr
 719              	.LVL53:
 720              	.L54:
 521:Core/Src/bootloader.c ****     }
 721              		.loc 1 521 16 view .LVU213
 722 001e 0020     		movs	r0, #0
 723 0020 7047     		bx	lr
 724              	.LVL54:
 725              	.L55:
 527:Core/Src/bootloader.c ****     }
 726              		.loc 1 527 16 view .LVU214
 727 0022 0020     		movs	r0, #0
 531:Core/Src/bootloader.c **** 
 728              		.loc 1 531 1 view .LVU215
 729 0024 7047     		bx	lr
 730              	.L57:
 731 0026 00BF     		.align	2
 732              	.L56:
 733 0028 00800008 		.word	134250496
 734 002c 01000008 		.word	134217729
 735              		.cfi_endproc
 736              	.LFE139:
 738              		.section	.text.Bootloader_SendCANMessage,"ax",%progbits
 739              		.align	1
 740              		.global	Bootloader_SendCANMessage
 741              		.syntax unified
 742              		.thumb
 743              		.thumb_func
 745              	Bootloader_SendCANMessage:
 746              	.LVL55:
 747              	.LFB145:
 574:Core/Src/bootloader.c **** 
 575:Core/Src/bootloader.c **** /**
 576:Core/Src/bootloader.c ****   * @brief  Jump to application
 577:Core/Src/bootloader.c ****   * @retval Error code (if returns, jump failed)
 578:Core/Src/bootloader.c ****   */
 579:Core/Src/bootloader.c **** uint8_t Bootloader_JumpToApplication(void)
 580:Core/Src/bootloader.c **** {
 581:Core/Src/bootloader.c ****     typedef void (*pFunction)(void);
 582:Core/Src/bootloader.c ****     pFunction jump_to_application;
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 31


 583:Core/Src/bootloader.c ****     uint32_t jump_address;
 584:Core/Src/bootloader.c ****     uint32_t app_stack_pointer;
 585:Core/Src/bootloader.c ****     uint8_t jump_info[8];
 586:Core/Src/bootloader.c ****     
 587:Core/Src/bootloader.c ****     /* Check if valid application exists */
 588:Core/Src/bootloader.c ****     if (!Bootloader_CheckValidApplication())
 589:Core/Src/bootloader.c ****     {
 590:Core/Src/bootloader.c ****         return ERR_NO_VALID_APP;
 591:Core/Src/bootloader.c ****     }
 592:Core/Src/bootloader.c ****     
 593:Core/Src/bootloader.c ****     /* Read application vector table */
 594:Core/Src/bootloader.c ****     app_stack_pointer = *(__IO uint32_t *)APPLICATION_ADDRESS;
 595:Core/Src/bootloader.c ****     jump_address = *(__IO uint32_t *)(APPLICATION_ADDRESS + 4);
 596:Core/Src/bootloader.c ****     
 597:Core/Src/bootloader.c ****     /* Send detailed jump information before jumping */
 598:Core/Src/bootloader.c ****     jump_info[0] = RESP_JUMP_INFO;
 599:Core/Src/bootloader.c ****     jump_info[1] = (app_stack_pointer >> 24) & 0xFF;  /* Stack pointer MSB */
 600:Core/Src/bootloader.c ****     jump_info[2] = (app_stack_pointer >> 16) & 0xFF;
 601:Core/Src/bootloader.c ****     jump_info[3] = (app_stack_pointer >> 8) & 0xFF;
 602:Core/Src/bootloader.c ****     jump_info[4] = app_stack_pointer & 0xFF;          /* Stack pointer LSB */
 603:Core/Src/bootloader.c ****     jump_info[5] = (jump_address >> 16) & 0xFF;       /* Reset vector high word */
 604:Core/Src/bootloader.c ****     jump_info[6] = (jump_address >> 8) & 0xFF;
 605:Core/Src/bootloader.c ****     jump_info[7] = jump_address & 0xFF;               /* Reset vector LSB */
 606:Core/Src/bootloader.c ****     
 607:Core/Src/bootloader.c ****     Bootloader_SendCANMessage(RESP_JUMP_INFO, jump_info, 8);
 608:Core/Src/bootloader.c ****     
 609:Core/Src/bootloader.c ****     /* Wait for CAN transmission to complete */
 610:Core/Src/bootloader.c ****     Bootloader_WaitForCANTransmission();
 611:Core/Src/bootloader.c ****     
 612:Core/Src/bootloader.c ****     bootloader_status.state = BL_STATE_JUMPING;
 613:Core/Src/bootloader.c ****     
 614:Core/Src/bootloader.c ****     /* De-initialize peripherals */
 615:Core/Src/bootloader.c ****     Bootloader_DeInit();
 616:Core/Src/bootloader.c ****     
 617:Core/Src/bootloader.c ****     /* Get the application stack pointer */
 618:Core/Src/bootloader.c ****     __set_MSP(app_stack_pointer);
 619:Core/Src/bootloader.c ****     
 620:Core/Src/bootloader.c ****     /* Cast to function pointer */
 621:Core/Src/bootloader.c ****     jump_to_application = (pFunction)jump_address;
 622:Core/Src/bootloader.c ****     
 623:Core/Src/bootloader.c ****     /* Relocate vector table */
 624:Core/Src/bootloader.c ****     SCB->VTOR = APPLICATION_ADDRESS;
 625:Core/Src/bootloader.c ****     
 626:Core/Src/bootloader.c ****     /* Jump to application */
 627:Core/Src/bootloader.c ****     jump_to_application();
 628:Core/Src/bootloader.c ****     
 629:Core/Src/bootloader.c ****     /* Should never reach here */
 630:Core/Src/bootloader.c ****     return ERR_NONE;
 631:Core/Src/bootloader.c **** }
 632:Core/Src/bootloader.c **** 
 633:Core/Src/bootloader.c **** /**
 634:Core/Src/bootloader.c ****   * @brief  Send ACK message
 635:Core/Src/bootloader.c ****   * @retval None
 636:Core/Src/bootloader.c ****   */
 637:Core/Src/bootloader.c **** static void Bootloader_SendACK(void)
 638:Core/Src/bootloader.c **** {
 639:Core/Src/bootloader.c ****     tx_data[0] = RESP_ACK;
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 32


 640:Core/Src/bootloader.c ****     tx_data[1] = bootloader_status.last_error;
 641:Core/Src/bootloader.c ****     Bootloader_SendCANMessage(RESP_ACK, tx_data, 2);
 642:Core/Src/bootloader.c **** }
 643:Core/Src/bootloader.c **** 
 644:Core/Src/bootloader.c **** /**
 645:Core/Src/bootloader.c ****   * @brief  Send NACK message
 646:Core/Src/bootloader.c ****   * @param  error_code: Error code to send
 647:Core/Src/bootloader.c ****   * @retval None
 648:Core/Src/bootloader.c ****   */
 649:Core/Src/bootloader.c **** static void Bootloader_SendNACK(uint8_t error_code)
 650:Core/Src/bootloader.c **** {
 651:Core/Src/bootloader.c ****     bootloader_status.last_error = error_code;
 652:Core/Src/bootloader.c ****     tx_data[0] = RESP_NACK;
 653:Core/Src/bootloader.c ****     tx_data[1] = error_code;
 654:Core/Src/bootloader.c ****     Bootloader_SendCANMessage(RESP_NACK, tx_data, 2);
 655:Core/Src/bootloader.c **** }
 656:Core/Src/bootloader.c **** 
 657:Core/Src/bootloader.c **** /**
 658:Core/Src/bootloader.c ****   * @brief  Send CAN message
 659:Core/Src/bootloader.c ****   * @param  cmd: Command/response byte
 660:Core/Src/bootloader.c ****   * @param  data: Pointer to data buffer
 661:Core/Src/bootloader.c ****   * @param  length: Data length
 662:Core/Src/bootloader.c ****   * @retval None
 663:Core/Src/bootloader.c ****   */
 664:Core/Src/bootloader.c **** void Bootloader_SendCANMessage(uint8_t cmd, uint8_t *data, uint8_t length)
 665:Core/Src/bootloader.c **** {
 748              		.loc 1 665 1 is_stmt 1 view -0
 749              		.cfi_startproc
 750              		@ args = 0, pretend = 0, frame = 8
 751              		@ frame_needed = 0, uses_anonymous_args = 0
 752              		.loc 1 665 1 is_stmt 0 view .LVU217
 753 0000 00B5     		push	{lr}
 754              		.cfi_def_cfa_offset 4
 755              		.cfi_offset 14, -4
 756 0002 83B0     		sub	sp, sp, #12
 757              		.cfi_def_cfa_offset 16
 666:Core/Src/bootloader.c ****     uint8_t i;
 758              		.loc 1 666 5 is_stmt 1 view .LVU218
 667:Core/Src/bootloader.c ****     uint8_t tx_buffer[8] = {0};
 759              		.loc 1 667 5 view .LVU219
 760              		.loc 1 667 13 is_stmt 0 view .LVU220
 761 0004 0023     		movs	r3, #0
 762 0006 0093     		str	r3, [sp]
 763 0008 0193     		str	r3, [sp, #4]
 668:Core/Src/bootloader.c ****     
 669:Core/Src/bootloader.c ****     /* Copy data to TX buffer */
 670:Core/Src/bootloader.c ****     for (i = 0; i < length && i < 8; i++)
 764              		.loc 1 670 5 is_stmt 1 view .LVU221
 765              	.LVL56:
 766              		.loc 1 670 5 is_stmt 0 view .LVU222
 767 000a 08E0     		b	.L59
 768              	.LVL57:
 769              	.L61:
 671:Core/Src/bootloader.c ****     {
 672:Core/Src/bootloader.c ****         tx_buffer[i] = data[i];
 770              		.loc 1 672 9 is_stmt 1 view .LVU223
 771              		.loc 1 672 28 is_stmt 0 view .LVU224
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 33


 772 000c 11F803C0 		ldrb	ip, [r1, r3]	@ zero_extendqisi2
 773              		.loc 1 672 22 view .LVU225
 774 0010 03F10800 		add	r0, r3, #8
 775 0014 6844     		add	r0, sp, r0
 776 0016 00F808CC 		strb	ip, [r0, #-8]
 670:Core/Src/bootloader.c ****     {
 777              		.loc 1 670 39 is_stmt 1 discriminator 4 view .LVU226
 778 001a 0133     		adds	r3, r3, #1
 779              	.LVL58:
 670:Core/Src/bootloader.c ****     {
 780              		.loc 1 670 39 is_stmt 0 discriminator 4 view .LVU227
 781 001c DBB2     		uxtb	r3, r3
 782              	.LVL59:
 783              	.L59:
 670:Core/Src/bootloader.c ****     {
 784              		.loc 1 670 28 is_stmt 1 discriminator 1 view .LVU228
 785 001e 9342     		cmp	r3, r2
 786 0020 01D2     		bcs	.L60
 670:Core/Src/bootloader.c ****     {
 787              		.loc 1 670 28 is_stmt 0 discriminator 3 view .LVU229
 788 0022 072B     		cmp	r3, #7
 789 0024 F2D9     		bls	.L61
 790              	.L60:
 673:Core/Src/bootloader.c ****     }
 674:Core/Src/bootloader.c ****     
 675:Core/Src/bootloader.c ****     /* Set DLC */
 676:Core/Src/bootloader.c ****     tx_header.DLC = length;
 791              		.loc 1 676 5 is_stmt 1 view .LVU230
 792              		.loc 1 676 19 is_stmt 0 view .LVU231
 793 0026 0549     		ldr	r1, .L63
 794              	.LVL60:
 795              		.loc 1 676 19 view .LVU232
 796 0028 0A61     		str	r2, [r1, #16]
 677:Core/Src/bootloader.c ****     
 678:Core/Src/bootloader.c ****     /* Send message */
 679:Core/Src/bootloader.c ****     HAL_CAN_AddTxMessage(hcan_bootloader, &tx_header, tx_buffer, &tx_mailbox);
 797              		.loc 1 679 5 is_stmt 1 view .LVU233
 798 002a 054B     		ldr	r3, .L63+4
 799              	.LVL61:
 800              		.loc 1 679 5 is_stmt 0 view .LVU234
 801 002c 6A46     		mov	r2, sp
 802              	.LVL62:
 803              		.loc 1 679 5 view .LVU235
 804 002e 0548     		ldr	r0, .L63+8
 805 0030 0068     		ldr	r0, [r0]
 806 0032 FFF7FEFF 		bl	HAL_CAN_AddTxMessage
 807              	.LVL63:
 680:Core/Src/bootloader.c **** }
 808              		.loc 1 680 1 view .LVU236
 809 0036 03B0     		add	sp, sp, #12
 810              		.cfi_def_cfa_offset 4
 811              		@ sp needed
 812 0038 5DF804FB 		ldr	pc, [sp], #4
 813              	.L64:
 814              		.align	2
 815              	.L63:
 816 003c 00000000 		.word	tx_header
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 34


 817 0040 00000000 		.word	tx_mailbox
 818 0044 00000000 		.word	hcan_bootloader
 819              		.cfi_endproc
 820              	.LFE145:
 822              		.section	.text.Bootloader_SendACK,"ax",%progbits
 823              		.align	1
 824              		.syntax unified
 825              		.thumb
 826              		.thumb_func
 828              	Bootloader_SendACK:
 829              	.LFB143:
 638:Core/Src/bootloader.c ****     tx_data[0] = RESP_ACK;
 830              		.loc 1 638 1 is_stmt 1 view -0
 831              		.cfi_startproc
 832              		@ args = 0, pretend = 0, frame = 0
 833              		@ frame_needed = 0, uses_anonymous_args = 0
 834 0000 08B5     		push	{r3, lr}
 835              		.cfi_def_cfa_offset 8
 836              		.cfi_offset 3, -8
 837              		.cfi_offset 14, -4
 639:Core/Src/bootloader.c ****     tx_data[1] = bootloader_status.last_error;
 838              		.loc 1 639 5 view .LVU238
 639:Core/Src/bootloader.c ****     tx_data[1] = bootloader_status.last_error;
 839              		.loc 1 639 16 is_stmt 0 view .LVU239
 840 0002 0549     		ldr	r1, .L67
 841 0004 1020     		movs	r0, #16
 842 0006 0870     		strb	r0, [r1]
 640:Core/Src/bootloader.c ****     Bootloader_SendCANMessage(RESP_ACK, tx_data, 2);
 843              		.loc 1 640 5 is_stmt 1 view .LVU240
 640:Core/Src/bootloader.c ****     Bootloader_SendCANMessage(RESP_ACK, tx_data, 2);
 844              		.loc 1 640 35 is_stmt 0 view .LVU241
 845 0008 044B     		ldr	r3, .L67+4
 846 000a 1B7C     		ldrb	r3, [r3, #16]	@ zero_extendqisi2
 640:Core/Src/bootloader.c ****     Bootloader_SendCANMessage(RESP_ACK, tx_data, 2);
 847              		.loc 1 640 16 view .LVU242
 848 000c 4B70     		strb	r3, [r1, #1]
 641:Core/Src/bootloader.c **** }
 849              		.loc 1 641 5 is_stmt 1 view .LVU243
 850 000e 0222     		movs	r2, #2
 851 0010 FFF7FEFF 		bl	Bootloader_SendCANMessage
 852              	.LVL64:
 642:Core/Src/bootloader.c **** 
 853              		.loc 1 642 1 is_stmt 0 view .LVU244
 854 0014 08BD     		pop	{r3, pc}
 855              	.L68:
 856 0016 00BF     		.align	2
 857              	.L67:
 858 0018 00000000 		.word	tx_data
 859 001c 00000000 		.word	bootloader_status
 860              		.cfi_endproc
 861              	.LFE143:
 863              		.section	.text.Bootloader_SendNACK,"ax",%progbits
 864              		.align	1
 865              		.syntax unified
 866              		.thumb
 867              		.thumb_func
 869              	Bootloader_SendNACK:
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 35


 870              	.LVL65:
 871              	.LFB144:
 650:Core/Src/bootloader.c ****     bootloader_status.last_error = error_code;
 872              		.loc 1 650 1 is_stmt 1 view -0
 873              		.cfi_startproc
 874              		@ args = 0, pretend = 0, frame = 0
 875              		@ frame_needed = 0, uses_anonymous_args = 0
 650:Core/Src/bootloader.c ****     bootloader_status.last_error = error_code;
 876              		.loc 1 650 1 is_stmt 0 view .LVU246
 877 0000 08B5     		push	{r3, lr}
 878              		.cfi_def_cfa_offset 8
 879              		.cfi_offset 3, -8
 880              		.cfi_offset 14, -4
 881 0002 0346     		mov	r3, r0
 651:Core/Src/bootloader.c ****     tx_data[0] = RESP_NACK;
 882              		.loc 1 651 5 is_stmt 1 view .LVU247
 651:Core/Src/bootloader.c ****     tx_data[0] = RESP_NACK;
 883              		.loc 1 651 34 is_stmt 0 view .LVU248
 884 0004 044A     		ldr	r2, .L71
 885 0006 1074     		strb	r0, [r2, #16]
 652:Core/Src/bootloader.c ****     tx_data[1] = error_code;
 886              		.loc 1 652 5 is_stmt 1 view .LVU249
 652:Core/Src/bootloader.c ****     tx_data[1] = error_code;
 887              		.loc 1 652 16 is_stmt 0 view .LVU250
 888 0008 0449     		ldr	r1, .L71+4
 889 000a 1120     		movs	r0, #17
 890              	.LVL66:
 652:Core/Src/bootloader.c ****     tx_data[1] = error_code;
 891              		.loc 1 652 16 view .LVU251
 892 000c 0870     		strb	r0, [r1]
 653:Core/Src/bootloader.c ****     Bootloader_SendCANMessage(RESP_NACK, tx_data, 2);
 893              		.loc 1 653 5 is_stmt 1 view .LVU252
 653:Core/Src/bootloader.c ****     Bootloader_SendCANMessage(RESP_NACK, tx_data, 2);
 894              		.loc 1 653 16 is_stmt 0 view .LVU253
 895 000e 4B70     		strb	r3, [r1, #1]
 654:Core/Src/bootloader.c **** }
 896              		.loc 1 654 5 is_stmt 1 view .LVU254
 897 0010 0222     		movs	r2, #2
 654:Core/Src/bootloader.c **** }
 898              		.loc 1 654 5 is_stmt 0 view .LVU255
 899 0012 FFF7FEFF 		bl	Bootloader_SendCANMessage
 900              	.LVL67:
 655:Core/Src/bootloader.c **** 
 901              		.loc 1 655 1 view .LVU256
 902 0016 08BD     		pop	{r3, pc}
 903              	.L72:
 904              		.align	2
 905              	.L71:
 906 0018 00000000 		.word	bootloader_status
 907 001c 00000000 		.word	tx_data
 908              		.cfi_endproc
 909              	.LFE144:
 911              		.section	.text.Bootloader_JumpToApplication,"ax",%progbits
 912              		.align	1
 913              		.global	Bootloader_JumpToApplication
 914              		.syntax unified
 915              		.thumb
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 36


 916              		.thumb_func
 918              	Bootloader_JumpToApplication:
 919              	.LFB142:
 580:Core/Src/bootloader.c ****     typedef void (*pFunction)(void);
 920              		.loc 1 580 1 is_stmt 1 view -0
 921              		.cfi_startproc
 922              		@ args = 0, pretend = 0, frame = 8
 923              		@ frame_needed = 0, uses_anonymous_args = 0
 924 0000 70B5     		push	{r4, r5, r6, lr}
 925              		.cfi_def_cfa_offset 16
 926              		.cfi_offset 4, -16
 927              		.cfi_offset 5, -12
 928              		.cfi_offset 6, -8
 929              		.cfi_offset 14, -4
 930 0002 82B0     		sub	sp, sp, #8
 931              		.cfi_def_cfa_offset 24
 581:Core/Src/bootloader.c ****     pFunction jump_to_application;
 932              		.loc 1 581 5 view .LVU258
 582:Core/Src/bootloader.c ****     uint32_t jump_address;
 933              		.loc 1 582 5 view .LVU259
 583:Core/Src/bootloader.c ****     uint32_t app_stack_pointer;
 934              		.loc 1 583 5 view .LVU260
 584:Core/Src/bootloader.c ****     uint8_t jump_info[8];
 935              		.loc 1 584 5 view .LVU261
 585:Core/Src/bootloader.c ****     
 936              		.loc 1 585 5 view .LVU262
 588:Core/Src/bootloader.c ****     {
 937              		.loc 1 588 5 view .LVU263
 588:Core/Src/bootloader.c ****     {
 938              		.loc 1 588 10 is_stmt 0 view .LVU264
 939 0004 FFF7FEFF 		bl	Bootloader_CheckValidApplication
 940              	.LVL68:
 588:Core/Src/bootloader.c ****     {
 941              		.loc 1 588 8 discriminator 1 view .LVU265
 942 0008 58B3     		cbz	r0, .L75
 594:Core/Src/bootloader.c ****     jump_address = *(__IO uint32_t *)(APPLICATION_ADDRESS + 4);
 943              		.loc 1 594 5 is_stmt 1 view .LVU266
 594:Core/Src/bootloader.c ****     jump_address = *(__IO uint32_t *)(APPLICATION_ADDRESS + 4);
 944              		.loc 1 594 23 is_stmt 0 view .LVU267
 945 000a 174E     		ldr	r6, .L77
 946 000c 3468     		ldr	r4, [r6]
 947              	.LVL69:
 595:Core/Src/bootloader.c ****     
 948              		.loc 1 595 5 is_stmt 1 view .LVU268
 595:Core/Src/bootloader.c ****     
 949              		.loc 1 595 18 is_stmt 0 view .LVU269
 950 000e 7568     		ldr	r5, [r6, #4]
 951              	.LVL70:
 598:Core/Src/bootloader.c ****     jump_info[1] = (app_stack_pointer >> 24) & 0xFF;  /* Stack pointer MSB */
 952              		.loc 1 598 5 is_stmt 1 view .LVU270
 598:Core/Src/bootloader.c ****     jump_info[1] = (app_stack_pointer >> 24) & 0xFF;  /* Stack pointer MSB */
 953              		.loc 1 598 18 is_stmt 0 view .LVU271
 954 0010 1620     		movs	r0, #22
 955 0012 8DF80000 		strb	r0, [sp]
 599:Core/Src/bootloader.c ****     jump_info[2] = (app_stack_pointer >> 16) & 0xFF;
 956              		.loc 1 599 5 is_stmt 1 view .LVU272
 599:Core/Src/bootloader.c ****     jump_info[2] = (app_stack_pointer >> 16) & 0xFF;
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 37


 957              		.loc 1 599 39 is_stmt 0 view .LVU273
 958 0016 230E     		lsrs	r3, r4, #24
 599:Core/Src/bootloader.c ****     jump_info[2] = (app_stack_pointer >> 16) & 0xFF;
 959              		.loc 1 599 18 view .LVU274
 960 0018 8DF80130 		strb	r3, [sp, #1]
 600:Core/Src/bootloader.c ****     jump_info[3] = (app_stack_pointer >> 8) & 0xFF;
 961              		.loc 1 600 5 is_stmt 1 view .LVU275
 600:Core/Src/bootloader.c ****     jump_info[3] = (app_stack_pointer >> 8) & 0xFF;
 962              		.loc 1 600 39 is_stmt 0 view .LVU276
 963 001c 230C     		lsrs	r3, r4, #16
 600:Core/Src/bootloader.c ****     jump_info[3] = (app_stack_pointer >> 8) & 0xFF;
 964              		.loc 1 600 18 view .LVU277
 965 001e 8DF80230 		strb	r3, [sp, #2]
 601:Core/Src/bootloader.c ****     jump_info[4] = app_stack_pointer & 0xFF;          /* Stack pointer LSB */
 966              		.loc 1 601 5 is_stmt 1 view .LVU278
 601:Core/Src/bootloader.c ****     jump_info[4] = app_stack_pointer & 0xFF;          /* Stack pointer LSB */
 967              		.loc 1 601 39 is_stmt 0 view .LVU279
 968 0022 230A     		lsrs	r3, r4, #8
 601:Core/Src/bootloader.c ****     jump_info[4] = app_stack_pointer & 0xFF;          /* Stack pointer LSB */
 969              		.loc 1 601 18 view .LVU280
 970 0024 8DF80330 		strb	r3, [sp, #3]
 602:Core/Src/bootloader.c ****     jump_info[5] = (jump_address >> 16) & 0xFF;       /* Reset vector high word */
 971              		.loc 1 602 5 is_stmt 1 view .LVU281
 602:Core/Src/bootloader.c ****     jump_info[5] = (jump_address >> 16) & 0xFF;       /* Reset vector high word */
 972              		.loc 1 602 18 is_stmt 0 view .LVU282
 973 0028 8DF80440 		strb	r4, [sp, #4]
 603:Core/Src/bootloader.c ****     jump_info[6] = (jump_address >> 8) & 0xFF;
 974              		.loc 1 603 5 is_stmt 1 view .LVU283
 603:Core/Src/bootloader.c ****     jump_info[6] = (jump_address >> 8) & 0xFF;
 975              		.loc 1 603 34 is_stmt 0 view .LVU284
 976 002c 2B0C     		lsrs	r3, r5, #16
 603:Core/Src/bootloader.c ****     jump_info[6] = (jump_address >> 8) & 0xFF;
 977              		.loc 1 603 18 view .LVU285
 978 002e 8DF80530 		strb	r3, [sp, #5]
 604:Core/Src/bootloader.c ****     jump_info[7] = jump_address & 0xFF;               /* Reset vector LSB */
 979              		.loc 1 604 5 is_stmt 1 view .LVU286
 604:Core/Src/bootloader.c ****     jump_info[7] = jump_address & 0xFF;               /* Reset vector LSB */
 980              		.loc 1 604 34 is_stmt 0 view .LVU287
 981 0032 2B0A     		lsrs	r3, r5, #8
 604:Core/Src/bootloader.c ****     jump_info[7] = jump_address & 0xFF;               /* Reset vector LSB */
 982              		.loc 1 604 18 view .LVU288
 983 0034 8DF80630 		strb	r3, [sp, #6]
 605:Core/Src/bootloader.c ****     
 984              		.loc 1 605 5 is_stmt 1 view .LVU289
 605:Core/Src/bootloader.c ****     
 985              		.loc 1 605 18 is_stmt 0 view .LVU290
 986 0038 8DF80750 		strb	r5, [sp, #7]
 607:Core/Src/bootloader.c ****     
 987              		.loc 1 607 5 is_stmt 1 view .LVU291
 988 003c 0822     		movs	r2, #8
 989 003e 6946     		mov	r1, sp
 990 0040 FFF7FEFF 		bl	Bootloader_SendCANMessage
 991              	.LVL71:
 610:Core/Src/bootloader.c ****     
 992              		.loc 1 610 5 view .LVU292
 993 0044 FFF7FEFF 		bl	Bootloader_WaitForCANTransmission
 994              	.LVL72:
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 38


 612:Core/Src/bootloader.c ****     
 995              		.loc 1 612 5 view .LVU293
 612:Core/Src/bootloader.c ****     
 996              		.loc 1 612 29 is_stmt 0 view .LVU294
 997 0048 084B     		ldr	r3, .L77+4
 998 004a 0522     		movs	r2, #5
 999 004c 1A70     		strb	r2, [r3]
 615:Core/Src/bootloader.c ****     
 1000              		.loc 1 615 5 is_stmt 1 view .LVU295
 1001 004e FFF7FEFF 		bl	Bootloader_DeInit
 1002              	.LVL73:
 618:Core/Src/bootloader.c ****     
 1003              		.loc 1 618 5 view .LVU296
 1004              	.LBB8:
 1005              	.LBI8:
 210:Drivers/CMSIS/Include/cmsis_gcc.h **** }
 211:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 212:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 213:Drivers/CMSIS/Include/cmsis_gcc.h **** /**
 214:Drivers/CMSIS/Include/cmsis_gcc.h ****   \brief   Get Control Register
 215:Drivers/CMSIS/Include/cmsis_gcc.h ****   \details Returns the content of the Control Register.
 216:Drivers/CMSIS/Include/cmsis_gcc.h ****   \return               Control Register value
 217:Drivers/CMSIS/Include/cmsis_gcc.h ****  */
 218:Drivers/CMSIS/Include/cmsis_gcc.h **** __STATIC_FORCEINLINE uint32_t __get_CONTROL(void)
 219:Drivers/CMSIS/Include/cmsis_gcc.h **** {
 220:Drivers/CMSIS/Include/cmsis_gcc.h ****   uint32_t result;
 221:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 222:Drivers/CMSIS/Include/cmsis_gcc.h ****   __ASM volatile ("MRS %0, control" : "=r" (result) );
 223:Drivers/CMSIS/Include/cmsis_gcc.h ****   return(result);
 224:Drivers/CMSIS/Include/cmsis_gcc.h **** }
 225:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 226:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 227:Drivers/CMSIS/Include/cmsis_gcc.h **** #if (defined (__ARM_FEATURE_CMSE ) && (__ARM_FEATURE_CMSE == 3))
 228:Drivers/CMSIS/Include/cmsis_gcc.h **** /**
 229:Drivers/CMSIS/Include/cmsis_gcc.h ****   \brief   Get Control Register (non-secure)
 230:Drivers/CMSIS/Include/cmsis_gcc.h ****   \details Returns the content of the non-secure Control Register when in secure mode.
 231:Drivers/CMSIS/Include/cmsis_gcc.h ****   \return               non-secure Control Register value
 232:Drivers/CMSIS/Include/cmsis_gcc.h ****  */
 233:Drivers/CMSIS/Include/cmsis_gcc.h **** __STATIC_FORCEINLINE uint32_t __TZ_get_CONTROL_NS(void)
 234:Drivers/CMSIS/Include/cmsis_gcc.h **** {
 235:Drivers/CMSIS/Include/cmsis_gcc.h ****   uint32_t result;
 236:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 237:Drivers/CMSIS/Include/cmsis_gcc.h ****   __ASM volatile ("MRS %0, control_ns" : "=r" (result) );
 238:Drivers/CMSIS/Include/cmsis_gcc.h ****   return(result);
 239:Drivers/CMSIS/Include/cmsis_gcc.h **** }
 240:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
 241:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 242:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 243:Drivers/CMSIS/Include/cmsis_gcc.h **** /**
 244:Drivers/CMSIS/Include/cmsis_gcc.h ****   \brief   Set Control Register
 245:Drivers/CMSIS/Include/cmsis_gcc.h ****   \details Writes the given value to the Control Register.
 246:Drivers/CMSIS/Include/cmsis_gcc.h ****   \param [in]    control  Control Register value to set
 247:Drivers/CMSIS/Include/cmsis_gcc.h ****  */
 248:Drivers/CMSIS/Include/cmsis_gcc.h **** __STATIC_FORCEINLINE void __set_CONTROL(uint32_t control)
 249:Drivers/CMSIS/Include/cmsis_gcc.h **** {
 250:Drivers/CMSIS/Include/cmsis_gcc.h ****   __ASM volatile ("MSR control, %0" : : "r" (control) : "memory");
 251:Drivers/CMSIS/Include/cmsis_gcc.h **** }
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 39


 252:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 253:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 254:Drivers/CMSIS/Include/cmsis_gcc.h **** #if (defined (__ARM_FEATURE_CMSE ) && (__ARM_FEATURE_CMSE == 3))
 255:Drivers/CMSIS/Include/cmsis_gcc.h **** /**
 256:Drivers/CMSIS/Include/cmsis_gcc.h ****   \brief   Set Control Register (non-secure)
 257:Drivers/CMSIS/Include/cmsis_gcc.h ****   \details Writes the given value to the non-secure Control Register when in secure state.
 258:Drivers/CMSIS/Include/cmsis_gcc.h ****   \param [in]    control  Control Register value to set
 259:Drivers/CMSIS/Include/cmsis_gcc.h ****  */
 260:Drivers/CMSIS/Include/cmsis_gcc.h **** __STATIC_FORCEINLINE void __TZ_set_CONTROL_NS(uint32_t control)
 261:Drivers/CMSIS/Include/cmsis_gcc.h **** {
 262:Drivers/CMSIS/Include/cmsis_gcc.h ****   __ASM volatile ("MSR control_ns, %0" : : "r" (control) : "memory");
 263:Drivers/CMSIS/Include/cmsis_gcc.h **** }
 264:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
 265:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 266:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 267:Drivers/CMSIS/Include/cmsis_gcc.h **** /**
 268:Drivers/CMSIS/Include/cmsis_gcc.h ****   \brief   Get IPSR Register
 269:Drivers/CMSIS/Include/cmsis_gcc.h ****   \details Returns the content of the IPSR Register.
 270:Drivers/CMSIS/Include/cmsis_gcc.h ****   \return               IPSR Register value
 271:Drivers/CMSIS/Include/cmsis_gcc.h ****  */
 272:Drivers/CMSIS/Include/cmsis_gcc.h **** __STATIC_FORCEINLINE uint32_t __get_IPSR(void)
 273:Drivers/CMSIS/Include/cmsis_gcc.h **** {
 274:Drivers/CMSIS/Include/cmsis_gcc.h ****   uint32_t result;
 275:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 276:Drivers/CMSIS/Include/cmsis_gcc.h ****   __ASM volatile ("MRS %0, ipsr" : "=r" (result) );
 277:Drivers/CMSIS/Include/cmsis_gcc.h ****   return(result);
 278:Drivers/CMSIS/Include/cmsis_gcc.h **** }
 279:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 280:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 281:Drivers/CMSIS/Include/cmsis_gcc.h **** /**
 282:Drivers/CMSIS/Include/cmsis_gcc.h ****   \brief   Get APSR Register
 283:Drivers/CMSIS/Include/cmsis_gcc.h ****   \details Returns the content of the APSR Register.
 284:Drivers/CMSIS/Include/cmsis_gcc.h ****   \return               APSR Register value
 285:Drivers/CMSIS/Include/cmsis_gcc.h ****  */
 286:Drivers/CMSIS/Include/cmsis_gcc.h **** __STATIC_FORCEINLINE uint32_t __get_APSR(void)
 287:Drivers/CMSIS/Include/cmsis_gcc.h **** {
 288:Drivers/CMSIS/Include/cmsis_gcc.h ****   uint32_t result;
 289:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 290:Drivers/CMSIS/Include/cmsis_gcc.h ****   __ASM volatile ("MRS %0, apsr" : "=r" (result) );
 291:Drivers/CMSIS/Include/cmsis_gcc.h ****   return(result);
 292:Drivers/CMSIS/Include/cmsis_gcc.h **** }
 293:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 294:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 295:Drivers/CMSIS/Include/cmsis_gcc.h **** /**
 296:Drivers/CMSIS/Include/cmsis_gcc.h ****   \brief   Get xPSR Register
 297:Drivers/CMSIS/Include/cmsis_gcc.h ****   \details Returns the content of the xPSR Register.
 298:Drivers/CMSIS/Include/cmsis_gcc.h ****   \return               xPSR Register value
 299:Drivers/CMSIS/Include/cmsis_gcc.h ****  */
 300:Drivers/CMSIS/Include/cmsis_gcc.h **** __STATIC_FORCEINLINE uint32_t __get_xPSR(void)
 301:Drivers/CMSIS/Include/cmsis_gcc.h **** {
 302:Drivers/CMSIS/Include/cmsis_gcc.h ****   uint32_t result;
 303:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 304:Drivers/CMSIS/Include/cmsis_gcc.h ****   __ASM volatile ("MRS %0, xpsr" : "=r" (result) );
 305:Drivers/CMSIS/Include/cmsis_gcc.h ****   return(result);
 306:Drivers/CMSIS/Include/cmsis_gcc.h **** }
 307:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 308:Drivers/CMSIS/Include/cmsis_gcc.h **** 
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 40


 309:Drivers/CMSIS/Include/cmsis_gcc.h **** /**
 310:Drivers/CMSIS/Include/cmsis_gcc.h ****   \brief   Get Process Stack Pointer
 311:Drivers/CMSIS/Include/cmsis_gcc.h ****   \details Returns the current value of the Process Stack Pointer (PSP).
 312:Drivers/CMSIS/Include/cmsis_gcc.h ****   \return               PSP Register value
 313:Drivers/CMSIS/Include/cmsis_gcc.h ****  */
 314:Drivers/CMSIS/Include/cmsis_gcc.h **** __STATIC_FORCEINLINE uint32_t __get_PSP(void)
 315:Drivers/CMSIS/Include/cmsis_gcc.h **** {
 316:Drivers/CMSIS/Include/cmsis_gcc.h ****   uint32_t result;
 317:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 318:Drivers/CMSIS/Include/cmsis_gcc.h ****   __ASM volatile ("MRS %0, psp"  : "=r" (result) );
 319:Drivers/CMSIS/Include/cmsis_gcc.h ****   return(result);
 320:Drivers/CMSIS/Include/cmsis_gcc.h **** }
 321:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 322:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 323:Drivers/CMSIS/Include/cmsis_gcc.h **** #if (defined (__ARM_FEATURE_CMSE ) && (__ARM_FEATURE_CMSE == 3))
 324:Drivers/CMSIS/Include/cmsis_gcc.h **** /**
 325:Drivers/CMSIS/Include/cmsis_gcc.h ****   \brief   Get Process Stack Pointer (non-secure)
 326:Drivers/CMSIS/Include/cmsis_gcc.h ****   \details Returns the current value of the non-secure Process Stack Pointer (PSP) when in secure s
 327:Drivers/CMSIS/Include/cmsis_gcc.h ****   \return               PSP Register value
 328:Drivers/CMSIS/Include/cmsis_gcc.h ****  */
 329:Drivers/CMSIS/Include/cmsis_gcc.h **** __STATIC_FORCEINLINE uint32_t __TZ_get_PSP_NS(void)
 330:Drivers/CMSIS/Include/cmsis_gcc.h **** {
 331:Drivers/CMSIS/Include/cmsis_gcc.h ****   uint32_t result;
 332:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 333:Drivers/CMSIS/Include/cmsis_gcc.h ****   __ASM volatile ("MRS %0, psp_ns"  : "=r" (result) );
 334:Drivers/CMSIS/Include/cmsis_gcc.h ****   return(result);
 335:Drivers/CMSIS/Include/cmsis_gcc.h **** }
 336:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
 337:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 338:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 339:Drivers/CMSIS/Include/cmsis_gcc.h **** /**
 340:Drivers/CMSIS/Include/cmsis_gcc.h ****   \brief   Set Process Stack Pointer
 341:Drivers/CMSIS/Include/cmsis_gcc.h ****   \details Assigns the given value to the Process Stack Pointer (PSP).
 342:Drivers/CMSIS/Include/cmsis_gcc.h ****   \param [in]    topOfProcStack  Process Stack Pointer value to set
 343:Drivers/CMSIS/Include/cmsis_gcc.h ****  */
 344:Drivers/CMSIS/Include/cmsis_gcc.h **** __STATIC_FORCEINLINE void __set_PSP(uint32_t topOfProcStack)
 345:Drivers/CMSIS/Include/cmsis_gcc.h **** {
 346:Drivers/CMSIS/Include/cmsis_gcc.h ****   __ASM volatile ("MSR psp, %0" : : "r" (topOfProcStack) : );
 347:Drivers/CMSIS/Include/cmsis_gcc.h **** }
 348:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 349:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 350:Drivers/CMSIS/Include/cmsis_gcc.h **** #if (defined (__ARM_FEATURE_CMSE ) && (__ARM_FEATURE_CMSE == 3))
 351:Drivers/CMSIS/Include/cmsis_gcc.h **** /**
 352:Drivers/CMSIS/Include/cmsis_gcc.h ****   \brief   Set Process Stack Pointer (non-secure)
 353:Drivers/CMSIS/Include/cmsis_gcc.h ****   \details Assigns the given value to the non-secure Process Stack Pointer (PSP) when in secure sta
 354:Drivers/CMSIS/Include/cmsis_gcc.h ****   \param [in]    topOfProcStack  Process Stack Pointer value to set
 355:Drivers/CMSIS/Include/cmsis_gcc.h ****  */
 356:Drivers/CMSIS/Include/cmsis_gcc.h **** __STATIC_FORCEINLINE void __TZ_set_PSP_NS(uint32_t topOfProcStack)
 357:Drivers/CMSIS/Include/cmsis_gcc.h **** {
 358:Drivers/CMSIS/Include/cmsis_gcc.h ****   __ASM volatile ("MSR psp_ns, %0" : : "r" (topOfProcStack) : );
 359:Drivers/CMSIS/Include/cmsis_gcc.h **** }
 360:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
 361:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 362:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 363:Drivers/CMSIS/Include/cmsis_gcc.h **** /**
 364:Drivers/CMSIS/Include/cmsis_gcc.h ****   \brief   Get Main Stack Pointer
 365:Drivers/CMSIS/Include/cmsis_gcc.h ****   \details Returns the current value of the Main Stack Pointer (MSP).
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 41


 366:Drivers/CMSIS/Include/cmsis_gcc.h ****   \return               MSP Register value
 367:Drivers/CMSIS/Include/cmsis_gcc.h ****  */
 368:Drivers/CMSIS/Include/cmsis_gcc.h **** __STATIC_FORCEINLINE uint32_t __get_MSP(void)
 369:Drivers/CMSIS/Include/cmsis_gcc.h **** {
 370:Drivers/CMSIS/Include/cmsis_gcc.h ****   uint32_t result;
 371:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 372:Drivers/CMSIS/Include/cmsis_gcc.h ****   __ASM volatile ("MRS %0, msp" : "=r" (result) );
 373:Drivers/CMSIS/Include/cmsis_gcc.h ****   return(result);
 374:Drivers/CMSIS/Include/cmsis_gcc.h **** }
 375:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 376:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 377:Drivers/CMSIS/Include/cmsis_gcc.h **** #if (defined (__ARM_FEATURE_CMSE ) && (__ARM_FEATURE_CMSE == 3))
 378:Drivers/CMSIS/Include/cmsis_gcc.h **** /**
 379:Drivers/CMSIS/Include/cmsis_gcc.h ****   \brief   Get Main Stack Pointer (non-secure)
 380:Drivers/CMSIS/Include/cmsis_gcc.h ****   \details Returns the current value of the non-secure Main Stack Pointer (MSP) when in secure stat
 381:Drivers/CMSIS/Include/cmsis_gcc.h ****   \return               MSP Register value
 382:Drivers/CMSIS/Include/cmsis_gcc.h ****  */
 383:Drivers/CMSIS/Include/cmsis_gcc.h **** __STATIC_FORCEINLINE uint32_t __TZ_get_MSP_NS(void)
 384:Drivers/CMSIS/Include/cmsis_gcc.h **** {
 385:Drivers/CMSIS/Include/cmsis_gcc.h ****   uint32_t result;
 386:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 387:Drivers/CMSIS/Include/cmsis_gcc.h ****   __ASM volatile ("MRS %0, msp_ns" : "=r" (result) );
 388:Drivers/CMSIS/Include/cmsis_gcc.h ****   return(result);
 389:Drivers/CMSIS/Include/cmsis_gcc.h **** }
 390:Drivers/CMSIS/Include/cmsis_gcc.h **** #endif
 391:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 392:Drivers/CMSIS/Include/cmsis_gcc.h **** 
 393:Drivers/CMSIS/Include/cmsis_gcc.h **** /**
 394:Drivers/CMSIS/Include/cmsis_gcc.h ****   \brief   Set Main Stack Pointer
 395:Drivers/CMSIS/Include/cmsis_gcc.h ****   \details Assigns the given value to the Main Stack Pointer (MSP).
 396:Drivers/CMSIS/Include/cmsis_gcc.h ****   \param [in]    topOfMainStack  Main Stack Pointer value to set
 397:Drivers/CMSIS/Include/cmsis_gcc.h ****  */
 398:Drivers/CMSIS/Include/cmsis_gcc.h **** __STATIC_FORCEINLINE void __set_MSP(uint32_t topOfMainStack)
 1006              		.loc 2 398 27 view .LVU297
 1007              	.LBB9:
 399:Drivers/CMSIS/Include/cmsis_gcc.h **** {
 400:Drivers/CMSIS/Include/cmsis_gcc.h ****   __ASM volatile ("MSR msp, %0" : : "r" (topOfMainStack) : );
 1008              		.loc 2 400 3 view .LVU298
 1009              		.syntax unified
 1010              	@ 400 "Drivers/CMSIS/Include/cmsis_gcc.h" 1
 1011 0052 84F30888 		MSR msp, r4
 1012              	@ 0 "" 2
 1013              	.LVL74:
 1014              		.loc 2 400 3 is_stmt 0 view .LVU299
 1015              		.thumb
 1016              		.syntax unified
 1017              	.LBE9:
 1018              	.LBE8:
 621:Core/Src/bootloader.c ****     
 1019              		.loc 1 621 5 is_stmt 1 view .LVU300
 624:Core/Src/bootloader.c ****     
 1020              		.loc 1 624 5 view .LVU301
 624:Core/Src/bootloader.c ****     
 1021              		.loc 1 624 15 is_stmt 0 view .LVU302
 1022 0056 064B     		ldr	r3, .L77+8
 1023 0058 9E60     		str	r6, [r3, #8]
 627:Core/Src/bootloader.c ****     
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 42


 1024              		.loc 1 627 5 is_stmt 1 view .LVU303
 1025 005a A847     		blx	r5
 1026              	.LVL75:
 630:Core/Src/bootloader.c **** }
 1027              		.loc 1 630 5 view .LVU304
 630:Core/Src/bootloader.c **** }
 1028              		.loc 1 630 12 is_stmt 0 view .LVU305
 1029 005c 0020     		movs	r0, #0
 1030              	.LVL76:
 1031              	.L74:
 631:Core/Src/bootloader.c **** 
 1032              		.loc 1 631 1 view .LVU306
 1033 005e 02B0     		add	sp, sp, #8
 1034              		.cfi_remember_state
 1035              		.cfi_def_cfa_offset 16
 1036              		@ sp needed
 1037 0060 70BD     		pop	{r4, r5, r6, pc}
 1038              	.L75:
 1039              		.cfi_restore_state
 590:Core/Src/bootloader.c ****     }
 1040              		.loc 1 590 16 view .LVU307
 1041 0062 0620     		movs	r0, #6
 1042 0064 FBE7     		b	.L74
 1043              	.L78:
 1044 0066 00BF     		.align	2
 1045              	.L77:
 1046 0068 00800008 		.word	134250496
 1047 006c 00000000 		.word	bootloader_status
 1048 0070 00ED00E0 		.word	-536810240
 1049              		.cfi_endproc
 1050              	.LFE142:
 1052              		.section	.text.Bootloader_SetApplicationValidFlag,"ax",%progbits
 1053              		.align	1
 1054              		.global	Bootloader_SetApplicationValidFlag
 1055              		.syntax unified
 1056              		.thumb
 1057              		.thumb_func
 1059              	Bootloader_SetApplicationValidFlag:
 1060              	.LFB146:
 681:Core/Src/bootloader.c **** 
 682:Core/Src/bootloader.c **** /**
 683:Core/Src/bootloader.c ****   * @brief  Set application valid flag in flash
 684:Core/Src/bootloader.c ****   * @retval ERR_NONE if successful, error code otherwise
 685:Core/Src/bootloader.c ****   */
 686:Core/Src/bootloader.c **** uint8_t Bootloader_SetApplicationValidFlag(void)
 687:Core/Src/bootloader.c **** {
 1061              		.loc 1 687 1 is_stmt 1 view -0
 1062              		.cfi_startproc
 1063              		@ args = 0, pretend = 0, frame = 32
 1064              		@ frame_needed = 0, uses_anonymous_args = 0
 1065 0000 10B5     		push	{r4, lr}
 1066              		.cfi_def_cfa_offset 8
 1067              		.cfi_offset 4, -8
 1068              		.cfi_offset 14, -4
 1069 0002 88B0     		sub	sp, sp, #32
 1070              		.cfi_def_cfa_offset 40
 688:Core/Src/bootloader.c ****     HAL_StatusTypeDef status;
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 43


 1071              		.loc 1 688 5 view .LVU309
 689:Core/Src/bootloader.c ****     uint32_t magic_data[2];
 1072              		.loc 1 689 5 view .LVU310
 690:Core/Src/bootloader.c ****     uint64_t data_to_write;
 1073              		.loc 1 690 5 view .LVU311
 691:Core/Src/bootloader.c ****     
 692:Core/Src/bootloader.c ****     magic_data[0] = APP_VALID_MAGIC_NUMBER;
 1074              		.loc 1 692 5 view .LVU312
 1075              		.loc 1 692 19 is_stmt 0 view .LVU313
 1076 0004 164B     		ldr	r3, .L86+8
 1077 0006 0693     		str	r3, [sp, #24]
 693:Core/Src/bootloader.c ****     magic_data[1] = APP_VALID_FLAG_COMPLEMENT;
 1078              		.loc 1 693 5 is_stmt 1 view .LVU314
 1079              		.loc 1 693 19 is_stmt 0 view .LVU315
 1080 0008 164B     		ldr	r3, .L86+12
 1081 000a 0793     		str	r3, [sp, #28]
 694:Core/Src/bootloader.c ****     
 695:Core/Src/bootloader.c ****     /* Unlock flash */
 696:Core/Src/bootloader.c ****     HAL_FLASH_Unlock();
 1082              		.loc 1 696 5 is_stmt 1 view .LVU316
 1083 000c FFF7FEFF 		bl	HAL_FLASH_Unlock
 1084              	.LVL77:
 697:Core/Src/bootloader.c ****     
 698:Core/Src/bootloader.c ****     /* Erase the page containing the flag (Page 63 - last page before application) */
 699:Core/Src/bootloader.c ****     FLASH_EraseInitTypeDef erase_init;
 1085              		.loc 1 699 5 view .LVU317
 700:Core/Src/bootloader.c ****     uint32_t page_error;
 1086              		.loc 1 700 5 view .LVU318
 701:Core/Src/bootloader.c ****     
 702:Core/Src/bootloader.c ****     erase_init.TypeErase = FLASH_TYPEERASE_PAGES;
 1087              		.loc 1 702 5 view .LVU319
 1088              		.loc 1 702 26 is_stmt 0 view .LVU320
 1089 0010 0023     		movs	r3, #0
 1090 0012 0293     		str	r3, [sp, #8]
 703:Core/Src/bootloader.c ****     erase_init.Page = 63;  /* Last page of bootloader area (32KB / 2KB per page = page 0-15, but fl
 1091              		.loc 1 703 5 is_stmt 1 view .LVU321
 1092              		.loc 1 703 21 is_stmt 0 view .LVU322
 1093 0014 3F23     		movs	r3, #63
 1094 0016 0493     		str	r3, [sp, #16]
 704:Core/Src/bootloader.c ****     erase_init.NbPages = 1;
 1095              		.loc 1 704 5 is_stmt 1 view .LVU323
 1096              		.loc 1 704 24 is_stmt 0 view .LVU324
 1097 0018 0123     		movs	r3, #1
 1098 001a 0593     		str	r3, [sp, #20]
 705:Core/Src/bootloader.c ****     
 706:Core/Src/bootloader.c ****     status = HAL_FLASHEx_Erase(&erase_init, &page_error);
 1099              		.loc 1 706 5 is_stmt 1 view .LVU325
 1100              		.loc 1 706 14 is_stmt 0 view .LVU326
 1101 001c 01A9     		add	r1, sp, #4
 1102 001e 02A8     		add	r0, sp, #8
 1103 0020 FFF7FEFF 		bl	HAL_FLASHEx_Erase
 1104              	.LVL78:
 707:Core/Src/bootloader.c ****     if (status != HAL_OK)
 1105              		.loc 1 707 5 is_stmt 1 view .LVU327
 1106              		.loc 1 707 8 is_stmt 0 view .LVU328
 1107 0024 68B9     		cbnz	r0, .L84
 708:Core/Src/bootloader.c ****     {
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 44


 709:Core/Src/bootloader.c ****         HAL_FLASH_Lock();
 710:Core/Src/bootloader.c ****         return ERR_FLASH_ERASE_FAILED;
 711:Core/Src/bootloader.c ****     }
 712:Core/Src/bootloader.c ****     
 713:Core/Src/bootloader.c ****     /* Write magic number (first 4 bytes) */
 714:Core/Src/bootloader.c ****     status = HAL_FLASH_Program(FLASH_TYPEPROGRAM_DOUBLEWORD, APP_VALID_FLAG_ADDRESS, 
 1108              		.loc 1 714 5 is_stmt 1 view .LVU329
 1109              		.loc 1 714 14 is_stmt 0 view .LVU330
 1110 0026 0CA3     		adr	r3, .L86
 1111 0028 D3E90023 		ldrd	r2, [r3]
 1112 002c 0E49     		ldr	r1, .L86+16
 1113 002e 0020     		movs	r0, #0
 1114              	.LVL79:
 1115              		.loc 1 714 14 view .LVU331
 1116 0030 FFF7FEFF 		bl	HAL_FLASH_Program
 1117              	.LVL80:
 715:Core/Src/bootloader.c ****                                 *((uint64_t*)magic_data));
 716:Core/Src/bootloader.c ****     
 717:Core/Src/bootloader.c ****     if (status != HAL_OK)
 1118              		.loc 1 717 5 is_stmt 1 view .LVU332
 1119              		.loc 1 717 8 is_stmt 0 view .LVU333
 1120 0034 0446     		mov	r4, r0
 1121 0036 40B9     		cbnz	r0, .L85
 718:Core/Src/bootloader.c ****     {
 719:Core/Src/bootloader.c ****         HAL_FLASH_Lock();
 720:Core/Src/bootloader.c ****         return ERR_FLASH_WRITE_FAILED;
 721:Core/Src/bootloader.c ****     }
 722:Core/Src/bootloader.c ****     
 723:Core/Src/bootloader.c ****     /* Lock flash */
 724:Core/Src/bootloader.c ****     HAL_FLASH_Lock();
 1122              		.loc 1 724 5 is_stmt 1 view .LVU334
 1123 0038 FFF7FEFF 		bl	HAL_FLASH_Lock
 1124              	.LVL81:
 725:Core/Src/bootloader.c ****     
 726:Core/Src/bootloader.c ****     return ERR_NONE;
 1125              		.loc 1 726 5 view .LVU335
 1126              	.L81:
 727:Core/Src/bootloader.c **** }
 1127              		.loc 1 727 1 is_stmt 0 view .LVU336
 1128 003c 2046     		mov	r0, r4
 1129 003e 08B0     		add	sp, sp, #32
 1130              		.cfi_remember_state
 1131              		.cfi_def_cfa_offset 8
 1132              		@ sp needed
 1133 0040 10BD     		pop	{r4, pc}
 1134              	.LVL82:
 1135              	.L84:
 1136              		.cfi_restore_state
 709:Core/Src/bootloader.c ****         return ERR_FLASH_ERASE_FAILED;
 1137              		.loc 1 709 9 is_stmt 1 view .LVU337
 1138 0042 FFF7FEFF 		bl	HAL_FLASH_Lock
 1139              	.LVL83:
 710:Core/Src/bootloader.c ****     }
 1140              		.loc 1 710 9 view .LVU338
 710:Core/Src/bootloader.c ****     }
 1141              		.loc 1 710 16 is_stmt 0 view .LVU339
 1142 0046 0324     		movs	r4, #3
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 45


 1143 0048 F8E7     		b	.L81
 1144              	.LVL84:
 1145              	.L85:
 719:Core/Src/bootloader.c ****         return ERR_FLASH_WRITE_FAILED;
 1146              		.loc 1 719 9 is_stmt 1 view .LVU340
 1147 004a FFF7FEFF 		bl	HAL_FLASH_Lock
 1148              	.LVL85:
 720:Core/Src/bootloader.c ****     }
 1149              		.loc 1 720 9 view .LVU341
 720:Core/Src/bootloader.c ****     }
 1150              		.loc 1 720 16 is_stmt 0 view .LVU342
 1151 004e 0424     		movs	r4, #4
 1152              	.LVL86:
 720:Core/Src/bootloader.c ****     }
 1153              		.loc 1 720 16 view .LVU343
 1154 0050 F4E7     		b	.L81
 1155              	.L87:
 1156 0052 00BFAFF3 		.align	3
 1156      0080
 1157              	.L86:
 1158 0058 EFBEADDE 		.word	-559038737
 1159 005c 10415221 		.word	559038736
 1160 0060 EFBEADDE 		.word	-559038737
 1161 0064 10415221 		.word	559038736
 1162 0068 F87F0008 		.word	134250488
 1163              		.cfi_endproc
 1164              	.LFE146:
 1166              		.section	.text.Bootloader_CheckApplicationValidFlag,"ax",%progbits
 1167              		.align	1
 1168              		.global	Bootloader_CheckApplicationValidFlag
 1169              		.syntax unified
 1170              		.thumb
 1171              		.thumb_func
 1173              	Bootloader_CheckApplicationValidFlag:
 1174              	.LFB147:
 728:Core/Src/bootloader.c **** 
 729:Core/Src/bootloader.c **** /**
 730:Core/Src/bootloader.c ****   * @brief  Check if application valid flag is set
 731:Core/Src/bootloader.c ****   * @retval 1 if valid, 0 if not valid
 732:Core/Src/bootloader.c ****   */
 733:Core/Src/bootloader.c **** uint8_t Bootloader_CheckApplicationValidFlag(void)
 734:Core/Src/bootloader.c **** {
 1175              		.loc 1 734 1 is_stmt 1 view -0
 1176              		.cfi_startproc
 1177              		@ args = 0, pretend = 0, frame = 0
 1178              		@ frame_needed = 0, uses_anonymous_args = 0
 1179              		@ link register save eliminated.
 735:Core/Src/bootloader.c ****     uint32_t *flag_ptr = (uint32_t *)APP_VALID_FLAG_ADDRESS;
 1180              		.loc 1 735 5 view .LVU345
 1181              	.LVL87:
 736:Core/Src/bootloader.c ****     
 737:Core/Src/bootloader.c ****     /* Check if both magic number and complement are present */
 738:Core/Src/bootloader.c ****     if (flag_ptr[0] == APP_VALID_MAGIC_NUMBER && 
 1182              		.loc 1 738 5 view .LVU346
 1183              		.loc 1 738 17 is_stmt 0 view .LVU347
 1184 0000 084B     		ldr	r3, .L93
 1185 0002 D3F8F82F 		ldr	r2, [r3, #4088]
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 46


 1186              		.loc 1 738 8 view .LVU348
 1187 0006 084B     		ldr	r3, .L93+4
 1188 0008 9A42     		cmp	r2, r3
 1189 000a 01D0     		beq	.L92
 739:Core/Src/bootloader.c ****         flag_ptr[1] == APP_VALID_FLAG_COMPLEMENT)
 740:Core/Src/bootloader.c ****     {
 741:Core/Src/bootloader.c ****         return 1;  /* Valid flag found */
 742:Core/Src/bootloader.c ****     }
 743:Core/Src/bootloader.c ****     
 744:Core/Src/bootloader.c ****     return 0;  /* No valid flag */
 1190              		.loc 1 744 12 view .LVU349
 1191 000c 0020     		movs	r0, #0
 1192 000e 7047     		bx	lr
 1193              	.L92:
 739:Core/Src/bootloader.c ****         flag_ptr[1] == APP_VALID_FLAG_COMPLEMENT)
 1194              		.loc 1 739 17 view .LVU350
 1195 0010 044B     		ldr	r3, .L93
 1196 0012 D3F8FC2F 		ldr	r2, [r3, #4092]
 738:Core/Src/bootloader.c ****         flag_ptr[1] == APP_VALID_FLAG_COMPLEMENT)
 1197              		.loc 1 738 47 discriminator 1 view .LVU351
 1198 0016 054B     		ldr	r3, .L93+8
 1199 0018 9A42     		cmp	r2, r3
 1200 001a 01D0     		beq	.L91
 1201              		.loc 1 744 12 view .LVU352
 1202 001c 0020     		movs	r0, #0
 1203 001e 7047     		bx	lr
 1204              	.L91:
 741:Core/Src/bootloader.c ****     }
 1205              		.loc 1 741 16 view .LVU353
 1206 0020 0120     		movs	r0, #1
 745:Core/Src/bootloader.c **** }
 1207              		.loc 1 745 1 view .LVU354
 1208 0022 7047     		bx	lr
 1209              	.L94:
 1210              		.align	2
 1211              	.L93:
 1212 0024 00700008 		.word	134246400
 1213 0028 EFBEADDE 		.word	-559038737
 1214 002c 10415221 		.word	559038736
 1215              		.cfi_endproc
 1216              	.LFE147:
 1218              		.section	.text.Bootloader_Main,"ax",%progbits
 1219              		.align	1
 1220              		.global	Bootloader_Main
 1221              		.syntax unified
 1222              		.thumb
 1223              		.thumb_func
 1225              	Bootloader_Main:
 1226              	.LFB134:
 112:Core/Src/bootloader.c ****     uint32_t timeout_start = HAL_GetTick();
 1227              		.loc 1 112 1 is_stmt 1 view -0
 1228              		.cfi_startproc
 1229              		@ args = 0, pretend = 0, frame = 0
 1230              		@ frame_needed = 0, uses_anonymous_args = 0
 1231 0000 38B5     		push	{r3, r4, r5, lr}
 1232              		.cfi_def_cfa_offset 16
 1233              		.cfi_offset 3, -16
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 47


 1234              		.cfi_offset 4, -12
 1235              		.cfi_offset 5, -8
 1236              		.cfi_offset 14, -4
 113:Core/Src/bootloader.c ****     uint8_t timeout_expired = 0;
 1237              		.loc 1 113 5 view .LVU356
 113:Core/Src/bootloader.c ****     uint8_t timeout_expired = 0;
 1238              		.loc 1 113 30 is_stmt 0 view .LVU357
 1239 0002 FFF7FEFF 		bl	HAL_GetTick
 1240              	.LVL88:
 1241 0006 0546     		mov	r5, r0
 1242              	.LVL89:
 114:Core/Src/bootloader.c ****     
 1243              		.loc 1 114 5 is_stmt 1 view .LVU358
 117:Core/Src/bootloader.c ****     tx_data[1] = 0x01;  /* Bootloader version */
 1244              		.loc 1 117 5 view .LVU359
 117:Core/Src/bootloader.c ****     tx_data[1] = 0x01;  /* Bootloader version */
 1245              		.loc 1 117 16 is_stmt 0 view .LVU360
 1246 0008 2249     		ldr	r1, .L102
 1247 000a 1420     		movs	r0, #20
 1248              	.LVL90:
 117:Core/Src/bootloader.c ****     tx_data[1] = 0x01;  /* Bootloader version */
 1249              		.loc 1 117 16 view .LVU361
 1250 000c 0870     		strb	r0, [r1]
 118:Core/Src/bootloader.c ****     tx_data[2] = 0x00;  /* Bootloader subversion */
 1251              		.loc 1 118 5 is_stmt 1 view .LVU362
 118:Core/Src/bootloader.c ****     tx_data[2] = 0x00;  /* Bootloader subversion */
 1252              		.loc 1 118 16 is_stmt 0 view .LVU363
 1253 000e 0123     		movs	r3, #1
 1254 0010 4B70     		strb	r3, [r1, #1]
 119:Core/Src/bootloader.c ****     Bootloader_SendCANMessage(RESP_READY, tx_data, 3);
 1255              		.loc 1 119 5 is_stmt 1 view .LVU364
 119:Core/Src/bootloader.c ****     Bootloader_SendCANMessage(RESP_READY, tx_data, 3);
 1256              		.loc 1 119 16 is_stmt 0 view .LVU365
 1257 0012 0024     		movs	r4, #0
 1258 0014 8C70     		strb	r4, [r1, #2]
 120:Core/Src/bootloader.c ****     
 1259              		.loc 1 120 5 is_stmt 1 view .LVU366
 1260 0016 0322     		movs	r2, #3
 1261 0018 FFF7FEFF 		bl	Bootloader_SendCANMessage
 1262              	.LVL91:
 1263 001c 27E0     		b	.L98
 1264              	.LVL92:
 1265              	.L101:
 136:Core/Src/bootloader.c ****                 tx_data[1] = 0xAA;  /* Special: Timeout auto-jump */
 1266              		.loc 1 136 17 view .LVU367
 136:Core/Src/bootloader.c ****                 tx_data[1] = 0xAA;  /* Special: Timeout auto-jump */
 1267              		.loc 1 136 28 is_stmt 0 view .LVU368
 1268 001e 1D49     		ldr	r1, .L102
 1269 0020 1420     		movs	r0, #20
 1270 0022 0870     		strb	r0, [r1]
 137:Core/Src/bootloader.c ****                 tx_data[2] = 0x55;
 1271              		.loc 1 137 17 is_stmt 1 view .LVU369
 137:Core/Src/bootloader.c ****                 tx_data[2] = 0x55;
 1272              		.loc 1 137 28 is_stmt 0 view .LVU370
 1273 0024 AA23     		movs	r3, #170
 1274 0026 4B70     		strb	r3, [r1, #1]
 138:Core/Src/bootloader.c ****                 Bootloader_SendCANMessage(RESP_READY, tx_data, 3);
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 48


 1275              		.loc 1 138 17 is_stmt 1 view .LVU371
 138:Core/Src/bootloader.c ****                 Bootloader_SendCANMessage(RESP_READY, tx_data, 3);
 1276              		.loc 1 138 28 is_stmt 0 view .LVU372
 1277 0028 5523     		movs	r3, #85
 1278 002a 8B70     		strb	r3, [r1, #2]
 139:Core/Src/bootloader.c **** 
 1279              		.loc 1 139 17 is_stmt 1 view .LVU373
 1280 002c 0322     		movs	r2, #3
 1281 002e FFF7FEFF 		bl	Bootloader_SendCANMessage
 1282              	.LVL93:
 142:Core/Src/bootloader.c ****                 HAL_Delay(10);
 1283              		.loc 1 142 17 view .LVU374
 1284 0032 FFF7FEFF 		bl	Bootloader_WaitForCANTransmission
 1285              	.LVL94:
 143:Core/Src/bootloader.c **** 
 1286              		.loc 1 143 17 view .LVU375
 1287 0036 0A20     		movs	r0, #10
 1288 0038 FFF7FEFF 		bl	HAL_Delay
 1289              	.LVL95:
 146:Core/Src/bootloader.c ****             }
 1290              		.loc 1 146 17 view .LVU376
 1291 003c FFF7FEFF 		bl	Bootloader_JumpToApplication
 1292              	.LVL96:
 130:Core/Src/bootloader.c **** 
 1293              		.loc 1 130 29 is_stmt 0 view .LVU377
 1294 0040 0124     		movs	r4, #1
 1295              	.LVL97:
 1296              	.L96:
 152:Core/Src/bootloader.c ****         {
 1297              		.loc 1 152 9 is_stmt 1 view .LVU378
 152:Core/Src/bootloader.c ****         {
 1298              		.loc 1 152 13 is_stmt 0 view .LVU379
 1299 0042 154B     		ldr	r3, .L102+4
 1300 0044 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 152:Core/Src/bootloader.c ****         {
 1301              		.loc 1 152 12 view .LVU380
 1302 0046 7BB1     		cbz	r3, .L97
 155:Core/Src/bootloader.c ****             tx_data[1] = 0xFF;  /* Special: About to jump */
 1303              		.loc 1 155 13 is_stmt 1 view .LVU381
 155:Core/Src/bootloader.c ****             tx_data[1] = 0xFF;  /* Special: About to jump */
 1304              		.loc 1 155 24 is_stmt 0 view .LVU382
 1305 0048 1249     		ldr	r1, .L102
 1306 004a 1420     		movs	r0, #20
 1307 004c 0870     		strb	r0, [r1]
 156:Core/Src/bootloader.c ****             tx_data[2] = 0xFF;
 1308              		.loc 1 156 13 is_stmt 1 view .LVU383
 156:Core/Src/bootloader.c ****             tx_data[2] = 0xFF;
 1309              		.loc 1 156 24 is_stmt 0 view .LVU384
 1310 004e FF23     		movs	r3, #255
 1311 0050 4B70     		strb	r3, [r1, #1]
 157:Core/Src/bootloader.c ****             Bootloader_SendCANMessage(RESP_READY, tx_data, 3);
 1312              		.loc 1 157 13 is_stmt 1 view .LVU385
 157:Core/Src/bootloader.c ****             Bootloader_SendCANMessage(RESP_READY, tx_data, 3);
 1313              		.loc 1 157 24 is_stmt 0 view .LVU386
 1314 0052 8B70     		strb	r3, [r1, #2]
 158:Core/Src/bootloader.c ****             
 1315              		.loc 1 158 13 is_stmt 1 view .LVU387
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 49


 1316 0054 0322     		movs	r2, #3
 1317 0056 FFF7FEFF 		bl	Bootloader_SendCANMessage
 1318              	.LVL98:
 161:Core/Src/bootloader.c ****             
 1319              		.loc 1 161 13 view .LVU388
 1320 005a FFF7FEFF 		bl	Bootloader_WaitForCANTransmission
 1321              	.LVL99:
 164:Core/Src/bootloader.c ****             
 1322              		.loc 1 164 13 view .LVU389
 1323 005e FFF7FEFF 		bl	Bootloader_JumpToApplication
 1324              	.LVL100:
 167:Core/Src/bootloader.c ****         }
 1325              		.loc 1 167 13 view .LVU390
 167:Core/Src/bootloader.c ****         }
 1326              		.loc 1 167 30 is_stmt 0 view .LVU391
 1327 0062 0D4B     		ldr	r3, .L102+4
 1328 0064 0022     		movs	r2, #0
 1329 0066 1A70     		strb	r2, [r3]
 1330              	.L97:
 171:Core/Src/bootloader.c ****     }
 1331              		.loc 1 171 9 is_stmt 1 view .LVU392
 1332 0068 0120     		movs	r0, #1
 1333 006a FFF7FEFF 		bl	HAL_Delay
 1334              	.LVL101:
 123:Core/Src/bootloader.c ****     {
 1335              		.loc 1 123 11 view .LVU393
 1336              	.L98:
 123:Core/Src/bootloader.c ****     {
 1337              		.loc 1 123 5 view .LVU394
 127:Core/Src/bootloader.c ****             (HAL_GetTick() - timeout_start >= BOOTLOADER_TIMEOUT_MS))
 1338              		.loc 1 127 9 view .LVU395
 127:Core/Src/bootloader.c ****             (HAL_GetTick() - timeout_start >= BOOTLOADER_TIMEOUT_MS))
 1339              		.loc 1 127 12 is_stmt 0 view .LVU396
 1340 006e 002C     		cmp	r4, #0
 1341 0070 E7D1     		bne	.L96
 127:Core/Src/bootloader.c ****             (HAL_GetTick() - timeout_start >= BOOTLOADER_TIMEOUT_MS))
 1342              		.loc 1 127 33 discriminator 1 view .LVU397
 1343 0072 0A4B     		ldr	r3, .L102+8
 1344 0074 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 127:Core/Src/bootloader.c ****             (HAL_GetTick() - timeout_start >= BOOTLOADER_TIMEOUT_MS))
 1345              		.loc 1 127 30 discriminator 1 view .LVU398
 1346 0076 002B     		cmp	r3, #0
 1347 0078 E3D1     		bne	.L96
 128:Core/Src/bootloader.c ****         {
 1348              		.loc 1 128 14 view .LVU399
 1349 007a FFF7FEFF 		bl	HAL_GetTick
 1350              	.LVL102:
 128:Core/Src/bootloader.c ****         {
 1351              		.loc 1 128 28 discriminator 1 view .LVU400
 1352 007e 401B     		subs	r0, r0, r5
 127:Core/Src/bootloader.c ****             (HAL_GetTick() - timeout_start >= BOOTLOADER_TIMEOUT_MS))
 1353              		.loc 1 127 55 discriminator 2 view .LVU401
 1354 0080 42F20F73 		movw	r3, #9999
 1355 0084 9842     		cmp	r0, r3
 1356 0086 DCD9     		bls	.L96
 130:Core/Src/bootloader.c **** 
 1357              		.loc 1 130 13 is_stmt 1 view .LVU402
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 50


 1358              	.LVL103:
 133:Core/Src/bootloader.c ****             {
 1359              		.loc 1 133 13 view .LVU403
 133:Core/Src/bootloader.c ****             {
 1360              		.loc 1 133 17 is_stmt 0 view .LVU404
 1361 0088 FFF7FEFF 		bl	Bootloader_CheckApplicationValidFlag
 1362              	.LVL104:
 133:Core/Src/bootloader.c ****             {
 1363              		.loc 1 133 16 discriminator 1 view .LVU405
 1364 008c 0028     		cmp	r0, #0
 1365 008e C6D1     		bne	.L101
 130:Core/Src/bootloader.c **** 
 1366              		.loc 1 130 29 view .LVU406
 1367 0090 0124     		movs	r4, #1
 1368 0092 D6E7     		b	.L96
 1369              	.L103:
 1370              		.align	2
 1371              	.L102:
 1372 0094 00000000 		.word	tx_data
 1373 0098 00000000 		.word	jump_to_app_flag
 1374 009c 00000000 		.word	can_command_received
 1375              		.cfi_endproc
 1376              	.LFE134:
 1378              		.section	.text.Bootloader_ClearApplicationValidFlag,"ax",%progbits
 1379              		.align	1
 1380              		.global	Bootloader_ClearApplicationValidFlag
 1381              		.syntax unified
 1382              		.thumb
 1383              		.thumb_func
 1385              	Bootloader_ClearApplicationValidFlag:
 1386              	.LFB148:
 746:Core/Src/bootloader.c **** 
 747:Core/Src/bootloader.c **** /**
 748:Core/Src/bootloader.c ****   * @brief  Clear application valid flag
 749:Core/Src/bootloader.c ****   * @retval None
 750:Core/Src/bootloader.c ****   */
 751:Core/Src/bootloader.c **** void Bootloader_ClearApplicationValidFlag(void)
 752:Core/Src/bootloader.c **** {
 1387              		.loc 1 752 1 is_stmt 1 view -0
 1388              		.cfi_startproc
 1389              		@ args = 0, pretend = 0, frame = 24
 1390              		@ frame_needed = 0, uses_anonymous_args = 0
 1391 0000 00B5     		push	{lr}
 1392              		.cfi_def_cfa_offset 4
 1393              		.cfi_offset 14, -4
 1394 0002 87B0     		sub	sp, sp, #28
 1395              		.cfi_def_cfa_offset 32
 753:Core/Src/bootloader.c ****     HAL_StatusTypeDef status;
 1396              		.loc 1 753 5 view .LVU408
 754:Core/Src/bootloader.c ****     FLASH_EraseInitTypeDef erase_init;
 1397              		.loc 1 754 5 view .LVU409
 755:Core/Src/bootloader.c ****     uint32_t page_error;
 1398              		.loc 1 755 5 view .LVU410
 756:Core/Src/bootloader.c ****     
 757:Core/Src/bootloader.c ****     /* Unlock flash */
 758:Core/Src/bootloader.c ****     HAL_FLASH_Unlock();
 1399              		.loc 1 758 5 view .LVU411
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 51


 1400 0004 FFF7FEFF 		bl	HAL_FLASH_Unlock
 1401              	.LVL105:
 759:Core/Src/bootloader.c ****     
 760:Core/Src/bootloader.c ****     /* Erase the page containing the flag */
 761:Core/Src/bootloader.c ****     erase_init.TypeErase = FLASH_TYPEERASE_PAGES;
 1402              		.loc 1 761 5 view .LVU412
 1403              		.loc 1 761 26 is_stmt 0 view .LVU413
 1404 0008 0023     		movs	r3, #0
 1405 000a 0293     		str	r3, [sp, #8]
 762:Core/Src/bootloader.c ****     erase_init.Page = 63;  /* Last page of bootloader area */
 1406              		.loc 1 762 5 is_stmt 1 view .LVU414
 1407              		.loc 1 762 21 is_stmt 0 view .LVU415
 1408 000c 3F23     		movs	r3, #63
 1409 000e 0493     		str	r3, [sp, #16]
 763:Core/Src/bootloader.c ****     erase_init.NbPages = 1;
 1410              		.loc 1 763 5 is_stmt 1 view .LVU416
 1411              		.loc 1 763 24 is_stmt 0 view .LVU417
 1412 0010 0123     		movs	r3, #1
 1413 0012 0593     		str	r3, [sp, #20]
 764:Core/Src/bootloader.c ****     
 765:Core/Src/bootloader.c ****     status = HAL_FLASHEx_Erase(&erase_init, &page_error);
 1414              		.loc 1 765 5 is_stmt 1 view .LVU418
 1415              		.loc 1 765 14 is_stmt 0 view .LVU419
 1416 0014 01A9     		add	r1, sp, #4
 1417 0016 02A8     		add	r0, sp, #8
 1418 0018 FFF7FEFF 		bl	HAL_FLASHEx_Erase
 1419              	.LVL106:
 766:Core/Src/bootloader.c ****     
 767:Core/Src/bootloader.c ****     /* Lock flash */
 768:Core/Src/bootloader.c ****     HAL_FLASH_Lock();
 1420              		.loc 1 768 5 is_stmt 1 view .LVU420
 1421 001c FFF7FEFF 		bl	HAL_FLASH_Lock
 1422              	.LVL107:
 769:Core/Src/bootloader.c **** }
 1423              		.loc 1 769 1 is_stmt 0 view .LVU421
 1424 0020 07B0     		add	sp, sp, #28
 1425              		.cfi_def_cfa_offset 4
 1426              		@ sp needed
 1427 0022 5DF804FB 		ldr	pc, [sp], #4
 1428              		.cfi_endproc
 1429              	.LFE148:
 1431              		.section	.text.Bootloader_ProcessCANMessage,"ax",%progbits
 1432              		.align	1
 1433              		.global	Bootloader_ProcessCANMessage
 1434              		.syntax unified
 1435              		.thumb
 1436              		.thumb_func
 1438              	Bootloader_ProcessCANMessage:
 1439              	.LFB135:
 180:Core/Src/bootloader.c ****     uint8_t command;
 1440              		.loc 1 180 1 is_stmt 1 view -0
 1441              		.cfi_startproc
 1442              		@ args = 0, pretend = 0, frame = 0
 1443              		@ frame_needed = 0, uses_anonymous_args = 0
 1444 0000 10B5     		push	{r4, lr}
 1445              		.cfi_def_cfa_offset 8
 1446              		.cfi_offset 4, -8
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 52


 1447              		.cfi_offset 14, -4
 181:Core/Src/bootloader.c ****     uint32_t address;
 1448              		.loc 1 181 5 view .LVU423
 182:Core/Src/bootloader.c ****     uint16_t length;
 1449              		.loc 1 182 5 view .LVU424
 183:Core/Src/bootloader.c ****     uint8_t result;
 1450              		.loc 1 183 5 view .LVU425
 184:Core/Src/bootloader.c **** 
 1451              		.loc 1 184 5 view .LVU426
 187:Core/Src/bootloader.c **** 
 1452              		.loc 1 187 5 view .LVU427
 187:Core/Src/bootloader.c **** 
 1453              		.loc 1 187 26 is_stmt 0 view .LVU428
 1454 0002 864B     		ldr	r3, .L137
 1455 0004 0122     		movs	r2, #1
 1456 0006 1A70     		strb	r2, [r3]
 190:Core/Src/bootloader.c **** 
 1457              		.loc 1 190 5 is_stmt 1 view .LVU429
 190:Core/Src/bootloader.c **** 
 1458              		.loc 1 190 13 is_stmt 0 view .LVU430
 1459 0008 854B     		ldr	r3, .L137+4
 1460 000a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1461              	.LVL108:
 192:Core/Src/bootloader.c ****     {
 1462              		.loc 1 192 5 is_stmt 1 view .LVU431
 1463 000c 013B     		subs	r3, r3, #1
 1464 000e 062B     		cmp	r3, #6
 1465 0010 00F20081 		bhi	.L107
 1466 0014 DFE813F0 		tbh	[pc, r3, lsl #1]
 1467              	.L109:
 1468 0018 1B00     		.2byte	(.L115-.L109)/2
 1469 001a 9400     		.2byte	(.L114-.L109)/2
 1470 001c BB00     		.2byte	(.L113-.L109)/2
 1471 001e EC00     		.2byte	(.L112-.L109)/2
 1472 0020 0700     		.2byte	(.L111-.L109)/2
 1473 0022 3100     		.2byte	(.L110-.L109)/2
 1474 0024 4F00     		.2byte	(.L108-.L109)/2
 1475              		.p2align 1
 1476              	.L111:
 196:Core/Src/bootloader.c ****             tx_data[1] = bootloader_status.state;
 1477              		.loc 1 196 13 view .LVU432
 196:Core/Src/bootloader.c ****             tx_data[1] = bootloader_status.state;
 1478              		.loc 1 196 24 is_stmt 0 view .LVU433
 1479 0026 7F49     		ldr	r1, .L137+8
 1480 0028 1520     		movs	r0, #21
 1481 002a 0870     		strb	r0, [r1]
 197:Core/Src/bootloader.c ****             tx_data[2] = bootloader_status.last_error;
 1482              		.loc 1 197 13 is_stmt 1 view .LVU434
 197:Core/Src/bootloader.c ****             tx_data[2] = bootloader_status.last_error;
 1483              		.loc 1 197 43 is_stmt 0 view .LVU435
 1484 002c 7E4B     		ldr	r3, .L137+12
 1485 002e 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 197:Core/Src/bootloader.c ****             tx_data[2] = bootloader_status.last_error;
 1486              		.loc 1 197 24 view .LVU436
 1487 0030 4A70     		strb	r2, [r1, #1]
 198:Core/Src/bootloader.c ****             tx_data[3] = (bootloader_status.bytes_written >> 24) & 0xFF;
 1488              		.loc 1 198 13 is_stmt 1 view .LVU437
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 53


 198:Core/Src/bootloader.c ****             tx_data[3] = (bootloader_status.bytes_written >> 24) & 0xFF;
 1489              		.loc 1 198 43 is_stmt 0 view .LVU438
 1490 0032 1A7C     		ldrb	r2, [r3, #16]	@ zero_extendqisi2
 198:Core/Src/bootloader.c ****             tx_data[3] = (bootloader_status.bytes_written >> 24) & 0xFF;
 1491              		.loc 1 198 24 view .LVU439
 1492 0034 8A70     		strb	r2, [r1, #2]
 199:Core/Src/bootloader.c ****             tx_data[4] = (bootloader_status.bytes_written >> 16) & 0xFF;
 1493              		.loc 1 199 13 is_stmt 1 view .LVU440
 199:Core/Src/bootloader.c ****             tx_data[4] = (bootloader_status.bytes_written >> 16) & 0xFF;
 1494              		.loc 1 199 44 is_stmt 0 view .LVU441
 1495 0036 9B68     		ldr	r3, [r3, #8]
 199:Core/Src/bootloader.c ****             tx_data[4] = (bootloader_status.bytes_written >> 16) & 0xFF;
 1496              		.loc 1 199 59 view .LVU442
 1497 0038 1A0E     		lsrs	r2, r3, #24
 199:Core/Src/bootloader.c ****             tx_data[4] = (bootloader_status.bytes_written >> 16) & 0xFF;
 1498              		.loc 1 199 24 view .LVU443
 1499 003a CA70     		strb	r2, [r1, #3]
 200:Core/Src/bootloader.c ****             tx_data[5] = (bootloader_status.bytes_written >> 8) & 0xFF;
 1500              		.loc 1 200 13 is_stmt 1 view .LVU444
 200:Core/Src/bootloader.c ****             tx_data[5] = (bootloader_status.bytes_written >> 8) & 0xFF;
 1501              		.loc 1 200 59 is_stmt 0 view .LVU445
 1502 003c 1A0C     		lsrs	r2, r3, #16
 200:Core/Src/bootloader.c ****             tx_data[5] = (bootloader_status.bytes_written >> 8) & 0xFF;
 1503              		.loc 1 200 24 view .LVU446
 1504 003e 0A71     		strb	r2, [r1, #4]
 201:Core/Src/bootloader.c ****             tx_data[6] = bootloader_status.bytes_written & 0xFF;
 1505              		.loc 1 201 13 is_stmt 1 view .LVU447
 201:Core/Src/bootloader.c ****             tx_data[6] = bootloader_status.bytes_written & 0xFF;
 1506              		.loc 1 201 59 is_stmt 0 view .LVU448
 1507 0040 1A0A     		lsrs	r2, r3, #8
 201:Core/Src/bootloader.c ****             tx_data[6] = bootloader_status.bytes_written & 0xFF;
 1508              		.loc 1 201 24 view .LVU449
 1509 0042 4A71     		strb	r2, [r1, #5]
 202:Core/Src/bootloader.c ****             Bootloader_SendCANMessage(RESP_DATA, tx_data, 8);
 1510              		.loc 1 202 13 is_stmt 1 view .LVU450
 202:Core/Src/bootloader.c ****             Bootloader_SendCANMessage(RESP_DATA, tx_data, 8);
 1511              		.loc 1 202 24 is_stmt 0 view .LVU451
 1512 0044 8B71     		strb	r3, [r1, #6]
 203:Core/Src/bootloader.c ****             break;
 1513              		.loc 1 203 13 is_stmt 1 view .LVU452
 1514 0046 0822     		movs	r2, #8
 1515 0048 FFF7FEFF 		bl	Bootloader_SendCANMessage
 1516              	.LVL109:
 204:Core/Src/bootloader.c ****             
 1517              		.loc 1 204 13 view .LVU453
 1518              	.L106:
 371:Core/Src/bootloader.c **** 
 1519              		.loc 1 371 1 is_stmt 0 view .LVU454
 1520 004c 10BD     		pop	{r4, pc}
 1521              	.LVL110:
 1522              	.L115:
 208:Core/Src/bootloader.c ****             
 1523              		.loc 1 208 13 is_stmt 1 view .LVU455
 208:Core/Src/bootloader.c ****             
 1524              		.loc 1 208 37 is_stmt 0 view .LVU456
 1525 004e 764B     		ldr	r3, .L137+12
 1526 0050 0122     		movs	r2, #1
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 54


 1527 0052 1A70     		strb	r2, [r3]
 211:Core/Src/bootloader.c ****             
 1528              		.loc 1 211 13 is_stmt 1 view .LVU457
 1529 0054 FFF7FEFF 		bl	Bootloader_ClearApplicationValidFlag
 1530              	.LVL111:
 213:Core/Src/bootloader.c ****             if (result == ERR_NONE)
 1531              		.loc 1 213 13 view .LVU458
 213:Core/Src/bootloader.c ****             if (result == ERR_NONE)
 1532              		.loc 1 213 22 is_stmt 0 view .LVU459
 1533 0058 FFF7FEFF 		bl	Bootloader_EraseApplicationFlash
 1534              	.LVL112:
 214:Core/Src/bootloader.c ****             {
 1535              		.loc 1 214 13 is_stmt 1 view .LVU460
 214:Core/Src/bootloader.c ****             {
 1536              		.loc 1 214 16 is_stmt 0 view .LVU461
 1537 005c 50B9     		cbnz	r0, .L117
 216:Core/Src/bootloader.c ****                 bootloader_status.current_address = APPLICATION_ADDRESS;
 1538              		.loc 1 216 17 is_stmt 1 view .LVU462
 216:Core/Src/bootloader.c ****                 bootloader_status.current_address = APPLICATION_ADDRESS;
 1539              		.loc 1 216 49 is_stmt 0 view .LVU463
 1540 005e 724B     		ldr	r3, .L137+12
 1541 0060 0022     		movs	r2, #0
 1542 0062 9A60     		str	r2, [r3, #8]
 217:Core/Src/bootloader.c ****                 Bootloader_SendACK();
 1543              		.loc 1 217 17 is_stmt 1 view .LVU464
 217:Core/Src/bootloader.c ****                 Bootloader_SendACK();
 1544              		.loc 1 217 51 is_stmt 0 view .LVU465
 1545 0064 714A     		ldr	r2, .L137+16
 1546 0066 5A60     		str	r2, [r3, #4]
 218:Core/Src/bootloader.c ****             }
 1547              		.loc 1 218 17 is_stmt 1 view .LVU466
 1548 0068 FFF7FEFF 		bl	Bootloader_SendACK
 1549              	.LVL113:
 1550              	.L118:
 224:Core/Src/bootloader.c ****             break;
 1551              		.loc 1 224 13 view .LVU467
 224:Core/Src/bootloader.c ****             break;
 1552              		.loc 1 224 37 is_stmt 0 view .LVU468
 1553 006c 6E4B     		ldr	r3, .L137+12
 1554 006e 0022     		movs	r2, #0
 1555 0070 1A70     		strb	r2, [r3]
 225:Core/Src/bootloader.c ****             
 1556              		.loc 1 225 13 is_stmt 1 view .LVU469
 1557 0072 EBE7     		b	.L106
 1558              	.LVL114:
 1559              	.L117:
 222:Core/Src/bootloader.c ****             }
 1560              		.loc 1 222 17 view .LVU470
 1561 0074 FFF7FEFF 		bl	Bootloader_SendNACK
 1562              	.LVL115:
 222:Core/Src/bootloader.c ****             }
 1563              		.loc 1 222 17 is_stmt 0 view .LVU471
 1564 0078 F8E7     		b	.L118
 1565              	.LVL116:
 1566              	.L110:
 229:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 1567              		.loc 1 229 13 is_stmt 1 view .LVU472
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 55


 229:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 1568              		.loc 1 229 31 is_stmt 0 view .LVU473
 1569 007a 694A     		ldr	r2, .L137+4
 229:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 1570              		.loc 1 229 31 view .LVU474
 1571 007c 5178     		ldrb	r1, [r2, #1]	@ zero_extendqisi2
 229:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 1572              		.loc 1 229 52 view .LVU475
 1573 007e 9378     		ldrb	r3, [r2, #2]	@ zero_extendqisi2
 229:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 1574              		.loc 1 229 56 view .LVU476
 1575 0080 1B04     		lsls	r3, r3, #16
 229:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 1576              		.loc 1 229 42 view .LVU477
 1577 0082 43EA0163 		orr	r3, r3, r1, lsl #24
 230:Core/Src/bootloader.c ****             
 1578              		.loc 1 230 30 view .LVU478
 1579 0086 D178     		ldrb	r1, [r2, #3]	@ zero_extendqisi2
 229:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 1580              		.loc 1 229 63 view .LVU479
 1581 0088 43EA0123 		orr	r3, r3, r1, lsl #8
 230:Core/Src/bootloader.c ****             
 1582              		.loc 1 230 49 view .LVU480
 1583 008c 1279     		ldrb	r2, [r2, #4]	@ zero_extendqisi2
 230:Core/Src/bootloader.c ****             
 1584              		.loc 1 230 40 view .LVU481
 1585 008e 1343     		orrs	r3, r3, r2
 1586              	.LVL117:
 233:Core/Src/bootloader.c ****             {
 1587              		.loc 1 233 13 is_stmt 1 view .LVU482
 233:Core/Src/bootloader.c ****             {
 1588              		.loc 1 233 48 is_stmt 0 view .LVU483
 1589 0090 03F17842 		add	r2, r3, #-134217728
 1590 0094 A2F50042 		sub	r2, r2, #32768
 233:Core/Src/bootloader.c ****             {
 1591              		.loc 1 233 16 view .LVU484
 1592 0098 B2F5603F 		cmp	r2, #229376
 1593 009c 07D2     		bcs	.L119
 235:Core/Src/bootloader.c ****                 buffer_index = 0;  /* Reset buffer */
 1594              		.loc 1 235 17 is_stmt 1 view .LVU485
 235:Core/Src/bootloader.c ****                 buffer_index = 0;  /* Reset buffer */
 1595              		.loc 1 235 51 is_stmt 0 view .LVU486
 1596 009e 624A     		ldr	r2, .L137+12
 1597 00a0 5360     		str	r3, [r2, #4]
 236:Core/Src/bootloader.c ****                 Bootloader_SendACK();
 1598              		.loc 1 236 17 is_stmt 1 view .LVU487
 236:Core/Src/bootloader.c ****                 Bootloader_SendACK();
 1599              		.loc 1 236 30 is_stmt 0 view .LVU488
 1600 00a2 634B     		ldr	r3, .L137+20
 1601              	.LVL118:
 236:Core/Src/bootloader.c ****                 Bootloader_SendACK();
 1602              		.loc 1 236 30 view .LVU489
 1603 00a4 0022     		movs	r2, #0
 236:Core/Src/bootloader.c ****                 Bootloader_SendACK();
 1604              		.loc 1 236 30 view .LVU490
 1605 00a6 1A80     		strh	r2, [r3]	@ movhi
 237:Core/Src/bootloader.c ****             }
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 56


 1606              		.loc 1 237 17 is_stmt 1 view .LVU491
 1607 00a8 FFF7FEFF 		bl	Bootloader_SendACK
 1608              	.LVL119:
 237:Core/Src/bootloader.c ****             }
 1609              		.loc 1 237 17 is_stmt 0 view .LVU492
 1610 00ac CEE7     		b	.L106
 1611              	.LVL120:
 1612              	.L119:
 241:Core/Src/bootloader.c ****             }
 1613              		.loc 1 241 17 is_stmt 1 view .LVU493
 1614 00ae 0220     		movs	r0, #2
 1615 00b0 FFF7FEFF 		bl	Bootloader_SendNACK
 1616              	.LVL121:
 241:Core/Src/bootloader.c ****             }
 1617              		.loc 1 241 17 is_stmt 0 view .LVU494
 1618 00b4 CAE7     		b	.L106
 1619              	.LVL122:
 1620              	.L108:
 249:Core/Src/bootloader.c ****             length = rx_data[1];  /* Data length - should always be 4 */
 1621              		.loc 1 249 13 is_stmt 1 view .LVU495
 249:Core/Src/bootloader.c ****             length = rx_data[1];  /* Data length - should always be 4 */
 1622              		.loc 1 249 37 is_stmt 0 view .LVU496
 1623 00b6 5C4B     		ldr	r3, .L137+12
 1624 00b8 0222     		movs	r2, #2
 1625 00ba 1A70     		strb	r2, [r3]
 250:Core/Src/bootloader.c ****             
 1626              		.loc 1 250 13 is_stmt 1 view .LVU497
 250:Core/Src/bootloader.c ****             
 1627              		.loc 1 250 29 is_stmt 0 view .LVU498
 1628 00bc 584B     		ldr	r3, .L137+4
 250:Core/Src/bootloader.c ****             
 1629              		.loc 1 250 29 view .LVU499
 1630 00be 5B78     		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 1631              	.LVL123:
 252:Core/Src/bootloader.c ****             {
 1632              		.loc 1 252 13 is_stmt 1 view .LVU500
 252:Core/Src/bootloader.c ****             {
 1633              		.loc 1 252 16 is_stmt 0 view .LVU501
 1634 00c0 042B     		cmp	r3, #4
 1635 00c2 01D1     		bne	.L135
 1636              	.LBB10:
 261:Core/Src/bootloader.c ****             {
 1637              		.loc 1 261 26 view .LVU502
 1638 00c4 0023     		movs	r3, #0
 1639 00c6 15E0     		b	.L120
 1640              	.L135:
 1641              	.LBE10:
 254:Core/Src/bootloader.c ****                 bootloader_status.state = BL_STATE_IDLE;
 1642              		.loc 1 254 17 is_stmt 1 view .LVU503
 1643 00c8 0520     		movs	r0, #5
 1644 00ca FFF7FEFF 		bl	Bootloader_SendNACK
 1645              	.LVL124:
 255:Core/Src/bootloader.c ****                 buffer_index = 0;  /* Reset buffer on error */
 1646              		.loc 1 255 17 view .LVU504
 255:Core/Src/bootloader.c ****                 buffer_index = 0;  /* Reset buffer on error */
 1647              		.loc 1 255 41 is_stmt 0 view .LVU505
 1648 00ce 0023     		movs	r3, #0
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 57


 1649 00d0 554A     		ldr	r2, .L137+12
 1650 00d2 1370     		strb	r3, [r2]
 256:Core/Src/bootloader.c ****                 break;
 1651              		.loc 1 256 17 is_stmt 1 view .LVU506
 256:Core/Src/bootloader.c ****                 break;
 1652              		.loc 1 256 30 is_stmt 0 view .LVU507
 1653 00d4 564A     		ldr	r2, .L137+20
 1654 00d6 1380     		strh	r3, [r2]	@ movhi
 257:Core/Src/bootloader.c ****             }
 1655              		.loc 1 257 17 is_stmt 1 view .LVU508
 1656 00d8 B8E7     		b	.L106
 1657              	.LVL125:
 1658              	.L121:
 1659              	.LBB11:
 263:Core/Src/bootloader.c ****             }
 1660              		.loc 1 263 17 view .LVU509
 263:Core/Src/bootloader.c ****             }
 1661              		.loc 1 263 58 is_stmt 0 view .LVU510
 1662 00da 981C     		adds	r0, r3, #2
 263:Core/Src/bootloader.c ****             }
 1663              		.loc 1 263 42 view .LVU511
 1664 00dc 5449     		ldr	r1, .L137+20
 1665 00de 0A88     		ldrh	r2, [r1]
 1666 00e0 02F1010C 		add	ip, r2, #1
 1667 00e4 A1F800C0 		strh	ip, [r1]	@ movhi
 263:Core/Src/bootloader.c ****             }
 1668              		.loc 1 263 55 view .LVU512
 1669 00e8 4D49     		ldr	r1, .L137+4
 263:Core/Src/bootloader.c ****             }
 1670              		.loc 1 263 55 view .LVU513
 1671 00ea 085C     		ldrb	r0, [r1, r0]	@ zero_extendqisi2
 263:Core/Src/bootloader.c ****             }
 1672              		.loc 1 263 46 view .LVU514
 1673 00ec 5149     		ldr	r1, .L137+24
 263:Core/Src/bootloader.c ****             }
 1674              		.loc 1 263 46 view .LVU515
 1675 00ee 8854     		strb	r0, [r1, r2]
 261:Core/Src/bootloader.c ****             {
 1676              		.loc 1 261 41 is_stmt 1 discriminator 3 view .LVU516
 1677 00f0 0133     		adds	r3, r3, #1
 1678              	.LVL126:
 261:Core/Src/bootloader.c ****             {
 1679              		.loc 1 261 41 is_stmt 0 discriminator 3 view .LVU517
 1680 00f2 DBB2     		uxtb	r3, r3
 1681              	.LVL127:
 1682              	.L120:
 261:Core/Src/bootloader.c ****             {
 1683              		.loc 1 261 35 is_stmt 1 discriminator 1 view .LVU518
 1684 00f4 032B     		cmp	r3, #3
 1685 00f6 F0D9     		bls	.L121
 1686              	.LBE11:
 267:Core/Src/bootloader.c ****             {
 1687              		.loc 1 267 13 view .LVU519
 267:Core/Src/bootloader.c ****             {
 1688              		.loc 1 267 30 is_stmt 0 view .LVU520
 1689 00f8 4D4B     		ldr	r3, .L137+20
 1690              	.LVL128:
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 58


 267:Core/Src/bootloader.c ****             {
 1691              		.loc 1 267 30 view .LVU521
 1692 00fa 1B88     		ldrh	r3, [r3]
 267:Core/Src/bootloader.c ****             {
 1693              		.loc 1 267 16 view .LVU522
 1694 00fc 072B     		cmp	r3, #7
 1695 00fe 19D9     		bls	.L122
 269:Core/Src/bootloader.c ****                                                flash_buffer, 8);
 1696              		.loc 1 269 17 is_stmt 1 view .LVU523
 269:Core/Src/bootloader.c ****                                                flash_buffer, 8);
 1697              		.loc 1 269 26 is_stmt 0 view .LVU524
 1698 0100 0822     		movs	r2, #8
 1699 0102 4C49     		ldr	r1, .L137+24
 1700 0104 484B     		ldr	r3, .L137+12
 1701 0106 5868     		ldr	r0, [r3, #4]
 1702 0108 FFF7FEFF 		bl	Bootloader_WriteFlash
 1703              	.LVL129:
 271:Core/Src/bootloader.c ****                 {
 1704              		.loc 1 271 17 is_stmt 1 view .LVU525
 271:Core/Src/bootloader.c ****                 {
 1705              		.loc 1 271 20 is_stmt 0 view .LVU526
 1706 010c 60B9     		cbnz	r0, .L123
 273:Core/Src/bootloader.c ****                     bootloader_status.bytes_written += 8;
 1707              		.loc 1 273 21 is_stmt 1 view .LVU527
 273:Core/Src/bootloader.c ****                     bootloader_status.bytes_written += 8;
 1708              		.loc 1 273 38 is_stmt 0 view .LVU528
 1709 010e 464B     		ldr	r3, .L137+12
 1710 0110 5A68     		ldr	r2, [r3, #4]
 273:Core/Src/bootloader.c ****                     bootloader_status.bytes_written += 8;
 1711              		.loc 1 273 55 view .LVU529
 1712 0112 0832     		adds	r2, r2, #8
 1713 0114 5A60     		str	r2, [r3, #4]
 274:Core/Src/bootloader.c ****                     buffer_index = 0;
 1714              		.loc 1 274 21 is_stmt 1 view .LVU530
 274:Core/Src/bootloader.c ****                     buffer_index = 0;
 1715              		.loc 1 274 38 is_stmt 0 view .LVU531
 1716 0116 9A68     		ldr	r2, [r3, #8]
 274:Core/Src/bootloader.c ****                     buffer_index = 0;
 1717              		.loc 1 274 53 view .LVU532
 1718 0118 0832     		adds	r2, r2, #8
 1719 011a 9A60     		str	r2, [r3, #8]
 275:Core/Src/bootloader.c ****                     Bootloader_SendACK();
 1720              		.loc 1 275 21 is_stmt 1 view .LVU533
 275:Core/Src/bootloader.c ****                     Bootloader_SendACK();
 1721              		.loc 1 275 34 is_stmt 0 view .LVU534
 1722 011c 444B     		ldr	r3, .L137+20
 1723 011e 0022     		movs	r2, #0
 1724 0120 1A80     		strh	r2, [r3]	@ movhi
 276:Core/Src/bootloader.c ****                 }
 1725              		.loc 1 276 21 is_stmt 1 view .LVU535
 1726 0122 FFF7FEFF 		bl	Bootloader_SendACK
 1727              	.LVL130:
 276:Core/Src/bootloader.c ****                 }
 1728              		.loc 1 276 21 is_stmt 0 view .LVU536
 1729 0126 07E0     		b	.L124
 1730              	.LVL131:
 1731              	.L123:
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 59


 280:Core/Src/bootloader.c ****                     Bootloader_SendNACK(result);
 1732              		.loc 1 280 21 is_stmt 1 view .LVU537
 280:Core/Src/bootloader.c ****                     Bootloader_SendNACK(result);
 1733              		.loc 1 280 34 is_stmt 0 view .LVU538
 1734 0128 414A     		ldr	r2, .L137+20
 1735 012a 0021     		movs	r1, #0
 1736 012c 1180     		strh	r1, [r2]	@ movhi
 281:Core/Src/bootloader.c ****                 }
 1737              		.loc 1 281 21 is_stmt 1 view .LVU539
 1738 012e FFF7FEFF 		bl	Bootloader_SendNACK
 1739              	.LVL132:
 281:Core/Src/bootloader.c ****                 }
 1740              		.loc 1 281 21 is_stmt 0 view .LVU540
 1741 0132 01E0     		b	.L124
 1742              	.LVL133:
 1743              	.L122:
 286:Core/Src/bootloader.c ****             }
 1744              		.loc 1 286 17 is_stmt 1 view .LVU541
 1745 0134 FFF7FEFF 		bl	Bootloader_SendACK
 1746              	.LVL134:
 1747              	.L124:
 289:Core/Src/bootloader.c ****             break;
 1748              		.loc 1 289 13 view .LVU542
 289:Core/Src/bootloader.c ****             break;
 1749              		.loc 1 289 37 is_stmt 0 view .LVU543
 1750 0138 3B4B     		ldr	r3, .L137+12
 1751 013a 0022     		movs	r2, #0
 1752 013c 1A70     		strb	r2, [r3]
 290:Core/Src/bootloader.c ****             
 1753              		.loc 1 290 13 is_stmt 1 view .LVU544
 1754 013e 85E7     		b	.L106
 1755              	.LVL135:
 1756              	.L114:
 294:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 1757              		.loc 1 294 13 view .LVU545
 294:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 1758              		.loc 1 294 31 is_stmt 0 view .LVU546
 1759 0140 374B     		ldr	r3, .L137+4
 294:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 1760              		.loc 1 294 31 view .LVU547
 1761 0142 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 294:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 1762              		.loc 1 294 52 view .LVU548
 1763 0144 9878     		ldrb	r0, [r3, #2]	@ zero_extendqisi2
 294:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 1764              		.loc 1 294 56 view .LVU549
 1765 0146 0004     		lsls	r0, r0, #16
 294:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 1766              		.loc 1 294 42 view .LVU550
 1767 0148 40EA0260 		orr	r0, r0, r2, lsl #24
 295:Core/Src/bootloader.c ****             length = rx_data[5];
 1768              		.loc 1 295 30 view .LVU551
 1769 014c DA78     		ldrb	r2, [r3, #3]	@ zero_extendqisi2
 294:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 1770              		.loc 1 294 63 view .LVU552
 1771 014e 40EA0220 		orr	r0, r0, r2, lsl #8
 295:Core/Src/bootloader.c ****             length = rx_data[5];
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 60


 1772              		.loc 1 295 49 view .LVU553
 1773 0152 1A79     		ldrb	r2, [r3, #4]	@ zero_extendqisi2
 295:Core/Src/bootloader.c ****             length = rx_data[5];
 1774              		.loc 1 295 40 view .LVU554
 1775 0154 1043     		orrs	r0, r0, r2
 1776              	.LVL136:
 296:Core/Src/bootloader.c ****             
 1777              		.loc 1 296 13 is_stmt 1 view .LVU555
 296:Core/Src/bootloader.c ****             
 1778              		.loc 1 296 29 is_stmt 0 view .LVU556
 1779 0156 5A79     		ldrb	r2, [r3, #5]	@ zero_extendqisi2
 1780              	.LVL137:
 298:Core/Src/bootloader.c ****             {
 1781              		.loc 1 298 13 is_stmt 1 view .LVU557
 298:Core/Src/bootloader.c ****             {
 1782              		.loc 1 298 48 is_stmt 0 view .LVU558
 1783 0158 00F17843 		add	r3, r0, #-134217728
 298:Core/Src/bootloader.c ****             {
 1784              		.loc 1 298 48 view .LVU559
 1785 015c A3F50043 		sub	r3, r3, #32768
 298:Core/Src/bootloader.c ****             {
 1786              		.loc 1 298 16 view .LVU560
 1787 0160 B3F5603F 		cmp	r3, #229376
 1788 0164 0FD2     		bcs	.L125
 300:Core/Src/bootloader.c ****                 result = Bootloader_WriteFlash(address, &rx_data[6], length);
 1789              		.loc 1 300 17 is_stmt 1 view .LVU561
 300:Core/Src/bootloader.c ****                 result = Bootloader_WriteFlash(address, &rx_data[6], length);
 1790              		.loc 1 300 41 is_stmt 0 view .LVU562
 1791 0166 304B     		ldr	r3, .L137+12
 1792 0168 0221     		movs	r1, #2
 1793 016a 1970     		strb	r1, [r3]
 301:Core/Src/bootloader.c ****                 if (result == ERR_NONE)
 1794              		.loc 1 301 17 is_stmt 1 view .LVU563
 301:Core/Src/bootloader.c ****                 if (result == ERR_NONE)
 1795              		.loc 1 301 26 is_stmt 0 view .LVU564
 1796 016c 3249     		ldr	r1, .L137+28
 1797 016e FFF7FEFF 		bl	Bootloader_WriteFlash
 1798              	.LVL138:
 302:Core/Src/bootloader.c ****                 {
 1799              		.loc 1 302 17 is_stmt 1 view .LVU565
 302:Core/Src/bootloader.c ****                 {
 1800              		.loc 1 302 20 is_stmt 0 view .LVU566
 1801 0172 28B9     		cbnz	r0, .L126
 304:Core/Src/bootloader.c ****                 }
 1802              		.loc 1 304 21 is_stmt 1 view .LVU567
 1803 0174 FFF7FEFF 		bl	Bootloader_SendACK
 1804              	.LVL139:
 1805              	.L127:
 310:Core/Src/bootloader.c ****             }
 1806              		.loc 1 310 17 view .LVU568
 310:Core/Src/bootloader.c ****             }
 1807              		.loc 1 310 41 is_stmt 0 view .LVU569
 1808 0178 2B4B     		ldr	r3, .L137+12
 1809 017a 0022     		movs	r2, #0
 1810 017c 1A70     		strb	r2, [r3]
 1811 017e 65E7     		b	.L106
 1812              	.LVL140:
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 61


 1813              	.L126:
 308:Core/Src/bootloader.c ****                 }
 1814              		.loc 1 308 21 is_stmt 1 view .LVU570
 1815 0180 FFF7FEFF 		bl	Bootloader_SendNACK
 1816              	.LVL141:
 308:Core/Src/bootloader.c ****                 }
 1817              		.loc 1 308 21 is_stmt 0 view .LVU571
 1818 0184 F8E7     		b	.L127
 1819              	.LVL142:
 1820              	.L125:
 314:Core/Src/bootloader.c ****             }
 1821              		.loc 1 314 17 is_stmt 1 view .LVU572
 1822 0186 0220     		movs	r0, #2
 1823              	.LVL143:
 314:Core/Src/bootloader.c ****             }
 1824              		.loc 1 314 17 is_stmt 0 view .LVU573
 1825 0188 FFF7FEFF 		bl	Bootloader_SendNACK
 1826              	.LVL144:
 314:Core/Src/bootloader.c ****             }
 1827              		.loc 1 314 17 view .LVU574
 1828 018c 5EE7     		b	.L106
 1829              	.LVL145:
 1830              	.L113:
 320:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 1831              		.loc 1 320 13 is_stmt 1 view .LVU575
 320:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 1832              		.loc 1 320 31 is_stmt 0 view .LVU576
 1833 018e 244B     		ldr	r3, .L137+4
 320:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 1834              		.loc 1 320 31 view .LVU577
 1835 0190 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 320:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 1836              		.loc 1 320 52 view .LVU578
 1837 0192 9878     		ldrb	r0, [r3, #2]	@ zero_extendqisi2
 320:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 1838              		.loc 1 320 56 view .LVU579
 1839 0194 0004     		lsls	r0, r0, #16
 320:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 1840              		.loc 1 320 42 view .LVU580
 1841 0196 40EA0260 		orr	r0, r0, r2, lsl #24
 321:Core/Src/bootloader.c ****             length = rx_data[5];
 1842              		.loc 1 321 30 view .LVU581
 1843 019a DA78     		ldrb	r2, [r3, #3]	@ zero_extendqisi2
 320:Core/Src/bootloader.c ****                      (rx_data[3] << 8) | rx_data[4];
 1844              		.loc 1 320 63 view .LVU582
 1845 019c 40EA0220 		orr	r0, r0, r2, lsl #8
 321:Core/Src/bootloader.c ****             length = rx_data[5];
 1846              		.loc 1 321 49 view .LVU583
 1847 01a0 1A79     		ldrb	r2, [r3, #4]	@ zero_extendqisi2
 321:Core/Src/bootloader.c ****             length = rx_data[5];
 1848              		.loc 1 321 40 view .LVU584
 1849 01a2 1043     		orrs	r0, r0, r2
 1850              	.LVL146:
 322:Core/Src/bootloader.c ****             
 1851              		.loc 1 322 13 is_stmt 1 view .LVU585
 322:Core/Src/bootloader.c ****             
 1852              		.loc 1 322 29 is_stmt 0 view .LVU586
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 62


 1853 01a4 5C79     		ldrb	r4, [r3, #5]	@ zero_extendqisi2
 1854              	.LVL147:
 324:Core/Src/bootloader.c ****             {
 1855              		.loc 1 324 13 is_stmt 1 view .LVU587
 324:Core/Src/bootloader.c ****             {
 1856              		.loc 1 324 48 is_stmt 0 view .LVU588
 1857 01a6 00F17843 		add	r3, r0, #-134217728
 324:Core/Src/bootloader.c ****             {
 1858              		.loc 1 324 48 view .LVU589
 1859 01aa A3F50043 		sub	r3, r3, #32768
 324:Core/Src/bootloader.c ****             {
 1860              		.loc 1 324 16 view .LVU590
 1861 01ae B3F5603F 		cmp	r3, #229376
 1862 01b2 01D2     		bcs	.L128
 324:Core/Src/bootloader.c ****             {
 1863              		.loc 1 324 80 discriminator 1 view .LVU591
 1864 01b4 072C     		cmp	r4, #7
 1865 01b6 03D9     		bls	.L136
 1866              	.L128:
 341:Core/Src/bootloader.c ****             }
 1867              		.loc 1 341 17 is_stmt 1 view .LVU592
 1868 01b8 0220     		movs	r0, #2
 1869              	.LVL148:
 341:Core/Src/bootloader.c ****             }
 1870              		.loc 1 341 17 is_stmt 0 view .LVU593
 1871 01ba FFF7FEFF 		bl	Bootloader_SendNACK
 1872              	.LVL149:
 341:Core/Src/bootloader.c ****             }
 1873              		.loc 1 341 17 view .LVU594
 1874 01be 45E7     		b	.L106
 1875              	.LVL150:
 1876              	.L136:
 326:Core/Src/bootloader.c ****                 tx_data[0] = RESP_DATA;
 1877              		.loc 1 326 17 is_stmt 1 view .LVU595
 326:Core/Src/bootloader.c ****                 tx_data[0] = RESP_DATA;
 1878              		.loc 1 326 41 is_stmt 0 view .LVU596
 1879 01c0 194B     		ldr	r3, .L137+12
 1880 01c2 0322     		movs	r2, #3
 1881 01c4 1A70     		strb	r2, [r3]
 327:Core/Src/bootloader.c ****                 result = Bootloader_ReadFlash(address, &tx_data[1], length);
 1882              		.loc 1 327 17 is_stmt 1 view .LVU597
 327:Core/Src/bootloader.c ****                 result = Bootloader_ReadFlash(address, &tx_data[1], length);
 1883              		.loc 1 327 28 is_stmt 0 view .LVU598
 1884 01c6 1749     		ldr	r1, .L137+8
 1885 01c8 1523     		movs	r3, #21
 1886 01ca 01F8013B 		strb	r3, [r1], #1
 328:Core/Src/bootloader.c ****                 if (result == ERR_NONE)
 1887              		.loc 1 328 17 is_stmt 1 view .LVU599
 328:Core/Src/bootloader.c ****                 if (result == ERR_NONE)
 1888              		.loc 1 328 26 is_stmt 0 view .LVU600
 1889 01ce 2246     		mov	r2, r4
 1890 01d0 FFF7FEFF 		bl	Bootloader_ReadFlash
 1891              	.LVL151:
 329:Core/Src/bootloader.c ****                 {
 1892              		.loc 1 329 17 is_stmt 1 view .LVU601
 329:Core/Src/bootloader.c ****                 {
 1893              		.loc 1 329 20 is_stmt 0 view .LVU602
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 63


 1894 01d4 48B9     		cbnz	r0, .L129
 331:Core/Src/bootloader.c ****                 }
 1895              		.loc 1 331 21 is_stmt 1 view .LVU603
 1896 01d6 621C     		adds	r2, r4, #1
 1897 01d8 D2B2     		uxtb	r2, r2
 1898 01da 1249     		ldr	r1, .L137+8
 1899 01dc 1520     		movs	r0, #21
 1900              	.LVL152:
 331:Core/Src/bootloader.c ****                 }
 1901              		.loc 1 331 21 is_stmt 0 view .LVU604
 1902 01de FFF7FEFF 		bl	Bootloader_SendCANMessage
 1903              	.LVL153:
 1904              	.L130:
 337:Core/Src/bootloader.c ****             }
 1905              		.loc 1 337 17 is_stmt 1 view .LVU605
 337:Core/Src/bootloader.c ****             }
 1906              		.loc 1 337 41 is_stmt 0 view .LVU606
 1907 01e2 114B     		ldr	r3, .L137+12
 1908 01e4 0022     		movs	r2, #0
 1909 01e6 1A70     		strb	r2, [r3]
 1910 01e8 30E7     		b	.L106
 1911              	.LVL154:
 1912              	.L129:
 335:Core/Src/bootloader.c ****                 }
 1913              		.loc 1 335 21 is_stmt 1 view .LVU607
 1914 01ea FFF7FEFF 		bl	Bootloader_SendNACK
 1915              	.LVL155:
 335:Core/Src/bootloader.c ****                 }
 1916              		.loc 1 335 21 is_stmt 0 view .LVU608
 1917 01ee F8E7     		b	.L130
 1918              	.LVL156:
 1919              	.L112:
 347:Core/Src/bootloader.c ****             {
 1920              		.loc 1 347 13 is_stmt 1 view .LVU609
 347:Core/Src/bootloader.c ****             {
 1921              		.loc 1 347 17 is_stmt 0 view .LVU610
 1922 01f0 FFF7FEFF 		bl	Bootloader_CheckValidApplication
 1923              	.LVL157:
 347:Core/Src/bootloader.c ****             {
 1924              		.loc 1 347 16 discriminator 1 view .LVU611
 1925 01f4 50B1     		cbz	r0, .L131
 350:Core/Src/bootloader.c ****                 if (result != ERR_NONE)
 1926              		.loc 1 350 17 is_stmt 1 view .LVU612
 350:Core/Src/bootloader.c ****                 if (result != ERR_NONE)
 1927              		.loc 1 350 26 is_stmt 0 view .LVU613
 1928 01f6 FFF7FEFF 		bl	Bootloader_SetApplicationValidFlag
 1929              	.LVL158:
 351:Core/Src/bootloader.c ****                 {
 1930              		.loc 1 351 17 is_stmt 1 view .LVU614
 351:Core/Src/bootloader.c ****                 {
 1931              		.loc 1 351 20 is_stmt 0 view .LVU615
 1932 01fa 08B1     		cbz	r0, .L132
 354:Core/Src/bootloader.c ****                 }
 1933              		.loc 1 354 21 is_stmt 1 view .LVU616
 354:Core/Src/bootloader.c ****                 }
 1934              		.loc 1 354 50 is_stmt 0 view .LVU617
 1935 01fc 0A4A     		ldr	r2, .L137+12
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 64


 1936 01fe 1074     		strb	r0, [r2, #16]
 1937              	.L132:
 357:Core/Src/bootloader.c ****                 jump_to_app_flag = 1;  /* Set flag to trigger jump from main loop */
 1938              		.loc 1 357 17 is_stmt 1 view .LVU618
 1939 0200 FFF7FEFF 		bl	Bootloader_SendACK
 1940              	.LVL159:
 358:Core/Src/bootloader.c ****             }
 1941              		.loc 1 358 17 view .LVU619
 358:Core/Src/bootloader.c ****             }
 1942              		.loc 1 358 34 is_stmt 0 view .LVU620
 1943 0204 0D4B     		ldr	r3, .L137+32
 1944 0206 0122     		movs	r2, #1
 1945 0208 1A70     		strb	r2, [r3]
 1946 020a 1FE7     		b	.L106
 1947              	.LVL160:
 1948              	.L131:
 362:Core/Src/bootloader.c ****             }
 1949              		.loc 1 362 17 is_stmt 1 view .LVU621
 1950 020c 0620     		movs	r0, #6
 1951 020e FFF7FEFF 		bl	Bootloader_SendNACK
 1952              	.LVL161:
 1953 0212 1BE7     		b	.L106
 1954              	.LVL162:
 1955              	.L107:
 368:Core/Src/bootloader.c ****             break;
 1956              		.loc 1 368 13 view .LVU622
 1957 0214 0120     		movs	r0, #1
 1958 0216 FFF7FEFF 		bl	Bootloader_SendNACK
 1959              	.LVL163:
 369:Core/Src/bootloader.c ****     }
 1960              		.loc 1 369 13 view .LVU623
 371:Core/Src/bootloader.c **** 
 1961              		.loc 1 371 1 is_stmt 0 view .LVU624
 1962 021a 17E7     		b	.L106
 1963              	.L138:
 1964              		.align	2
 1965              	.L137:
 1966 021c 00000000 		.word	can_command_received
 1967 0220 00000000 		.word	rx_data
 1968 0224 00000000 		.word	tx_data
 1969 0228 00000000 		.word	bootloader_status
 1970 022c 00800008 		.word	134250496
 1971 0230 00000000 		.word	buffer_index
 1972 0234 00000000 		.word	flash_buffer
 1973 0238 06000000 		.word	rx_data+6
 1974 023c 00000000 		.word	jump_to_app_flag
 1975              		.cfi_endproc
 1976              	.LFE135:
 1978              		.section	.text.HAL_CAN_RxFifo0MsgPendingCallback,"ax",%progbits
 1979              		.align	1
 1980              		.global	HAL_CAN_RxFifo0MsgPendingCallback
 1981              		.syntax unified
 1982              		.thumb
 1983              		.thumb_func
 1985              	HAL_CAN_RxFifo0MsgPendingCallback:
 1986              	.LVL164:
 1987              	.LFB149:
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 65


 770:Core/Src/bootloader.c **** 
 771:Core/Src/bootloader.c **** /**
 772:Core/Src/bootloader.c ****   * @brief  CAN RX FIFO 0 message pending callback
 773:Core/Src/bootloader.c ****   * @param  hcan: pointer to CAN Handle
 774:Core/Src/bootloader.c ****   * @retval None
 775:Core/Src/bootloader.c ****   */
 776:Core/Src/bootloader.c **** void HAL_CAN_RxFifo0MsgPendingCallback(CAN_HandleTypeDef *hcan)
 777:Core/Src/bootloader.c **** {
 1988              		.loc 1 777 1 is_stmt 1 view -0
 1989              		.cfi_startproc
 1990              		@ args = 0, pretend = 0, frame = 0
 1991              		@ frame_needed = 0, uses_anonymous_args = 0
 1992              		.loc 1 777 1 is_stmt 0 view .LVU626
 1993 0000 08B5     		push	{r3, lr}
 1994              		.cfi_def_cfa_offset 8
 1995              		.cfi_offset 3, -8
 1996              		.cfi_offset 14, -4
 778:Core/Src/bootloader.c ****     if (hcan == hcan_bootloader)
 1997              		.loc 1 778 5 is_stmt 1 view .LVU627
 1998              		.loc 1 778 14 is_stmt 0 view .LVU628
 1999 0002 0A4B     		ldr	r3, .L143
 2000 0004 1B68     		ldr	r3, [r3]
 2001              		.loc 1 778 8 view .LVU629
 2002 0006 8342     		cmp	r3, r0
 2003 0008 00D0     		beq	.L142
 2004              	.LVL165:
 2005              	.L139:
 779:Core/Src/bootloader.c ****     {
 780:Core/Src/bootloader.c ****         /* Get message from FIFO */
 781:Core/Src/bootloader.c ****         if (HAL_CAN_GetRxMessage(hcan, CAN_RX_FIFO0, &rx_header, rx_data) == HAL_OK)
 782:Core/Src/bootloader.c ****         {
 783:Core/Src/bootloader.c ****             /* Check if message is for bootloader */
 784:Core/Src/bootloader.c ****             if (rx_header.StdId == CAN_HOST_ID)
 785:Core/Src/bootloader.c ****             {
 786:Core/Src/bootloader.c ****                 /* Process the message */
 787:Core/Src/bootloader.c ****                 Bootloader_ProcessCANMessage();
 788:Core/Src/bootloader.c ****             }
 789:Core/Src/bootloader.c ****         }
 790:Core/Src/bootloader.c ****     }
 791:Core/Src/bootloader.c **** }
 2006              		.loc 1 791 1 view .LVU630
 2007 000a 08BD     		pop	{r3, pc}
 2008              	.LVL166:
 2009              	.L142:
 781:Core/Src/bootloader.c ****         {
 2010              		.loc 1 781 9 is_stmt 1 view .LVU631
 781:Core/Src/bootloader.c ****         {
 2011              		.loc 1 781 13 is_stmt 0 view .LVU632
 2012 000c 084B     		ldr	r3, .L143+4
 2013 000e 094A     		ldr	r2, .L143+8
 2014 0010 0021     		movs	r1, #0
 2015 0012 FFF7FEFF 		bl	HAL_CAN_GetRxMessage
 2016              	.LVL167:
 781:Core/Src/bootloader.c ****         {
 2017              		.loc 1 781 12 discriminator 1 view .LVU633
 2018 0016 0028     		cmp	r0, #0
 2019 0018 F7D1     		bne	.L139
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 66


 784:Core/Src/bootloader.c ****             {
 2020              		.loc 1 784 13 is_stmt 1 view .LVU634
 784:Core/Src/bootloader.c ****             {
 2021              		.loc 1 784 26 is_stmt 0 view .LVU635
 2022 001a 064B     		ldr	r3, .L143+8
 2023 001c 1A68     		ldr	r2, [r3]
 784:Core/Src/bootloader.c ****             {
 2024              		.loc 1 784 16 view .LVU636
 2025 001e 064B     		ldr	r3, .L143+12
 2026 0020 9A42     		cmp	r2, r3
 2027 0022 F2D1     		bne	.L139
 787:Core/Src/bootloader.c ****             }
 2028              		.loc 1 787 17 is_stmt 1 view .LVU637
 2029 0024 FFF7FEFF 		bl	Bootloader_ProcessCANMessage
 2030              	.LVL168:
 2031              		.loc 1 791 1 is_stmt 0 view .LVU638
 2032 0028 EFE7     		b	.L139
 2033              	.L144:
 2034 002a 00BF     		.align	2
 2035              	.L143:
 2036 002c 00000000 		.word	hcan_bootloader
 2037 0030 00000000 		.word	rx_data
 2038 0034 00000000 		.word	rx_header
 2039 0038 01070018 		.word	402654977
 2040              		.cfi_endproc
 2041              	.LFE149:
 2043              		.section	.bss.can_command_received,"aw",%nobits
 2046              	can_command_received:
 2047 0000 00       		.space	1
 2048              		.section	.bss.jump_to_app_flag,"aw",%nobits
 2051              	jump_to_app_flag:
 2052 0000 00       		.space	1
 2053              		.section	.bss.buffer_index,"aw",%nobits
 2054              		.align	1
 2057              	buffer_index:
 2058 0000 0000     		.space	2
 2059              		.section	.bss.flash_buffer,"aw",%nobits
 2060              		.align	2
 2063              	flash_buffer:
 2064 0000 00000000 		.space	8
 2064      00000000 
 2065              		.section	.bss.tx_mailbox,"aw",%nobits
 2066              		.align	2
 2069              	tx_mailbox:
 2070 0000 00000000 		.space	4
 2071              		.section	.bss.tx_header,"aw",%nobits
 2072              		.align	2
 2075              	tx_header:
 2076 0000 00000000 		.space	24
 2076      00000000 
 2076      00000000 
 2076      00000000 
 2076      00000000 
 2077              		.section	.bss.tx_data,"aw",%nobits
 2078              		.align	2
 2081              	tx_data:
 2082 0000 00000000 		.space	8
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 67


 2082      00000000 
 2083              		.section	.bss.rx_data,"aw",%nobits
 2084              		.align	2
 2087              	rx_data:
 2088 0000 00000000 		.space	8
 2088      00000000 
 2089              		.section	.bss.rx_header,"aw",%nobits
 2090              		.align	2
 2093              	rx_header:
 2094 0000 00000000 		.space	28
 2094      00000000 
 2094      00000000 
 2094      00000000 
 2094      00000000 
 2095              		.section	.bss.bootloader_status,"aw",%nobits
 2096              		.align	2
 2099              	bootloader_status:
 2100 0000 00000000 		.space	20
 2100      00000000 
 2100      00000000 
 2100      00000000 
 2100      00000000 
 2101              		.section	.bss.hcan_bootloader,"aw",%nobits
 2102              		.align	2
 2105              	hcan_bootloader:
 2106 0000 00000000 		.space	4
 2107              		.text
 2108              	.Letext0:
 2109              		.file 3 "C:/Users/Ali/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-tool
 2110              		.file 4 "C:/Users/Ali/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-tool
 2111              		.file 5 "Drivers/CMSIS/Include/core_cm4.h"
 2112              		.file 6 "Drivers/CMSIS/Device/ST/STM32L4xx/Include/stm32l432xx.h"
 2113              		.file 7 "Drivers/CMSIS/Device/ST/STM32L4xx/Include/stm32l4xx.h"
 2114              		.file 8 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_def.h"
 2115              		.file 9 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_can.h"
 2116              		.file 10 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_flash.h"
 2117              		.file 11 "Core/Inc/bootloader.h"
 2118              		.file 12 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_flash_ex.h"
 2119              		.file 13 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal.h"
 2120              		.file 14 "C:/Users/Ali/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-too
 2121              		.file 15 "Core/Inc/main.h"
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 68


DEFINED SYMBOLS
                            *ABS*:00000000 bootloader.c
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:21     .text.Bootloader_ReadFlash:00000000 $t
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:26     .text.Bootloader_ReadFlash:00000000 Bootloader_ReadFlash
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:79     .text.Bootloader_ConfigureCANFilter:00000000 $t
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:84     .text.Bootloader_ConfigureCANFilter:00000000 Bootloader_ConfigureCANFilter
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:159    .text.Bootloader_ConfigureCANFilter:00000048 $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:2105   .bss.hcan_bootloader:00000000 hcan_bootloader
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:164    .text.Bootloader_WaitForCANTransmission:00000000 $t
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:169    .text.Bootloader_WaitForCANTransmission:00000000 Bootloader_WaitForCANTransmission
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:217    .text.Bootloader_WaitForCANTransmission:00000024 $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:223    .text.Bootloader_EraseApplicationFlash:00000000 $t
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:228    .text.Bootloader_EraseApplicationFlash:00000000 Bootloader_EraseApplicationFlash
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:322    .text.Bootloader_EraseApplicationFlash:0000004c $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:2099   .bss.bootloader_status:00000000 bootloader_status
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:328    .text.Bootloader_WriteFlash:00000000 $t
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:333    .text.Bootloader_WriteFlash:00000000 Bootloader_WriteFlash
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:495    .text.Bootloader_WriteFlash:000000c0 $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:501    .text.Bootloader_DeInit:00000000 $t
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:506    .text.Bootloader_DeInit:00000000 Bootloader_DeInit
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:571    .text.Bootloader_DeInit:00000040 $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:576    .text.Bootloader_Init:00000000 $t
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:582    .text.Bootloader_Init:00000000 Bootloader_Init
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:670    .text.Bootloader_Init:00000054 $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:2075   .bss.tx_header:00000000 tx_header
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:679    .text.Bootloader_CheckValidApplication:00000000 $t
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:685    .text.Bootloader_CheckValidApplication:00000000 Bootloader_CheckValidApplication
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:733    .text.Bootloader_CheckValidApplication:00000028 $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:739    .text.Bootloader_SendCANMessage:00000000 $t
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:745    .text.Bootloader_SendCANMessage:00000000 Bootloader_SendCANMessage
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:816    .text.Bootloader_SendCANMessage:0000003c $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:2069   .bss.tx_mailbox:00000000 tx_mailbox
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:823    .text.Bootloader_SendACK:00000000 $t
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:828    .text.Bootloader_SendACK:00000000 Bootloader_SendACK
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:858    .text.Bootloader_SendACK:00000018 $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:2081   .bss.tx_data:00000000 tx_data
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:864    .text.Bootloader_SendNACK:00000000 $t
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:869    .text.Bootloader_SendNACK:00000000 Bootloader_SendNACK
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:906    .text.Bootloader_SendNACK:00000018 $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:912    .text.Bootloader_JumpToApplication:00000000 $t
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:918    .text.Bootloader_JumpToApplication:00000000 Bootloader_JumpToApplication
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:1046   .text.Bootloader_JumpToApplication:00000068 $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:1053   .text.Bootloader_SetApplicationValidFlag:00000000 $t
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:1059   .text.Bootloader_SetApplicationValidFlag:00000000 Bootloader_SetApplicationValidFlag
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:1158   .text.Bootloader_SetApplicationValidFlag:00000058 $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:1167   .text.Bootloader_CheckApplicationValidFlag:00000000 $t
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:1173   .text.Bootloader_CheckApplicationValidFlag:00000000 Bootloader_CheckApplicationValidFlag
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:1212   .text.Bootloader_CheckApplicationValidFlag:00000024 $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:1219   .text.Bootloader_Main:00000000 $t
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:1225   .text.Bootloader_Main:00000000 Bootloader_Main
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:1372   .text.Bootloader_Main:00000094 $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:2051   .bss.jump_to_app_flag:00000000 jump_to_app_flag
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:2046   .bss.can_command_received:00000000 can_command_received
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:1379   .text.Bootloader_ClearApplicationValidFlag:00000000 $t
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:1385   .text.Bootloader_ClearApplicationValidFlag:00000000 Bootloader_ClearApplicationValidFlag
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:1432   .text.Bootloader_ProcessCANMessage:00000000 $t
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:1438   .text.Bootloader_ProcessCANMessage:00000000 Bootloader_ProcessCANMessage
ARM GAS  C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s 			page 69


C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:1468   .text.Bootloader_ProcessCANMessage:00000018 $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:1475   .text.Bootloader_ProcessCANMessage:00000026 $t
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:1966   .text.Bootloader_ProcessCANMessage:0000021c $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:2087   .bss.rx_data:00000000 rx_data
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:2057   .bss.buffer_index:00000000 buffer_index
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:2063   .bss.flash_buffer:00000000 flash_buffer
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:1979   .text.HAL_CAN_RxFifo0MsgPendingCallback:00000000 $t
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:1985   .text.HAL_CAN_RxFifo0MsgPendingCallback:00000000 HAL_CAN_RxFifo0MsgPendingCallback
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:2036   .text.HAL_CAN_RxFifo0MsgPendingCallback:0000002c $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:2093   .bss.rx_header:00000000 rx_header
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:2047   .bss.can_command_received:00000000 $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:2052   .bss.jump_to_app_flag:00000000 $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:2054   .bss.buffer_index:00000000 $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:2060   .bss.flash_buffer:00000000 $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:2066   .bss.tx_mailbox:00000000 $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:2072   .bss.tx_header:00000000 $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:2078   .bss.tx_data:00000000 $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:2084   .bss.rx_data:00000000 $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:2090   .bss.rx_header:00000000 $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:2096   .bss.bootloader_status:00000000 $d
C:\Users\Ali\AppData\Local\Temp\ccIxq32K.s:2102   .bss.hcan_bootloader:00000000 $d

UNDEFINED SYMBOLS
HAL_CAN_ConfigFilter
Error_Handler
HAL_CAN_GetTxMailboxesFreeLevel
HAL_Delay
HAL_FLASH_Unlock
HAL_FLASHEx_Erase
HAL_FLASH_Lock
HAL_FLASH_Program
HAL_CAN_DeactivateNotification
HAL_CAN_Stop
HAL_CAN_MspDeInit
HAL_CAN_Start
HAL_CAN_ActivateNotification
HAL_CAN_AddTxMessage
HAL_GetTick
HAL_CAN_GetRxMessage
